import{_ as q}from"./rSdoIAfe.js";import{_ as D}from"./CCXs8F22.js";import{_ as H}from"./DIs3dmBA.js";import{u as L,f as z,g as b}from"./Dv1q3syl.js";import{l as A}from"./DnCtf8DX.js";import{E,G as S,r as i,K as X,q as r,s,z as c,H as F,B as y,x as a,y as g,F as $,C as G,A as N,I as B,J as I}from"#entry";import"./BJ2ClxiI.js";const J={subContainer:""},K={"m-l-6":"","text-5":"","text-amber-800":""},R={key:0},j={key:1},M={key:2},O={key:0,"m-l-6":""},P={class:"article"},Q={"text-size-3":"","m-r-3":""},U={key:3,"text-center":""},W=["src"],Y={key:4,"text-center":"","m-b-10":""},ie={__name:"articles",setup(Z){let{message:h}=E(["message"]);L({title:"文章搜索页"});const w=S(),f=i(w.query.keywords);let n=[],C=20,x=i(0),u=i(),_=i(!1),d=i(!1),v=i(!1),k=i(!0);const T=async()=>{u.value=[],k.value=!0,d.value=!1;const{data:e,pending:o,error:l}=await b("/hiveapi/search/0/?keywords="+f.value);if(l.value&&h.error(`失败！
`+l.value,{duration:5e3}),e.value){let t=e.value.result;k.value=!1,t.length>19&&(d.value=!0,_.value=!1),n=[];for(let m in t)n.push(t[m]);u.value=n}},V=async()=>{v.value=!0,d.value=!1,_.value=!0,x.value+=C;const{data:e,pending:o,error:l}=await b("/hiveapi/search/"+x.value+"/?keywords="+f.value);if(l.value){h.error(`失败！
`+l.value,{duration:5e3});return}let t=e?.value?.result;if(t.length==0){h.info("没有更多数据了",{duration:5e3}),v.value=!1;return}for(let m in t)n.push(t[m]);u.value=n,v.value=!1,t.length>19&&(d.value=!0),_.value=!1};return X(()=>w.query.keywords,e=>{f.value=e,T()},{flush:"pre",immediate:!0,deep:!0}),(e,o)=>{const l=q,t=D,m=H;return s(),r("div",J,[c("p",K,"关键词: "+y(a(f)),1),a(k)?(s(),r("div",R,[g(l)])):e.error?(s(),r("div",j,[g(t,{error:e.error},null,8,["error"])])):(s(),r("div",M,[a(u).length==0?(s(),r("div",O,"没有相关文章！")):(s(!0),r($,{key:1},G(a(u),p=>(s(),r("div",P,[g(m,{to:"/miaos/@"+p.author+"/"+p.permlink},{default:N(()=>[c("span",Q,y(("formatTime"in e?e.formatTime:a(z))(p.created)),1),B(y(p.title),1)]),_:2},1032,["to"])]))),256))])),a(v)?(s(),r("div",U,[c("img",{src:a(A),alt:"miao loading"},null,8,W)])):F("",!0),a(d)?(s(),r("div",Y,[g(a(I),{variant:"outline-primary",onClick:V,disabled:a(_)},{default:N(()=>[...o[0]||(o[0]=[B("搜索更多",-1)])]),_:1},8,["disabled"])])):F("",!0),o[1]||(o[1]=c("br",null,null,-1)),o[2]||(o[2]=c("br",null,null,-1))])}}};export{ie as default};
