import{bu as D,r as T,_ as b,k as j,a2 as A,bv as R,a0 as I}from"#entry";import{i as x}from"./BJ2ClxiI.js";function N(e,o){if(typeof e!="string")throw new TypeError("argument str must be a string");const t={},i=o||{},a=i.decode||P;let r=0;for(;r<e.length;){const n=e.indexOf("=",r);if(n===-1)break;let c=e.indexOf(";",r);if(c===-1)c=e.length;else if(c<n){r=e.lastIndexOf(";",n-1)+1;continue}const s=e.slice(r,n).trim();if(i?.filter&&!i?.filter(s)){r=c+1;continue}if(t[s]===void 0){let u=e.slice(n+1,c).trim();u.codePointAt(0)===34&&(u=u.slice(1,-1)),t[s]=L(u,a)}r=c+1}return t}function P(e){return e.includes("%")?decodeURIComponent(e):e}function L(e,o){try{return o(e)}catch{return e}}const w=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function S(e,o,t){const i=t||{},a=i.encode||encodeURIComponent;if(typeof a!="function")throw new TypeError("option encode is invalid");if(!w.test(e))throw new TypeError("argument name is invalid");const r=a(o);if(r&&!w.test(r))throw new TypeError("argument val is invalid");let n=e+"="+r;if(i.maxAge!==void 0&&i.maxAge!==null){const c=i.maxAge-0;if(Number.isNaN(c)||!Number.isFinite(c))throw new TypeError("option maxAge is invalid");n+="; Max-Age="+Math.floor(c)}if(i.domain){if(!w.test(i.domain))throw new TypeError("option domain is invalid");n+="; Domain="+i.domain}if(i.path){if(!w.test(i.path))throw new TypeError("option path is invalid");n+="; Path="+i.path}if(i.expires){if(!M(i.expires)||Number.isNaN(i.expires.valueOf()))throw new TypeError("option expires is invalid");n+="; Expires="+i.expires.toUTCString()}if(i.httpOnly&&(n+="; HttpOnly"),i.secure&&(n+="; Secure"),i.priority)switch(typeof i.priority=="string"?i.priority.toLowerCase():i.priority){case"low":{n+="; Priority=Low";break}case"medium":{n+="; Priority=Medium";break}case"high":{n+="; Priority=High";break}default:throw new TypeError("option priority is invalid")}if(i.sameSite)switch(typeof i.sameSite=="string"?i.sameSite.toLowerCase():i.sameSite){case!0:{n+="; SameSite=Strict";break}case"lax":{n+="; SameSite=Lax";break}case"strict":{n+="; SameSite=Strict";break}case"none":{n+="; SameSite=None";break}default:throw new TypeError("option sameSite is invalid")}return i.partitioned&&(n+="; Partitioned"),n}function M(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}function f(e){if(typeof e!="object")return e;var o,t,i=Object.prototype.toString.call(e);if(i==="[object Object]"){if(e.constructor!==Object&&typeof e.constructor=="function"){t=new e.constructor;for(o in e)e.hasOwnProperty(o)&&t[o]!==e[o]&&(t[o]=f(e[o]))}else{t={};for(o in e)o==="__proto__"?Object.defineProperty(t,o,{value:f(e[o]),configurable:!0,enumerable:!0,writable:!0}):t[o]=f(e[o])}return t}if(i==="[object Array]"){for(o=e.length,t=Array(o);o--;)t[o]=f(e[o]);return t}return i==="[object Set]"?(t=new Set,e.forEach(function(a){t.add(f(a))}),t):i==="[object Map]"?(t=new Map,e.forEach(function(a,r){t.set(f(r),f(a))}),t):i==="[object Date]"?new Date(+e):i==="[object RegExp]"?(t=new RegExp(e.source,e.flags),t.lastIndex=e.lastIndex,t):i==="[object DataView]"?new e.constructor(f(e.buffer)):i==="[object ArrayBuffer]"?e.slice(0):i.slice(-6)==="Array]"?new e.constructor(e):e}const _={path:"/",watch:!0,decode:e=>D(decodeURIComponent(e)),encode:e=>encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))},y=globalThis.cookieStore;function q(e,o){const t={..._,...o};t.filter??=u=>u===e;const i=E(t)||{};let a;t.maxAge!==void 0?a=t.maxAge*1e3:t.expires&&(a=t.expires.getTime()-Date.now());const r=a!==void 0&&a<=0,n=r||i[e]===void 0||i[e]===null,c=f(r?void 0:i[e]??t.default?.()),s=a&&!r?F(c,a,t.watch&&t.watch!=="shallow"):T(c);{let u=null;try{!y&&typeof BroadcastChannel<"u"&&(u=new BroadcastChannel(`nuxt:cookies:${e}`))}catch{}const d=(l=!1)=>{!l&&(t.readonly||x(s.value,i[e]))||(B(e,s.value,t),i[e]=f(s.value),u?.postMessage({value:t.encode(s.value)}))},p=l=>{const h=l.refresh?E(t)?.[e]:t.decode(l.value);m=!0,s.value=h,i[e]=f(h),I(()=>{m=!1})};let m=!1;const v=!!A();if(v&&b(()=>{m=!0,d(),u?.close()}),y){const l=h=>{const k=h.changed.find(g=>g.name===e),O=h.deleted.find(g=>g.name===e);k&&p({value:k.value}),O&&p({value:null})};y.addEventListener("change",l),v&&b(()=>y.removeEventListener("change",l))}else u&&(u.onmessage=({data:l})=>p(l));t.watch&&j(s,()=>{m||d()},{deep:t.watch!=="shallow"}),n&&d(n)}return s}function E(e={}){return N(document.cookie,e)}function U(e,o,t={}){return o==null?S(e,o,{...t,maxAge:-1}):S(e,o,t)}function B(e,o,t={}){document.cookie=U(e,o,t)}const C=2147483647;function F(e,o,t){let i,a,r=0;const n=t?T(e):{value:e};return A()&&b(()=>{a?.(),clearTimeout(i)}),R((c,s)=>{t&&(a=j(n,s));function u(){r=0,clearTimeout(i);const d=o-r,p=d<C?d:C;i=setTimeout(()=>{if(r+=p,r<o)return u();n.value=void 0,s()},p)}return{get(){return c(),n.value},set(d){u(),n.value=d,s()}}})}export{q as u};
