import{_ as _sfc_main$3}from"./BzUkPcel.js";import{_ as __nuxt_component_1,p as postHttp,b as getPermlink,g as getHttp,u as useHead,f as formatTime}from"./Bgr6ojWv.js";import{u as useCookie}from"./D82VSrbr.js";import{m as getDefaultExportFromCjs,n as commonjsGlobal,g as createDiscreteApi,r as ref,p as resolveComponent,c as createElementBlock,o as openBlock,b as createBaseVNode,i as createCommentVNode,j as createTextVNode,a as createVNode,t as toDisplayString,u as unref,d as withCtx,B as Button,q as isRef,F as Fragment,e as renderList,f as createBlock$1,h as useRoute,w as withAsyncContext,k as watch,s as navigateTo}from"./D81w4fj2.js";import{l as loading}from"./BRTuN0Vx.js";import"./BJ2ClxiI.js";const LOAD_BASE=e=>Promise.reject(new Error(`No base found for "${e}"`));class Multibases{constructor(t){this._basesByName={},this._basesByPrefix={},this._loadBase=t.loadBase||LOAD_BASE;for(const r of t.bases)this.addBase(r)}addBase(t){if(this._basesByName[t.name]||this._basesByPrefix[t.prefix])throw new Error(`Codec already exists for codec "${t.name}"`);this._basesByName[t.name]=t,this._basesByPrefix[t.prefix]=t}removeBase(t){delete this._basesByName[t.name],delete this._basesByPrefix[t.prefix]}async getBase(t){if(this._basesByName[t])return this._basesByName[t];if(this._basesByPrefix[t])return this._basesByPrefix[t];const r=await this._loadBase(t);return this._basesByName[r.name]==null&&this._basesByPrefix[r.prefix]==null&&this.addBase(r),r}listBases(){return Object.values(this._basesByName)}}const LOAD_CODEC=e=>Promise.reject(new Error(`No codec found for "${e}"`));class Multicodecs{constructor(t){this._codecsByName={},this._codecsByCode={},this._loadCodec=t.loadCodec||LOAD_CODEC;for(const r of t.codecs)this.addCodec(r)}addCodec(t){if(this._codecsByName[t.name]||this._codecsByCode[t.code])throw new Error(`Resolver already exists for codec "${t.name}"`);this._codecsByName[t.name]=t,this._codecsByCode[t.code]=t}removeCodec(t){delete this._codecsByName[t.name],delete this._codecsByCode[t.code]}async getCodec(t){const r=typeof t=="string"?this._codecsByName:this._codecsByCode;if(r[t])return r[t];const n=await this._loadCodec(t);return r[t]==null&&this.addCodec(n),n}listCodecs(){return Object.values(this._codecsByName)}}const LOAD_HASHER=e=>Promise.reject(new Error(`No hasher found for "${e}"`));class Multihashes{constructor(t){this._hashersByName={},this._hashersByCode={},this._loadHasher=t.loadHasher||LOAD_HASHER;for(const r of t.hashers)this.addHasher(r)}addHasher(t){if(this._hashersByName[t.name]||this._hashersByCode[t.code])throw new Error(`Resolver already exists for codec "${t.name}"`);this._hashersByName[t.name]=t,this._hashersByCode[t.code]=t}removeHasher(t){delete this._hashersByName[t.name],delete this._hashersByCode[t.code]}async getHasher(t){const r=typeof t=="string"?this._hashersByName:this._hashersByCode;if(r[t])return r[t];const n=await this._loadHasher(t);return r[t]==null&&this.addHasher(n),n}listHashers(){return Object.values(this._hashersByName)}}function equals$b(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function coerce$5(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function base$5(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=e.length,d=e.charAt(0),h=Math.log(a)/Math.log(256),b=Math.log(256)/Math.log(a);function y(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";for(var w=0,S=0,$=0,v=l.length;$!==v&&l[$]===0;)$++,w++;for(var C=(v-$)*b+1>>>0,A=new Uint8Array(C);$!==v;){for(var x=l[$],_=0,B=C-1;(x!==0||_<S)&&B!==-1;B--,_++)x+=256*A[B]>>>0,A[B]=x%a>>>0,x=x/a>>>0;if(x!==0)throw new Error("Non-zero carry");S=_,$++}for(var I=C-S;I!==C&&A[I]===0;)I++;for(var D=d.repeat(w);I<C;++I)D+=e.charAt(A[I]);return D}function g(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;var w=0;if(l[w]!==" "){for(var S=0,$=0;l[w]===d;)S++,w++;for(var v=(l.length-w)*h+1>>>0,C=new Uint8Array(v);l[w];){var A=r[l.charCodeAt(w)];if(A===255)return;for(var x=0,_=v-1;(A!==0||x<$)&&_!==-1;_--,x++)A+=a*C[_]>>>0,C[_]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");$=x,w++}if(l[w]!==" "){for(var B=v-$;B!==v&&C[B]===0;)B++;for(var I=new Uint8Array(S+(v-B)),D=S;B!==v;)I[D++]=C[B++];return I}}}function p(l){var w=g(l);if(w)return w;throw new Error(`Non-${t} character`)}return{encode:y,decodeUnsafe:g,decode:p}}var src$6=base$5,_brrp__multiformats_scope_baseX$5=src$6;let Encoder$5=class{name;prefix;baseEncode;constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Decoder$5=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,r,n){this.name=t,this.prefix=r;const o=r.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return or$5(this,t)}},ComposedDecoder$5=class{decoders;constructor(t){this.decoders=t}or(t){return or$5(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function or$5(e,t){return new ComposedDecoder$5({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}let Codec$5=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new Encoder$5(t,r,n),this.decoder=new Decoder$5(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function from$6({name:e,prefix:t,encode:r,decode:n}){return new Codec$5(e,t,r,n)}function baseX$5({name:e,prefix:t,alphabet:r}){const{encode:n,decode:o}=_brrp__multiformats_scope_baseX$5(r,e);return from$6({prefix:t,name:e,encode:n,decode:s=>coerce$5(o(s))})}function decode$z(e,t,r,n){let o=e.length;for(;e[o-1]==="=";)--o;const s=new Uint8Array(o*r/8|0);let i=0,a=0,d=0;for(let h=0;h<o;++h){const b=t[e[h]];if(b===void 0)throw new SyntaxError(`Non-${n} character`);a=a<<r|b,i+=r,i>=8&&(i-=8,s[d++]=255&a>>i)}if(i>=r||(255&a<<8-i)!==0)throw new SyntaxError("Unexpected end of data");return s}function encode$o(e,t,r){const n=t[t.length-1]==="=",o=(1<<r)-1;let s="",i=0,a=0;for(let d=0;d<e.length;++d)for(a=a<<8|e[d],i+=8;i>r;)i-=r,s+=t[o&a>>i];if(i!==0&&(s+=t[o&a<<r-i]),n)for(;(s.length*r&7)!==0;)s+="=";return s}function createAlphabetIdx$3(e){const t={};for(let r=0;r<e.length;++r)t[e[r]]=r;return t}function rfc4648$5({name:e,prefix:t,bitsPerChar:r,alphabet:n}){const o=createAlphabetIdx$3(n);return from$6({prefix:t,name:e,encode(s){return encode$o(s,n,r)},decode(s){return decode$z(s,o,r,e)}})}const base32$8=rfc4648$5({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648$5({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});rfc4648$5({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});rfc4648$5({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});rfc4648$5({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});rfc4648$5({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});rfc4648$5({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});rfc4648$5({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});rfc4648$5({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const base36$8=baseX$5({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"});baseX$5({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});const base58btc$5=baseX$5({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX$5({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var encode_1$5=encode$n,MSB$5=128,MSBALL$4=-128,INT$4=Math.pow(2,31);function encode$n(e,t,r){t=t||[],r=r||0;for(var n=r;e>=INT$4;)t[r++]=e&255|MSB$5,e/=128;for(;e&MSBALL$4;)t[r++]=e&255|MSB$5,e>>>=7;return t[r]=e|0,encode$n.bytes=r-n+1,t}var decode$y=read$4,MSB$1$5=128,REST$1$4=127;function read$4(e,n){var r=0,n=n||0,o=0,s=n,i,a=e.length;do{if(s>=a)throw read$4.bytes=0,new RangeError("Could not decode varint");i=e[s++],r+=o<28?(i&REST$1$4)<<o:(i&REST$1$4)*Math.pow(2,o),o+=7}while(i>=MSB$1$5);return read$4.bytes=s-n,r}var N1$5=Math.pow(2,7),N2$5=Math.pow(2,14),N3$5=Math.pow(2,21),N4$5=Math.pow(2,28),N5$5=Math.pow(2,35),N6$5=Math.pow(2,42),N7$5=Math.pow(2,49),N8$4=Math.pow(2,56),N9$4=Math.pow(2,63),length$5=function(e){return e<N1$5?1:e<N2$5?2:e<N3$5?3:e<N4$5?4:e<N5$5?5:e<N6$5?6:e<N7$5?7:e<N8$4?8:e<N9$4?9:10},varint$6={encode:encode_1$5,decode:decode$y,encodingLength:length$5},_brrp_varint$4=varint$6;function decode$x(e,t=0){return[_brrp_varint$4.decode(e,t),_brrp_varint$4.decode.bytes]}function encodeTo$4(e,t,r=0){return _brrp_varint$4.encode(e,t,r),t}function encodingLength$5(e){return _brrp_varint$4.encodingLength(e)}function create$5(e,t){const r=t.byteLength,n=encodingLength$5(e),o=n+encodingLength$5(r),s=new Uint8Array(o+r);return encodeTo$4(e,s,0),encodeTo$4(r,s,n),s.set(t,o),new Digest$4(e,r,t,s)}function decode$w(e){const t=coerce$5(e),[r,n]=decode$x(t),[o,s]=decode$x(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Digest$4(r,o,i,t)}function equals$a(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&equals$b(e.bytes,r.bytes)}}let Digest$4=class{code;size;digest;bytes;constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}};function format$5(e,t){const{bytes:r,version:n}=e;switch(n){case 0:return toStringV0$4(r,baseCache$4(e),t??base58btc$5.encoder);default:return toStringV1$4(r,baseCache$4(e),t??base32$8.encoder)}}const cache$4=new WeakMap;function baseCache$4(e){const t=cache$4.get(e);if(t==null){const r=new Map;return cache$4.set(e,r),r}return t}let CID$4=class L{code;version;multihash;bytes;"/";constructor(t,r,n,o){this.code=r,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:r}=this;if(t!==DAG_PB_CODE$4)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==SHA_256_CODE$4)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return L.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:r}=this.multihash,n=create$5(t,r);return L.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return L.equals(this,t)}static equals(t,r){const n=r;return n!=null&&t.code===n.code&&t.version===n.version&&equals$a(t.multihash,n.multihash)}toString(t){return format$5(this,t)}toJSON(){return{"/":format$5(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;const r=t;if(r instanceof L)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){const{version:n,code:o,multihash:s,bytes:i}=r;return new L(n,o,s,i??encodeCID$5(n,o,s.bytes))}else if(r[cidSymbol$4]===!0){const{version:n,multihash:o,code:s}=r,i=decode$w(o);return L.create(n,s,i)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==DAG_PB_CODE$4)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$4}) block encoding`);return new L(t,r,n,n.bytes)}case 1:{const o=encodeCID$5(t,r,n.bytes);return new L(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return L.create(0,DAG_PB_CODE$4,t)}static createV1(t,r){return L.create(1,t,r)}static decode(t){const[r,n]=L.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(t){const r=L.inspectBytes(t),n=r.size-r.multihashSize,o=coerce$5(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");const s=o.subarray(r.multihashSize-r.digestSize),i=new Digest$4(r.multihashCode,r.digestSize,s,o);return[r.version===0?L.createV0(i):L.createV1(r.codec,i),t.subarray(r.size)]}static inspectBytes(t){let r=0;const n=()=>{const[y,g]=decode$x(t.subarray(r));return r+=g,y};let o=n(),s=DAG_PB_CODE$4;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);const i=r,a=n(),d=n(),h=r+d,b=h-i;return{version:o,codec:s,multihashCode:a,digestSize:d,multihashSize:b,size:h}}static parse(t,r){const[n,o]=parseCIDtoBytes$4(t,r),s=L.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache$4(s).set(n,t),s}};function parseCIDtoBytes$4(e,t){switch(e[0]){case"Q":{const r=t??base58btc$5;return[base58btc$5.prefix,r.decode(`${base58btc$5.prefix}${e}`)]}case base58btc$5.prefix:{const r=t??base58btc$5;return[base58btc$5.prefix,r.decode(e)]}case base32$8.prefix:{const r=t??base32$8;return[base32$8.prefix,r.decode(e)]}case base36$8.prefix:{const r=t??base36$8;return[base36$8.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}}function toStringV0$4(e,t,r){const{prefix:n}=r;if(n!==base58btc$5.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const o=t.get(n);if(o==null){const s=r.encode(e).slice(1);return t.set(n,s),s}else return o}function toStringV1$4(e,t,r){const{prefix:n}=r,o=t.get(n);if(o==null){const s=r.encode(e);return t.set(n,s),s}else return o}const DAG_PB_CODE$4=112,SHA_256_CODE$4=18;function encodeCID$5(e,t,r){const n=encodingLength$5(e),o=n+encodingLength$5(t),s=new Uint8Array(o+r.byteLength);return encodeTo$4(e,s,0),encodeTo$4(t,s,n),s.set(r,o),s}const cidSymbol$4=Symbol.for("@ipld/js-cid/CID"),textDecoder$2=new TextDecoder;function decodeVarint(e,t){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=e.length)throw new Error("protobuf: unexpected end of data");const o=e[t++];if(r+=n<28?(o&127)<<n:(o&127)*2**n,o<128)break}return[r,t]}function decodeBytes(e,t){let r;[r,t]=decodeVarint(e,t);const n=t+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>e.length)throw new Error("protobuf: unexpected end of data");return[e.subarray(t,n),n]}function decodeKey(e,t){let r;return[r,t]=decodeVarint(e,t),[r&7,r>>3,t]}function decodeLink(e){const t={},r=e.length;let n=0;for(;n<r;){let o,s;if([o,s,n]=decodeKey(e,n),s===1){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Hash`);if(t.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=decodeBytes(e,n)}else if(s===2){if(t.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(o!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Name`);if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let i;[i,n]=decodeBytes(e,n),t.Name=textDecoder$2.decode(i)}else if(s===3){if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(o!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${o}) for Tsize`);[t.Tsize,n]=decodeVarint(e,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${s}`)}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return t}function decodeNode(e){const t=e.length;let r=0,n,o=!1,s;for(;r<t;){let a,d;if([a,d,r]=decodeKey(e,r),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(d===1){if(s)throw new Error("protobuf: (PBNode) duplicate Data section");[s,r]=decodeBytes(e,r),n&&(o=!0)}else if(d===2){if(o)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let h;[h,r]=decodeBytes(e,r),n.push(decodeLink(h))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${d}`)}if(r>t)throw new Error("protobuf: (PBNode) unexpected end of data");const i={};return s&&(i.Data=s),i.Links=n||[],i}const textEncoder$3=new TextEncoder,maxInt32=2**32,maxUInt32=2**31;function encodeLink(e,t){let r=t.length;if(typeof e.Tsize=="number"){if(e.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(e.Tsize))throw new Error("Tsize too large for encoding");r=encodeVarint(t,r,e.Tsize)-1,t[r]=24}if(typeof e.Name=="string"){const n=textEncoder$3.encode(e.Name);r-=n.length,t.set(n,r),r=encodeVarint(t,r,n.length)-1,t[r]=18}return e.Hash&&(r-=e.Hash.length,t.set(e.Hash,r),r=encodeVarint(t,r,e.Hash.length)-1,t[r]=10),t.length-r}function encodeNode(e){const t=sizeNode(e),r=new Uint8Array(t);let n=t;if(e.Data&&(n-=e.Data.length,r.set(e.Data,n),n=encodeVarint(r,n,e.Data.length)-1,r[n]=10),e.Links)for(let o=e.Links.length-1;o>=0;o--){const s=encodeLink(e.Links[o],r.subarray(0,n));n-=s,n=encodeVarint(r,n,s)-1,r[n]=18}return r}function sizeLink(e){let t=0;if(e.Hash){const r=e.Hash.length;t+=1+r+sov(r)}if(typeof e.Name=="string"){const r=textEncoder$3.encode(e.Name).length;t+=1+r+sov(r)}return typeof e.Tsize=="number"&&(t+=1+sov(e.Tsize)),t}function sizeNode(e){let t=0;if(e.Data){const r=e.Data.length;t+=1+r+sov(r)}if(e.Links)for(const r of e.Links){const n=sizeLink(r);t+=1+n+sov(n)}return t}function encodeVarint(e,t,r){t-=sov(r);const n=t;for(;r>=maxUInt32;)e[t++]=r&127|128,r/=128;for(;r>=128;)e[t++]=r&127|128,r>>>=7;return e[t]=r,n}function sov(e){return e%2===0&&e++,Math.floor((len64(e)+6)/7)}function len64(e){let t=0;return e>=maxInt32&&(e=Math.floor(e/maxInt32),t=32),e>=65536&&(e>>>=16,t+=16),e>=256&&(e>>>=8,t+=8),t+len8tab[e]}const len8tab=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8],pbNodeProperties=["Data","Links"],pbLinkProperties=["Hash","Name","Tsize"],textEncoder$2=new TextEncoder;function linkComparator(e,t){if(e===t)return 0;const r=e.Name?textEncoder$2.encode(e.Name):[],n=t.Name?textEncoder$2.encode(t.Name):[];let o=r.length,s=n.length;for(let i=0,a=Math.min(o,s);i<a;++i)if(r[i]!==n[i]){o=r[i],s=n[i];break}return o<s?-1:s<o?1:0}function hasOnlyProperties(e,t){return!Object.keys(e).some(r=>!t.includes(r))}function asLink(e){if(typeof e.asCID=="object"){const r=CID$4.asCID(e);if(!r)throw new TypeError("Invalid DAG-PB form");return{Hash:r}}if(typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Hash){let r=CID$4.asCID(e.Hash);try{r||(typeof e.Hash=="string"?r=CID$4.parse(e.Hash):e.Hash instanceof Uint8Array&&(r=CID$4.decode(e.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}r&&(t.Hash=r)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return typeof e.Name=="string"&&(t.Name=e.Name),typeof e.Tsize=="number"&&(t.Tsize=e.Tsize),t}function prepare(e){if((e instanceof Uint8Array||typeof e=="string")&&(e={Data:e}),typeof e!="object"||Array.isArray(e))throw new TypeError("Invalid DAG-PB form");const t={};if(e.Data!==void 0)if(typeof e.Data=="string")t.Data=textEncoder$2.encode(e.Data);else if(e.Data instanceof Uint8Array)t.Data=e.Data;else throw new TypeError("Invalid DAG-PB form");if(e.Links!==void 0)if(Array.isArray(e.Links))t.Links=e.Links.map(asLink),t.Links.sort(linkComparator);else throw new TypeError("Invalid DAG-PB form");else t.Links=[];return t}function validate$2(e){if(!e||typeof e!="object"||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form");if(!hasOnlyProperties(e,pbNodeProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(e.Data!==void 0&&!(e.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(e.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let t=0;t<e.Links.length;t++){const r=e.Links[t];if(!r||typeof r!="object"||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!hasOnlyProperties(r,pbLinkProperties))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(r.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash==null||!r.Hash["/"]||r.Hash["/"]!==r.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(r.Name!==void 0&&typeof r.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(r.Tsize!==void 0){if(typeof r.Tsize!="number"||r.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(r.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&linkComparator(r,e.Links[t-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function createNode(e,t=[]){return prepare({Data:e,Links:t})}function createLink(e,t,r){return asLink({Hash:r,Name:e,Tsize:t})}function toByteView$2(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}const name$6="dag-pb",code$6=112;function encode$m(e){validate$2(e);const t={};return e.Links&&(t.Links=e.Links.map(r=>{const n={};return r.Hash&&(n.Hash=r.Hash.bytes),r.Name!==void 0&&(n.Name=r.Name),r.Tsize!==void 0&&(n.Tsize=r.Tsize),n})),e.Data&&(t.Data=e.Data),encodeNode(t)}function decode$v(e){const t=toByteView$2(e),r=decodeNode(t),n={};return r.Data&&(n.Data=r.Data),r.Links&&(n.Links=r.Links.map(o=>{const s={};try{s.Hash=CID$4.decode(o.Hash)}catch{}if(!s.Hash)throw new Error("Invalid Hash field found in link, expected CID");return o.Name!==void 0&&(s.Name=o.Name),o.Tsize!==void 0&&(s.Tsize=o.Tsize),s})),n}const dagPB=Object.freeze(Object.defineProperty({__proto__:null,code:code$6,createLink,createNode,decode:decode$v,encode:encode$m,name:name$6,prepare,validate:validate$2},Symbol.toStringTag,{value:"Module"})),typeofs=["string","number","bigint","symbol"],objectTypeNames=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function is(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";const t=typeof e;if(typeofs.includes(t))return t;if(t==="function")return"Function";if(Array.isArray(e))return"Array";if(isBuffer$1(e))return"Buffer";const r=getObjectType(e);return r||"Object"}function isBuffer$1(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function getObjectType(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(objectTypeNames.includes(t))return t}class Type{constructor(t,r,n){this.major=t,this.majorEncoded=t<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}Type.uint=new Type(0,"uint",!0);Type.negint=new Type(1,"negint",!0);Type.bytes=new Type(2,"bytes",!0);Type.string=new Type(3,"string",!0);Type.array=new Type(4,"array",!1);Type.map=new Type(5,"map",!1);Type.tag=new Type(6,"tag",!1);Type.float=new Type(7,"float",!0);Type.false=new Type(7,"false",!0);Type.true=new Type(7,"true",!0);Type.null=new Type(7,"null",!0);Type.undefined=new Type(7,"undefined",!0);Type.break=new Type(7,"break",!0);class Token{constructor(t,r,n){this.type=t,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const useBuffer=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",textDecoder$1=new TextDecoder,textEncoder$1=new TextEncoder;function isBuffer(e){return useBuffer&&globalThis.Buffer.isBuffer(e)}function asU8A(e){return e instanceof Uint8Array?isBuffer(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const toString$7=useBuffer?((e,t,r)=>r-t>64?globalThis.Buffer.from(e.subarray(t,r)).toString("utf8"):utf8Slice(e,t,r)):((e,t,r)=>r-t>64?textDecoder$1.decode(e.subarray(t,r)):utf8Slice(e,t,r)),fromString$7=useBuffer?(e=>e.length>64?globalThis.Buffer.from(e):utf8ToBytes(e)):(e=>e.length>64?textEncoder$1.encode(e):utf8ToBytes(e)),fromArray=e=>Uint8Array.from(e),slice=useBuffer?((e,t,r)=>isBuffer(e)?new Uint8Array(e.subarray(t,r)):e.slice(t,r)):((e,t,r)=>e.slice(t,r)),concat$2=useBuffer?((e,t)=>(e=e.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),asU8A(globalThis.Buffer.concat(e,t)))):((e,t)=>{const r=new Uint8Array(t);let n=0;for(let o of e)n+o.length>r.length&&(o=o.subarray(0,r.length-n)),r.set(o,n),n+=o.length;return r}),alloc=useBuffer?(e=>globalThis.Buffer.allocUnsafe(e)):(e=>new Uint8Array(e));function compare(e,t){if(isBuffer(e)&&isBuffer(t))return e.compare(t);for(let r=0;r<e.length;r++)if(e[r]!==t[r])return e[r]<t[r]?-1:1;return 0}function utf8ToBytes(e){const t=[];let r=0;for(let n=0;n<e.length;n++){let o=e.charCodeAt(n);o<128?t[r++]=o:o<2048?(t[r++]=o>>6|192,t[r++]=o&63|128):(o&64512)===55296&&n+1<e.length&&(e.charCodeAt(n+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++n)&1023),t[r++]=o>>18|240,t[r++]=o>>12&63|128,t[r++]=o>>6&63|128,t[r++]=o&63|128):(t[r++]=o>>12|224,t[r++]=o>>6&63|128,t[r++]=o&63|128)}return t}function utf8Slice(e,t,r){const n=[];for(;t<r;){const o=e[t];let s=null,i=o>239?4:o>223?3:o>191?2:1;if(t+i<=r){let a,d,h,b;switch(i){case 1:o<128&&(s=o);break;case 2:a=e[t+1],(a&192)===128&&(b=(o&31)<<6|a&63,b>127&&(s=b));break;case 3:a=e[t+1],d=e[t+2],(a&192)===128&&(d&192)===128&&(b=(o&15)<<12|(a&63)<<6|d&63,b>2047&&(b<55296||b>57343)&&(s=b));break;case 4:a=e[t+1],d=e[t+2],h=e[t+3],(a&192)===128&&(d&192)===128&&(h&192)===128&&(b=(o&15)<<18|(a&63)<<12|(d&63)<<6|h&63,b>65535&&b<1114112&&(s=b))}}s===null?(s=65533,i=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),t+=i}return decodeCodePointsArray(n)}const MAX_ARGUMENTS_LENGTH=4096;function decodeCodePointsArray(e){const t=e.length;if(t<=MAX_ARGUMENTS_LENGTH)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=MAX_ARGUMENTS_LENGTH));return r}const defaultChunkSize=256;class Bl{constructor(t=defaultChunkSize){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let r=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const o=r.length-(this.maxCursor-this.cursor)-1;r.set(t,o)}else{if(r){const o=r.length-(this.maxCursor-this.cursor)-1;o<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,o),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(r=alloc(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let r;if(this.chunks.length===1){const n=this.chunks[0];t&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=slice(n,0,this.cursor)}else r=concat$2(this.chunks,this.cursor);return t&&this.reset(),r}}const decodeErrPrefix="CBOR decode error:",encodeErrPrefix="CBOR encode error:";function assertEnoughData(e,t,r){if(e.length-t<r)throw new Error(`${decodeErrPrefix} not enough data for type`)}const uintBoundaries=[24,256,65536,4294967296,BigInt("18446744073709551616")];function readUint8(e,t,r){assertEnoughData(e,t,1);const n=e[t];if(r.strict===!0&&n<uintBoundaries[0])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return n}function readUint16(e,t,r){assertEnoughData(e,t,2);const n=e[t]<<8|e[t+1];if(r.strict===!0&&n<uintBoundaries[1])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return n}function readUint32(e,t,r){assertEnoughData(e,t,4);const n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(r.strict===!0&&n<uintBoundaries[2])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);return n}function readUint64(e,t,r){assertEnoughData(e,t,8);const n=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],s=(BigInt(n)<<BigInt(32))+BigInt(o);if(r.strict===!0&&s<uintBoundaries[3])throw new Error(`${decodeErrPrefix} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(r.allowBigInt===!0)return s;throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`)}function decodeUint8(e,t,r,n){return new Token(Type.uint,readUint8(e,t+1,n),2)}function decodeUint16(e,t,r,n){return new Token(Type.uint,readUint16(e,t+1,n),3)}function decodeUint32(e,t,r,n){return new Token(Type.uint,readUint32(e,t+1,n),5)}function decodeUint64(e,t,r,n){return new Token(Type.uint,readUint64(e,t+1,n),9)}function encodeUint(e,t){return encodeUintValue(e,0,t.value)}function encodeUintValue(e,t,r){if(r<uintBoundaries[0]){const n=Number(r);e.push([t|n])}else if(r<uintBoundaries[1]){const n=Number(r);e.push([t|24,n])}else if(r<uintBoundaries[2]){const n=Number(r);e.push([t|25,n>>>8,n&255])}else if(r<uintBoundaries[3]){const n=Number(r);e.push([t|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{const n=BigInt(r);if(n<uintBoundaries[4]){const o=[t|27,0,0,0,0,0,0,0];let s=Number(n&BigInt(4294967295)),i=Number(n>>BigInt(32)&BigInt(4294967295));o[8]=s&255,s=s>>8,o[7]=s&255,s=s>>8,o[6]=s&255,s=s>>8,o[5]=s&255,o[4]=i&255,i=i>>8,o[3]=i&255,i=i>>8,o[2]=i&255,i=i>>8,o[1]=i&255,e.push(o)}else throw new Error(`${decodeErrPrefix} encountered BigInt larger than allowable range`)}}encodeUint.encodedSize=function(t){return encodeUintValue.encodedSize(t.value)};encodeUintValue.encodedSize=function(t){return t<uintBoundaries[0]?1:t<uintBoundaries[1]?2:t<uintBoundaries[2]?3:t<uintBoundaries[3]?5:9};encodeUint.compareTokens=function(t,r){return t.value<r.value?-1:t.value>r.value?1:0};function decodeNegint8(e,t,r,n){return new Token(Type.negint,-1-readUint8(e,t+1,n),2)}function decodeNegint16(e,t,r,n){return new Token(Type.negint,-1-readUint16(e,t+1,n),3)}function decodeNegint32(e,t,r,n){return new Token(Type.negint,-1-readUint32(e,t+1,n),5)}const neg1b=BigInt(-1),pos1b=BigInt(1);function decodeNegint64(e,t,r,n){const o=readUint64(e,t+1,n);if(typeof o!="bigint"){const s=-1-o;if(s>=Number.MIN_SAFE_INTEGER)return new Token(Type.negint,s,9)}if(n.allowBigInt!==!0)throw new Error(`${decodeErrPrefix} integers outside of the safe integer range are not supported`);return new Token(Type.negint,neg1b-BigInt(o),9)}function encodeNegint(e,t){const r=t.value,n=typeof r=="bigint"?r*neg1b-pos1b:r*-1-1;encodeUintValue(e,t.type.majorEncoded,n)}encodeNegint.encodedSize=function(t){const r=t.value,n=typeof r=="bigint"?r*neg1b-pos1b:r*-1-1;return n<uintBoundaries[0]?1:n<uintBoundaries[1]?2:n<uintBoundaries[2]?3:n<uintBoundaries[3]?5:9};encodeNegint.compareTokens=function(t,r){return t.value<r.value?1:t.value>r.value?-1:0};function toToken$3(e,t,r,n){assertEnoughData(e,t,r+n);const o=slice(e,t+r,t+r+n);return new Token(Type.bytes,o,r+n)}function decodeBytesCompact(e,t,r,n){return toToken$3(e,t,1,r)}function decodeBytes8(e,t,r,n){return toToken$3(e,t,2,readUint8(e,t+1,n))}function decodeBytes16(e,t,r,n){return toToken$3(e,t,3,readUint16(e,t+1,n))}function decodeBytes32(e,t,r,n){return toToken$3(e,t,5,readUint32(e,t+1,n))}function decodeBytes64(e,t,r,n){const o=readUint64(e,t+1,n);if(typeof o=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer bytes lengths not supported`);return toToken$3(e,t,9,o)}function tokenBytes(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===Type.string?fromString$7(e.value):e.value),e.encodedBytes}function encodeBytes(e,t){const r=tokenBytes(t);encodeUintValue(e,t.type.majorEncoded,r.length),e.push(r)}encodeBytes.encodedSize=function(t){const r=tokenBytes(t);return encodeUintValue.encodedSize(r.length)+r.length};encodeBytes.compareTokens=function(t,r){return compareBytes(tokenBytes(t),tokenBytes(r))};function compareBytes(e,t){return e.length<t.length?-1:e.length>t.length?1:compare(e,t)}function toToken$2(e,t,r,n,o){const s=r+n;assertEnoughData(e,t,s);const i=new Token(Type.string,toString$7(e,t+r,t+s),s);return o.retainStringBytes===!0&&(i.byteValue=slice(e,t+r,t+s)),i}function decodeStringCompact(e,t,r,n){return toToken$2(e,t,1,r,n)}function decodeString8(e,t,r,n){return toToken$2(e,t,2,readUint8(e,t+1,n),n)}function decodeString16(e,t,r,n){return toToken$2(e,t,3,readUint16(e,t+1,n),n)}function decodeString32(e,t,r,n){return toToken$2(e,t,5,readUint32(e,t+1,n),n)}function decodeString64(e,t,r,n){const o=readUint64(e,t+1,n);if(typeof o=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer string lengths not supported`);return toToken$2(e,t,9,o,n)}const encodeString=encodeBytes;function toToken$1(e,t,r,n){return new Token(Type.array,n,r)}function decodeArrayCompact(e,t,r,n){return toToken$1(e,t,1,r)}function decodeArray8(e,t,r,n){return toToken$1(e,t,2,readUint8(e,t+1,n))}function decodeArray16(e,t,r,n){return toToken$1(e,t,3,readUint16(e,t+1,n))}function decodeArray32(e,t,r,n){return toToken$1(e,t,5,readUint32(e,t+1,n))}function decodeArray64(e,t,r,n){const o=readUint64(e,t+1,n);if(typeof o=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer array lengths not supported`);return toToken$1(e,t,9,o)}function decodeArrayIndefinite(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken$1(e,t,1,1/0)}function encodeArray(e,t){encodeUintValue(e,Type.array.majorEncoded,t.value)}encodeArray.compareTokens=encodeUint.compareTokens;encodeArray.encodedSize=function(t){return encodeUintValue.encodedSize(t.value)};function toToken(e,t,r,n){return new Token(Type.map,n,r)}function decodeMapCompact(e,t,r,n){return toToken(e,t,1,r)}function decodeMap8(e,t,r,n){return toToken(e,t,2,readUint8(e,t+1,n))}function decodeMap16(e,t,r,n){return toToken(e,t,3,readUint16(e,t+1,n))}function decodeMap32(e,t,r,n){return toToken(e,t,5,readUint32(e,t+1,n))}function decodeMap64(e,t,r,n){const o=readUint64(e,t+1,n);if(typeof o=="bigint")throw new Error(`${decodeErrPrefix} 64-bit integer map lengths not supported`);return toToken(e,t,9,o)}function decodeMapIndefinite(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return toToken(e,t,1,1/0)}function encodeMap(e,t){encodeUintValue(e,Type.map.majorEncoded,t.value)}encodeMap.compareTokens=encodeUint.compareTokens;encodeMap.encodedSize=function(t){return encodeUintValue.encodedSize(t.value)};function decodeTagCompact(e,t,r,n){return new Token(Type.tag,r,1)}function decodeTag8(e,t,r,n){return new Token(Type.tag,readUint8(e,t+1,n),2)}function decodeTag16(e,t,r,n){return new Token(Type.tag,readUint16(e,t+1,n),3)}function decodeTag32(e,t,r,n){return new Token(Type.tag,readUint32(e,t+1,n),5)}function decodeTag64(e,t,r,n){return new Token(Type.tag,readUint64(e,t+1,n),9)}function encodeTag(e,t){encodeUintValue(e,Type.tag.majorEncoded,t.value)}encodeTag.compareTokens=encodeUint.compareTokens;encodeTag.encodedSize=function(t){return encodeUintValue.encodedSize(t.value)};const MINOR_FALSE=20,MINOR_TRUE=21,MINOR_NULL=22,MINOR_UNDEFINED=23;function decodeUndefined(e,t,r,n){if(n.allowUndefined===!1)throw new Error(`${decodeErrPrefix} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new Token(Type.null,null,1):new Token(Type.undefined,void 0,1)}function decodeBreak(e,t,r,n){if(n.allowIndefinite===!1)throw new Error(`${decodeErrPrefix} indefinite length items not allowed`);return new Token(Type.break,void 0,1)}function createToken(e,t,r){if(r){if(r.allowNaN===!1&&Number.isNaN(e))throw new Error(`${decodeErrPrefix} NaN values are not supported`);if(r.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${decodeErrPrefix} Infinity values are not supported`)}return new Token(Type.float,e,t)}function decodeFloat16(e,t,r,n){return createToken(readFloat16(e,t+1),3,n)}function decodeFloat32(e,t,r,n){return createToken(readFloat32(e,t+1),5,n)}function decodeFloat64(e,t,r,n){return createToken(readFloat64(e,t+1),9,n)}function encodeFloat(e,t,r){const n=t.value;if(n===!1)e.push([Type.float.majorEncoded|MINOR_FALSE]);else if(n===!0)e.push([Type.float.majorEncoded|MINOR_TRUE]);else if(n===null)e.push([Type.float.majorEncoded|MINOR_NULL]);else if(n===void 0)e.push([Type.float.majorEncoded|MINOR_UNDEFINED]);else{let o,s=!1;(!r||r.float64!==!0)&&(encodeFloat16(n),o=readFloat16(ui8a,1),n===o||Number.isNaN(n)?(ui8a[0]=249,e.push(ui8a.slice(0,3)),s=!0):(encodeFloat32(n),o=readFloat32(ui8a,1),n===o&&(ui8a[0]=250,e.push(ui8a.slice(0,5)),s=!0))),s||(encodeFloat64(n),o=readFloat64(ui8a,1),ui8a[0]=251,e.push(ui8a.slice(0,9)))}}encodeFloat.encodedSize=function(t,r){const n=t.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!r||r.float64!==!0){encodeFloat16(n);let o=readFloat16(ui8a,1);if(n===o||Number.isNaN(n))return 3;if(encodeFloat32(n),o=readFloat32(ui8a,1),n===o)return 5}return 9};const buffer$1=new ArrayBuffer(9),dataView=new DataView(buffer$1,1),ui8a=new Uint8Array(buffer$1,0);function encodeFloat16(e){if(e===1/0)dataView.setUint16(0,31744,!1);else if(e===-1/0)dataView.setUint16(0,64512,!1);else if(Number.isNaN(e))dataView.setUint16(0,32256,!1);else{dataView.setFloat32(0,e);const t=dataView.getUint32(0),r=(t&2139095040)>>23,n=t&8388607;if(r===255)dataView.setUint16(0,31744,!1);else if(r===0)dataView.setUint16(0,(e&2147483648)>>16|n>>13,!1);else{const o=r-127;o<-24?dataView.setUint16(0,0):o<-14?dataView.setUint16(0,(t&2147483648)>>16|1<<24+o,!1):dataView.setUint16(0,(t&2147483648)>>16|o+15<<10|n>>13,!1)}}}function readFloat16(e,t){if(e.length-t<2)throw new Error(`${decodeErrPrefix} not enough data for float16`);const r=(e[t]<<8)+e[t+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;const n=r>>10&31,o=r&1023;let s;return n===0?s=o*2**-24:n!==31?s=(o+1024)*2**(n-25):s=o===0?1/0:NaN,r&32768?-s:s}function encodeFloat32(e){dataView.setFloat32(0,e,!1)}function readFloat32(e,t){if(e.length-t<4)throw new Error(`${decodeErrPrefix} not enough data for float32`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,4).getFloat32(0,!1)}function encodeFloat64(e){dataView.setFloat64(0,e,!1)}function readFloat64(e,t){if(e.length-t<8)throw new Error(`${decodeErrPrefix} not enough data for float64`);const r=(e.byteOffset||0)+t;return new DataView(e.buffer,r,8).getFloat64(0,!1)}encodeFloat.compareTokens=encodeUint.compareTokens;function invalidMinor(e,t,r){throw new Error(`${decodeErrPrefix} encountered invalid minor (${r}) for major ${e[t]>>>5}`)}function errorer(e){return()=>{throw new Error(`${decodeErrPrefix} ${e}`)}}const jump=[];for(let e=0;e<=23;e++)jump[e]=invalidMinor;jump[24]=decodeUint8;jump[25]=decodeUint16;jump[26]=decodeUint32;jump[27]=decodeUint64;jump[28]=invalidMinor;jump[29]=invalidMinor;jump[30]=invalidMinor;jump[31]=invalidMinor;for(let e=32;e<=55;e++)jump[e]=invalidMinor;jump[56]=decodeNegint8;jump[57]=decodeNegint16;jump[58]=decodeNegint32;jump[59]=decodeNegint64;jump[60]=invalidMinor;jump[61]=invalidMinor;jump[62]=invalidMinor;jump[63]=invalidMinor;for(let e=64;e<=87;e++)jump[e]=decodeBytesCompact;jump[88]=decodeBytes8;jump[89]=decodeBytes16;jump[90]=decodeBytes32;jump[91]=decodeBytes64;jump[92]=invalidMinor;jump[93]=invalidMinor;jump[94]=invalidMinor;jump[95]=errorer("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)jump[e]=decodeStringCompact;jump[120]=decodeString8;jump[121]=decodeString16;jump[122]=decodeString32;jump[123]=decodeString64;jump[124]=invalidMinor;jump[125]=invalidMinor;jump[126]=invalidMinor;jump[127]=errorer("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)jump[e]=decodeArrayCompact;jump[152]=decodeArray8;jump[153]=decodeArray16;jump[154]=decodeArray32;jump[155]=decodeArray64;jump[156]=invalidMinor;jump[157]=invalidMinor;jump[158]=invalidMinor;jump[159]=decodeArrayIndefinite;for(let e=160;e<=183;e++)jump[e]=decodeMapCompact;jump[184]=decodeMap8;jump[185]=decodeMap16;jump[186]=decodeMap32;jump[187]=decodeMap64;jump[188]=invalidMinor;jump[189]=invalidMinor;jump[190]=invalidMinor;jump[191]=decodeMapIndefinite;for(let e=192;e<=215;e++)jump[e]=decodeTagCompact;jump[216]=decodeTag8;jump[217]=decodeTag16;jump[218]=decodeTag32;jump[219]=decodeTag64;jump[220]=invalidMinor;jump[221]=invalidMinor;jump[222]=invalidMinor;jump[223]=invalidMinor;for(let e=224;e<=243;e++)jump[e]=errorer("simple values are not supported");jump[244]=invalidMinor;jump[245]=invalidMinor;jump[246]=invalidMinor;jump[247]=decodeUndefined;jump[248]=errorer("simple values are not supported");jump[249]=decodeFloat16;jump[250]=decodeFloat32;jump[251]=decodeFloat64;jump[252]=invalidMinor;jump[253]=invalidMinor;jump[254]=invalidMinor;jump[255]=decodeBreak;const quick=[];for(let e=0;e<24;e++)quick[e]=new Token(Type.uint,e,1);for(let e=-1;e>=-24;e--)quick[31-e]=new Token(Type.negint,e,1);quick[64]=new Token(Type.bytes,new Uint8Array(0),1);quick[96]=new Token(Type.string,"",1);quick[128]=new Token(Type.array,0,1);quick[160]=new Token(Type.map,0,1);quick[244]=new Token(Type.false,!1,1);quick[245]=new Token(Type.true,!0,1);quick[246]=new Token(Type.null,null,1);function quickEncodeToken(e){switch(e.type){case Type.false:return fromArray([244]);case Type.true:return fromArray([245]);case Type.null:return fromArray([246]);case Type.bytes:return e.value.length?void 0:fromArray([64]);case Type.string:return e.value===""?fromArray([96]):void 0;case Type.array:return e.value===0?fromArray([128]):void 0;case Type.map:return e.value===0?fromArray([160]):void 0;case Type.uint:return e.value<24?fromArray([Number(e.value)]):void 0;case Type.negint:if(e.value>=-24)return fromArray([31-Number(e.value)])}}const defaultEncodeOptions$1={float64:!1,mapSorter:mapSorter$1,quickEncodeToken};function makeCborEncoders(){const e=[];return e[Type.uint.major]=encodeUint,e[Type.negint.major]=encodeNegint,e[Type.bytes.major]=encodeBytes,e[Type.string.major]=encodeString,e[Type.array.major]=encodeArray,e[Type.map.major]=encodeMap,e[Type.tag.major]=encodeTag,e[Type.float.major]=encodeFloat,e}const cborEncoders=makeCborEncoders(),buf=new Bl;class Ref{constructor(t,r){this.obj=t,this.parent=r}includes(t){let r=this;do if(r.obj===t)return!0;while(r=r.parent);return!1}static createCheck(t,r){if(t&&t.includes(r))throw new Error(`${encodeErrPrefix} object contains circular references`);return new Ref(r,t)}}const simpleTokens={null:new Token(Type.null,null),undefined:new Token(Type.undefined,void 0),true:new Token(Type.true,!0),false:new Token(Type.false,!1),emptyArray:new Token(Type.array,0),emptyMap:new Token(Type.map,0)},typeEncoders={number(e,t,r,n){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new Token(Type.float,e):e>=0?new Token(Type.uint,e):new Token(Type.negint,e)},bigint(e,t,r,n){return e>=BigInt(0)?new Token(Type.uint,e):new Token(Type.negint,e)},Uint8Array(e,t,r,n){return new Token(Type.bytes,e)},string(e,t,r,n){return new Token(Type.string,e)},boolean(e,t,r,n){return e?simpleTokens.true:simpleTokens.false},null(e,t,r,n){return simpleTokens.null},undefined(e,t,r,n){return simpleTokens.undefined},ArrayBuffer(e,t,r,n){return new Token(Type.bytes,new Uint8Array(e))},DataView(e,t,r,n){return new Token(Type.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,r,n){if(!e.length)return r.addBreakTokens===!0?[simpleTokens.emptyArray,new Token(Type.break)]:simpleTokens.emptyArray;n=Ref.createCheck(n,e);const o=[];let s=0;for(const i of e)o[s++]=objectToTokens(i,r,n);return r.addBreakTokens?[new Token(Type.array,e.length),o,new Token(Type.break)]:[new Token(Type.array,e.length),o]},Object(e,t,r,n){const o=t!=="Object",s=o?e.keys():Object.keys(e),i=o?e.size:s.length;if(!i)return r.addBreakTokens===!0?[simpleTokens.emptyMap,new Token(Type.break)]:simpleTokens.emptyMap;n=Ref.createCheck(n,e);const a=[];let d=0;for(const h of s)a[d++]=[objectToTokens(h,r,n),objectToTokens(o?e.get(h):e[h],r,n)];return sortMapEntries(a,r),r.addBreakTokens?[new Token(Type.map,i),a,new Token(Type.break)]:[new Token(Type.map,i),a]}};typeEncoders.Map=typeEncoders.Object;typeEncoders.Buffer=typeEncoders.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))typeEncoders[`${e}Array`]=typeEncoders.DataView;function objectToTokens(e,t={},r){const n=is(e),o=t&&t.typeEncoders&&t.typeEncoders[n]||typeEncoders[n];if(typeof o=="function"){const i=o(e,n,t,r);if(i!=null)return i}const s=typeEncoders[n];if(!s)throw new Error(`${encodeErrPrefix} unsupported type: ${n}`);return s(e,n,t,r)}function sortMapEntries(e,t){t.mapSorter&&e.sort(t.mapSorter)}function mapSorter$1(e,t){const r=Array.isArray(e[0])?e[0][0]:e[0],n=Array.isArray(t[0])?t[0][0]:t[0];if(r.type!==n.type)return r.type.compare(n.type);const o=r.type.major,s=cborEncoders[o].compareTokens(r,n);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function tokensToEncoded(e,t,r,n){if(Array.isArray(t))for(const o of t)tokensToEncoded(e,o,r,n);else r[t.type.major](e,t,n)}function encodeCustom(e,t,r){const n=objectToTokens(e,r);if(!Array.isArray(n)&&r.quickEncodeToken){const o=r.quickEncodeToken(n);if(o)return o;const s=t[n.type.major];if(s.encodedSize){const i=s.encodedSize(n,r),a=new Bl(i);if(s(a,n,r),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return asU8A(a.chunks[0])}}return buf.reset(),tokensToEncoded(buf,n,t,r),buf.toBytes(!0)}function encode$l(e,t){return t=Object.assign({},defaultEncodeOptions$1,t),encodeCustom(e,cborEncoders,t)}const defaultDecodeOptions={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Tokeniser{constructor(t,r={}){this._pos=0,this.data=t,this.options=r}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const t=this.data[this._pos];let r=quick[t];if(r===void 0){const n=jump[t];if(!n)throw new Error(`${decodeErrPrefix} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const o=t&31;r=n(this.data,this._pos,o,this.options)}return this._pos+=r.encodedLength,r}}const DONE=Symbol.for("DONE"),BREAK=Symbol.for("BREAK");function tokenToArray(e,t,r){const n=[];for(let o=0;o<e.value;o++){const s=tokensToObject(t,r);if(s===BREAK){if(e.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed array`)}if(s===DONE)throw new Error(`${decodeErrPrefix} found array but not enough entries (got ${o}, expected ${e.value})`);n[o]=s}return n}function tokenToMap(e,t,r){const n=r.useMaps===!0,o=n?void 0:{},s=n?new Map:void 0;for(let i=0;i<e.value;i++){const a=tokensToObject(t,r);if(a===BREAK){if(e.value===1/0)break;throw new Error(`${decodeErrPrefix} got unexpected break to lengthed map`)}if(a===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${i} [no key], expected ${e.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${decodeErrPrefix} non-string keys not supported (got ${typeof a})`);if(r.rejectDuplicateMapKeys===!0&&(n&&s.has(a)||!n&&a in o))throw new Error(`${decodeErrPrefix} found repeat map key "${a}"`);const d=tokensToObject(t,r);if(d===DONE)throw new Error(`${decodeErrPrefix} found map but not enough entries (got ${i} [no value], expected ${e.value})`);n?s.set(a,d):o[a]=d}return n?s:o}function tokensToObject(e,t){if(e.done())return DONE;const r=e.next();if(r.type===Type.break)return BREAK;if(r.type.terminal)return r.value;if(r.type===Type.array)return tokenToArray(r,e,t);if(r.type===Type.map)return tokenToMap(r,e,t);if(r.type===Type.tag){if(t.tags&&typeof t.tags[r.value]=="function"){const n=tokensToObject(e,t);return t.tags[r.value](n)}throw new Error(`${decodeErrPrefix} tag not supported (${r.value})`)}throw new Error("unsupported")}function decodeFirst(e,t){if(!(e instanceof Uint8Array))throw new Error(`${decodeErrPrefix} data to decode must be a Uint8Array`);t=Object.assign({},defaultDecodeOptions,t);const r=t.tokenizer||new Tokeniser(e,t),n=tokensToObject(r,t);if(n===DONE)throw new Error(`${decodeErrPrefix} did not find any content to decode`);if(n===BREAK)throw new Error(`${decodeErrPrefix} got unexpected break`);return[n,e.subarray(r.pos())]}function decode$u(e,t){const[r,n]=decodeFirst(e,t);if(n.length>0)throw new Error(`${decodeErrPrefix} too many terminals, data makes no sense`);return r}function equals$9(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function coerce$4(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function base$4(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=e.length,d=e.charAt(0),h=Math.log(a)/Math.log(256),b=Math.log(256)/Math.log(a);function y(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";for(var w=0,S=0,$=0,v=l.length;$!==v&&l[$]===0;)$++,w++;for(var C=(v-$)*b+1>>>0,A=new Uint8Array(C);$!==v;){for(var x=l[$],_=0,B=C-1;(x!==0||_<S)&&B!==-1;B--,_++)x+=256*A[B]>>>0,A[B]=x%a>>>0,x=x/a>>>0;if(x!==0)throw new Error("Non-zero carry");S=_,$++}for(var I=C-S;I!==C&&A[I]===0;)I++;for(var D=d.repeat(w);I<C;++I)D+=e.charAt(A[I]);return D}function g(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;var w=0;if(l[w]!==" "){for(var S=0,$=0;l[w]===d;)S++,w++;for(var v=(l.length-w)*h+1>>>0,C=new Uint8Array(v);l[w];){var A=r[l.charCodeAt(w)];if(A===255)return;for(var x=0,_=v-1;(A!==0||x<$)&&_!==-1;_--,x++)A+=a*C[_]>>>0,C[_]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");$=x,w++}if(l[w]!==" "){for(var B=v-$;B!==v&&C[B]===0;)B++;for(var I=new Uint8Array(S+(v-B)),D=S;B!==v;)I[D++]=C[B++];return I}}}function p(l){var w=g(l);if(w)return w;throw new Error(`Non-${t} character`)}return{encode:y,decodeUnsafe:g,decode:p}}var src$5=base$4,_brrp__multiformats_scope_baseX$4=src$5;let Encoder$4=class{name;prefix;baseEncode;constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Decoder$4=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,r,n){this.name=t,this.prefix=r;const o=r.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return or$4(this,t)}},ComposedDecoder$4=class{decoders;constructor(t){this.decoders=t}or(t){return or$4(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function or$4(e,t){return new ComposedDecoder$4({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}let Codec$4=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new Encoder$4(t,r,n),this.decoder=new Decoder$4(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function from$5({name:e,prefix:t,encode:r,decode:n}){return new Codec$4(e,t,r,n)}function baseX$4({name:e,prefix:t,alphabet:r}){const{encode:n,decode:o}=_brrp__multiformats_scope_baseX$4(r,e);return from$5({prefix:t,name:e,encode:n,decode:s=>coerce$4(o(s))})}function decode$t(e,t,r,n){let o=e.length;for(;e[o-1]==="=";)--o;const s=new Uint8Array(o*r/8|0);let i=0,a=0,d=0;for(let h=0;h<o;++h){const b=t[e[h]];if(b===void 0)throw new SyntaxError(`Non-${n} character`);a=a<<r|b,i+=r,i>=8&&(i-=8,s[d++]=255&a>>i)}if(i>=r||(255&a<<8-i)!==0)throw new SyntaxError("Unexpected end of data");return s}function encode$k(e,t,r){const n=t[t.length-1]==="=",o=(1<<r)-1;let s="",i=0,a=0;for(let d=0;d<e.length;++d)for(a=a<<8|e[d],i+=8;i>r;)i-=r,s+=t[o&a>>i];if(i!==0&&(s+=t[o&a<<r-i]),n)for(;(s.length*r&7)!==0;)s+="=";return s}function createAlphabetIdx$2(e){const t={};for(let r=0;r<e.length;++r)t[e[r]]=r;return t}function rfc4648$4({name:e,prefix:t,bitsPerChar:r,alphabet:n}){const o=createAlphabetIdx$2(n);return from$5({prefix:t,name:e,encode(s){return encode$k(s,n,r)},decode(s){return decode$t(s,o,r,e)}})}const base32$7=rfc4648$4({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648$4({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});rfc4648$4({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});rfc4648$4({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});rfc4648$4({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});rfc4648$4({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});rfc4648$4({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});rfc4648$4({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});rfc4648$4({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const base36$7=baseX$4({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"});baseX$4({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});const base58btc$4=baseX$4({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX$4({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var encode_1$4=encode$j,MSB$4=128,MSBALL$3=-128,INT$3=Math.pow(2,31);function encode$j(e,t,r){t=t||[],r=r||0;for(var n=r;e>=INT$3;)t[r++]=e&255|MSB$4,e/=128;for(;e&MSBALL$3;)t[r++]=e&255|MSB$4,e>>>=7;return t[r]=e|0,encode$j.bytes=r-n+1,t}var decode$s=read$3,MSB$1$4=128,REST$1$3=127;function read$3(e,n){var r=0,n=n||0,o=0,s=n,i,a=e.length;do{if(s>=a)throw read$3.bytes=0,new RangeError("Could not decode varint");i=e[s++],r+=o<28?(i&REST$1$3)<<o:(i&REST$1$3)*Math.pow(2,o),o+=7}while(i>=MSB$1$4);return read$3.bytes=s-n,r}var N1$4=Math.pow(2,7),N2$4=Math.pow(2,14),N3$4=Math.pow(2,21),N4$4=Math.pow(2,28),N5$4=Math.pow(2,35),N6$4=Math.pow(2,42),N7$4=Math.pow(2,49),N8$3=Math.pow(2,56),N9$3=Math.pow(2,63),length$4=function(e){return e<N1$4?1:e<N2$4?2:e<N3$4?3:e<N4$4?4:e<N5$4?5:e<N6$4?6:e<N7$4?7:e<N8$3?8:e<N9$3?9:10},varint$5={encode:encode_1$4,decode:decode$s,encodingLength:length$4},_brrp_varint$3=varint$5;function decode$r(e,t=0){return[_brrp_varint$3.decode(e,t),_brrp_varint$3.decode.bytes]}function encodeTo$3(e,t,r=0){return _brrp_varint$3.encode(e,t,r),t}function encodingLength$4(e){return _brrp_varint$3.encodingLength(e)}function create$4(e,t){const r=t.byteLength,n=encodingLength$4(e),o=n+encodingLength$4(r),s=new Uint8Array(o+r);return encodeTo$3(e,s,0),encodeTo$3(r,s,n),s.set(t,o),new Digest$3(e,r,t,s)}function decode$q(e){const t=coerce$4(e),[r,n]=decode$r(t),[o,s]=decode$r(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Digest$3(r,o,i,t)}function equals$8(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&equals$9(e.bytes,r.bytes)}}let Digest$3=class{code;size;digest;bytes;constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}};function format$4(e,t){const{bytes:r,version:n}=e;switch(n){case 0:return toStringV0$3(r,baseCache$3(e),t??base58btc$4.encoder);default:return toStringV1$3(r,baseCache$3(e),t??base32$7.encoder)}}const cache$3=new WeakMap;function baseCache$3(e){const t=cache$3.get(e);if(t==null){const r=new Map;return cache$3.set(e,r),r}return t}let CID$3=class z{code;version;multihash;bytes;"/";constructor(t,r,n,o){this.code=r,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:r}=this;if(t!==DAG_PB_CODE$3)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==SHA_256_CODE$3)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return z.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:r}=this.multihash,n=create$4(t,r);return z.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return z.equals(this,t)}static equals(t,r){const n=r;return n!=null&&t.code===n.code&&t.version===n.version&&equals$8(t.multihash,n.multihash)}toString(t){return format$4(this,t)}toJSON(){return{"/":format$4(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;const r=t;if(r instanceof z)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){const{version:n,code:o,multihash:s,bytes:i}=r;return new z(n,o,s,i??encodeCID$4(n,o,s.bytes))}else if(r[cidSymbol$3]===!0){const{version:n,multihash:o,code:s}=r,i=decode$q(o);return z.create(n,s,i)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==DAG_PB_CODE$3)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$3}) block encoding`);return new z(t,r,n,n.bytes)}case 1:{const o=encodeCID$4(t,r,n.bytes);return new z(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return z.create(0,DAG_PB_CODE$3,t)}static createV1(t,r){return z.create(1,t,r)}static decode(t){const[r,n]=z.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(t){const r=z.inspectBytes(t),n=r.size-r.multihashSize,o=coerce$4(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");const s=o.subarray(r.multihashSize-r.digestSize),i=new Digest$3(r.multihashCode,r.digestSize,s,o);return[r.version===0?z.createV0(i):z.createV1(r.codec,i),t.subarray(r.size)]}static inspectBytes(t){let r=0;const n=()=>{const[y,g]=decode$r(t.subarray(r));return r+=g,y};let o=n(),s=DAG_PB_CODE$3;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);const i=r,a=n(),d=n(),h=r+d,b=h-i;return{version:o,codec:s,multihashCode:a,digestSize:d,multihashSize:b,size:h}}static parse(t,r){const[n,o]=parseCIDtoBytes$3(t,r),s=z.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache$3(s).set(n,t),s}};function parseCIDtoBytes$3(e,t){switch(e[0]){case"Q":{const r=t??base58btc$4;return[base58btc$4.prefix,r.decode(`${base58btc$4.prefix}${e}`)]}case base58btc$4.prefix:{const r=t??base58btc$4;return[base58btc$4.prefix,r.decode(e)]}case base32$7.prefix:{const r=t??base32$7;return[base32$7.prefix,r.decode(e)]}case base36$7.prefix:{const r=t??base36$7;return[base36$7.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}}function toStringV0$3(e,t,r){const{prefix:n}=r;if(n!==base58btc$4.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const o=t.get(n);if(o==null){const s=r.encode(e).slice(1);return t.set(n,s),s}else return o}function toStringV1$3(e,t,r){const{prefix:n}=r,o=t.get(n);if(o==null){const s=r.encode(e);return t.set(n,s),s}else return o}const DAG_PB_CODE$3=112,SHA_256_CODE$3=18;function encodeCID$4(e,t,r){const n=encodingLength$4(e),o=n+encodingLength$4(t),s=new Uint8Array(o+r.byteLength);return encodeTo$3(e,s,0),encodeTo$3(t,s,n),s.set(r,o),s}const cidSymbol$3=Symbol.for("@ipld/js-cid/CID"),CID_CBOR_TAG=42;function toByteView$1(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function cidEncoder$1(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=CID$3.asCID(e);if(!t)return null;const r=new Uint8Array(t.bytes.byteLength+1);return r.set(t.bytes,1),[new Token(Type.tag,CID_CBOR_TAG),new Token(Type.bytes,r)]}function undefinedEncoder$1(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder$1(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const _encodeOptions={float64:!0,typeEncoders:{Object:cidEncoder$1,undefined:undefinedEncoder$1,number:numberEncoder$1}},encodeOptions$1={..._encodeOptions,typeEncoders:{..._encodeOptions.typeEncoders}};function cidDecoder(e){if(e[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return CID$3.decode(e.subarray(1))}const _decodeOptions={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};_decodeOptions.tags[CID_CBOR_TAG]=cidDecoder;const decodeOptions$1={..._decodeOptions,tags:_decodeOptions.tags.slice()},name$5="dag-cbor",code$5=113,encode$i=e=>encode$l(e,_encodeOptions),decode$p=e=>decode$u(toByteView$1(e),_decodeOptions),dagCBOR=Object.freeze(Object.defineProperty({__proto__:null,code:code$5,decode:decode$p,decodeOptions:decodeOptions$1,encode:encode$i,encodeOptions:encodeOptions$1,name:name$5,toByteView:toByteView$1},Symbol.toStringTag,{value:"Module"}));class JSONEncoder extends Array{constructor(){super(),this.inRecursive=[]}prefix(t){const r=this.inRecursive[this.inRecursive.length-1];r&&(r.type===Type.array&&(r.elements++,r.elements!==1&&t.push([44])),r.type===Type.map&&(r.elements++,r.elements!==1&&(r.elements%2===1?t.push([44]):t.push([58]))))}[Type.uint.major](t,r){this.prefix(t);const n=String(r.value),o=[];for(let s=0;s<n.length;s++)o[s]=n.charCodeAt(s);t.push(o)}[Type.negint.major](t,r){this[Type.uint.major](t,r)}[Type.bytes.major](t,r){throw new Error(`${encodeErrPrefix} unsupported type: Uint8Array`)}[Type.string.major](t,r){this.prefix(t);const n=fromString$7(JSON.stringify(r.value));t.push(n.length>32?asU8A(n):n)}[Type.array.major](t,r){this.prefix(t),this.inRecursive.push({type:Type.array,elements:0}),t.push([91])}[Type.map.major](t,r){this.prefix(t),this.inRecursive.push({type:Type.map,elements:0}),t.push([123])}[Type.tag.major](t,r){}[Type.float.major](t,r){if(r.type.name==="break"){const i=this.inRecursive.pop();if(i){if(i.type===Type.array)t.push([93]);else if(i.type===Type.map)t.push([125]);else throw new Error("Unexpected recursive type; this should not happen!");return}throw new Error("Unexpected break; this should not happen!")}if(r.value===void 0)throw new Error(`${encodeErrPrefix} unsupported type: undefined`);if(this.prefix(t),r.type.name==="true"){t.push([116,114,117,101]);return}else if(r.type.name==="false"){t.push([102,97,108,115,101]);return}else if(r.type.name==="null"){t.push([110,117,108,108]);return}const n=String(r.value),o=[];let s=!1;for(let i=0;i<n.length;i++)o[i]=n.charCodeAt(i),!s&&(o[i]===46||o[i]===101||o[i]===69)&&(s=!0);s||(o.push(46),o.push(48)),t.push(o)}}function mapSorter(e,t){if(Array.isArray(e[0])||Array.isArray(t[0]))throw new Error(`${encodeErrPrefix} complex map keys are not supported`);const r=e[0],n=t[0];if(r.type!==Type.string||n.type!==Type.string)throw new Error(`${encodeErrPrefix} non-string map keys are not supported`);if(r<n)return-1;if(r>n)return 1;throw new Error(`${encodeErrPrefix} unexpected duplicate map keys, this is not supported`)}const defaultEncodeOptions={addBreakTokens:!0,mapSorter};function encode$h(e,t){return t=Object.assign({},defaultEncodeOptions,t),encodeCustom(e,new JSONEncoder,t)}class Tokenizer{constructor(t,r={}){this._pos=0,this.data=t,this.options=r,this.modeStack=["value"],this.lastToken=""}pos(){return this._pos}done(){return this._pos>=this.data.length}ch(){return this.data[this._pos]}currentMode(){return this.modeStack[this.modeStack.length-1]}skipWhitespace(){let t=this.ch();for(;t===32||t===9||t===13||t===10;)t=this.data[++this._pos]}expect(t){if(this.data.length-this._pos<t.length)throw new Error(`${decodeErrPrefix} unexpected end of input at position ${this._pos}`);for(let r=0;r<t.length;r++)if(this.data[this._pos++]!==t[r])throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}, expected to find '${String.fromCharCode(...t)}'`)}parseNumber(){const t=this._pos;let r=!1,n=!1;const o=a=>{for(;!this.done();){const d=this.ch();if(a.includes(d))this._pos++;else break}};if(this.ch()===45&&(r=!0,this._pos++),this.ch()===48)if(this._pos++,this.ch()===46)this._pos++,n=!0;else return new Token(Type.uint,0,this._pos-t);if(o([48,49,50,51,52,53,54,55,56,57]),r&&this._pos===t+1)throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}`);if(!this.done()&&this.ch()===46){if(n)throw new Error(`${decodeErrPrefix} unexpected token at position ${this._pos}`);n=!0,this._pos++,o([48,49,50,51,52,53,54,55,56,57])}!this.done()&&(this.ch()===101||this.ch()===69)&&(n=!0,this._pos++,!this.done()&&(this.ch()===43||this.ch()===45)&&this._pos++,o([48,49,50,51,52,53,54,55,56,57]));const s=String.fromCharCode.apply(null,this.data.subarray(t,this._pos)),i=parseFloat(s);return n?new Token(Type.float,i,this._pos-t):this.options.allowBigInt!==!0||Number.isSafeInteger(i)?new Token(i>=0?Type.uint:Type.negint,i,this._pos-t):new Token(i>=0?Type.uint:Type.negint,BigInt(s),this._pos-t)}parseString(){if(this.ch()!==34)throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}; this shouldn't happen`);this._pos++;for(let s=this._pos,i=0;s<this.data.length&&i<65536;s++,i++){const a=this.data[s];if(a===92||a<32||a>=128)break;if(a===34){const d=String.fromCharCode.apply(null,this.data.subarray(this._pos,s));return this._pos=s+1,new Token(Type.string,d,i)}}const t=this._pos,r=[],n=()=>{if(this._pos+4>=this.data.length)throw new Error(`${decodeErrPrefix} unexpected end of unicode escape sequence at position ${this._pos}`);let s=0;for(let i=0;i<4;i++){let a=this.ch();if(a>=48&&a<=57)a-=48;else if(a>=97&&a<=102)a=a-97+10;else if(a>=65&&a<=70)a=a-65+10;else throw new Error(`${decodeErrPrefix} unexpected unicode escape character at position ${this._pos}`);s=s*16+a,this._pos++}return s},o=()=>{const s=this.ch();let i=null,a=s>239?4:s>223?3:s>191?2:1;if(this._pos+a>this.data.length)throw new Error(`${decodeErrPrefix} unexpected unicode sequence at position ${this._pos}`);let d,h,b,y;switch(a){case 1:s<128&&(i=s);break;case 2:d=this.data[this._pos+1],(d&192)===128&&(y=(s&31)<<6|d&63,y>127&&(i=y));break;case 3:d=this.data[this._pos+1],h=this.data[this._pos+2],(d&192)===128&&(h&192)===128&&(y=(s&15)<<12|(d&63)<<6|h&63,y>2047&&(y<55296||y>57343)&&(i=y));break;case 4:d=this.data[this._pos+1],h=this.data[this._pos+2],b=this.data[this._pos+3],(d&192)===128&&(h&192)===128&&(b&192)===128&&(y=(s&15)<<18|(d&63)<<12|(h&63)<<6|b&63,y>65535&&y<1114112&&(i=y))}i===null?(i=65533,a=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|i&1023),r.push(i),this._pos+=a};for(;!this.done();){const s=this.ch();let i;switch(s){case 92:if(this._pos++,this.done())throw new Error(`${decodeErrPrefix} unexpected string termination at position ${this._pos}`);switch(i=this.ch(),this._pos++,i){case 34:case 39:case 92:case 47:r.push(i);break;case 98:r.push(8);break;case 116:r.push(9);break;case 110:r.push(10);break;case 102:r.push(12);break;case 114:r.push(13);break;case 117:r.push(n());break;default:throw new Error(`${decodeErrPrefix} unexpected string escape character at position ${this._pos}`)}break;case 34:return this._pos++,new Token(Type.string,decodeCodePointsArray(r),this._pos-t);default:if(s<32)throw new Error(`${decodeErrPrefix} invalid control character at position ${this._pos}`);s<128?(r.push(s),this._pos++):o()}}throw new Error(`${decodeErrPrefix} unexpected end of string at position ${this._pos}`)}parseValue(){switch(this.ch()){case 123:return this.modeStack.push("obj-start"),this._pos++,new Token(Type.map,1/0,1);case 91:return this.modeStack.push("array-start"),this._pos++,new Token(Type.array,1/0,1);case 34:return this.parseString();case 110:return this.expect([110,117,108,108]),new Token(Type.null,null,4);case 102:return this.expect([102,97,108,115,101]),new Token(Type.false,!1,5);case 116:return this.expect([116,114,117,101]),new Token(Type.true,!0,4);case 45:case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.parseNumber();default:throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}`)}}next(){switch(this.skipWhitespace(),this.currentMode()){case"value":return this.modeStack.pop(),this.parseValue();case"array-value":{if(this.modeStack.pop(),this.ch()===93)return this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(this.ch()!==44)throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting array delimiter but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue()}case"array-start":return this.modeStack.pop(),this.ch()===93?(this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1)):(this.modeStack.push("array-value"),this.skipWhitespace(),this.parseValue());case"obj-key":if(this.ch()===125)return this.modeStack.pop(),this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);if(this.ch()!==44)throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting object delimiter but found '${String.fromCharCode(this.ch())}'`);this._pos++,this.skipWhitespace();case"obj-start":{if(this.modeStack.pop(),this.ch()===125)return this._pos++,this.skipWhitespace(),new Token(Type.break,void 0,1);const t=this.parseString();if(this.skipWhitespace(),this.ch()!==58)throw new Error(`${decodeErrPrefix} unexpected character at position ${this._pos}, was expecting key/value delimiter ':' but found '${String.fromCharCode(this.ch())}'`);return this._pos++,this.modeStack.push("obj-value"),t}case"obj-value":return this.modeStack.pop(),this.modeStack.push("obj-key"),this.skipWhitespace(),this.parseValue();default:throw new Error(`${decodeErrPrefix} unexpected parse state at position ${this._pos}; this shouldn't happen`)}}}function decode$o(e,t){return t=Object.assign({tokenizer:new Tokenizer(e,t)},t),decode$u(e,t)}function equals$7(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function coerce$3(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function base$3(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=e.length,d=e.charAt(0),h=Math.log(a)/Math.log(256),b=Math.log(256)/Math.log(a);function y(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";for(var w=0,S=0,$=0,v=l.length;$!==v&&l[$]===0;)$++,w++;for(var C=(v-$)*b+1>>>0,A=new Uint8Array(C);$!==v;){for(var x=l[$],_=0,B=C-1;(x!==0||_<S)&&B!==-1;B--,_++)x+=256*A[B]>>>0,A[B]=x%a>>>0,x=x/a>>>0;if(x!==0)throw new Error("Non-zero carry");S=_,$++}for(var I=C-S;I!==C&&A[I]===0;)I++;for(var D=d.repeat(w);I<C;++I)D+=e.charAt(A[I]);return D}function g(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;var w=0;if(l[w]!==" "){for(var S=0,$=0;l[w]===d;)S++,w++;for(var v=(l.length-w)*h+1>>>0,C=new Uint8Array(v);l[w];){var A=r[l.charCodeAt(w)];if(A===255)return;for(var x=0,_=v-1;(A!==0||x<$)&&_!==-1;_--,x++)A+=a*C[_]>>>0,C[_]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");$=x,w++}if(l[w]!==" "){for(var B=v-$;B!==v&&C[B]===0;)B++;for(var I=new Uint8Array(S+(v-B)),D=S;B!==v;)I[D++]=C[B++];return I}}}function p(l){var w=g(l);if(w)return w;throw new Error(`Non-${t} character`)}return{encode:y,decodeUnsafe:g,decode:p}}var src$4=base$3,_brrp__multiformats_scope_baseX$3=src$4;let Encoder$3=class{name;prefix;baseEncode;constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Decoder$3=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,r,n){this.name=t,this.prefix=r;const o=r.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return or$3(this,t)}},ComposedDecoder$3=class{decoders;constructor(t){this.decoders=t}or(t){return or$3(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function or$3(e,t){return new ComposedDecoder$3({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}let Codec$3=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new Encoder$3(t,r,n),this.decoder=new Decoder$3(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function from$4({name:e,prefix:t,encode:r,decode:n}){return new Codec$3(e,t,r,n)}function baseX$3({name:e,prefix:t,alphabet:r}){const{encode:n,decode:o}=_brrp__multiformats_scope_baseX$3(r,e);return from$4({prefix:t,name:e,encode:n,decode:s=>coerce$3(o(s))})}function decode$n(e,t,r,n){let o=e.length;for(;e[o-1]==="=";)--o;const s=new Uint8Array(o*r/8|0);let i=0,a=0,d=0;for(let h=0;h<o;++h){const b=t[e[h]];if(b===void 0)throw new SyntaxError(`Non-${n} character`);a=a<<r|b,i+=r,i>=8&&(i-=8,s[d++]=255&a>>i)}if(i>=r||(255&a<<8-i)!==0)throw new SyntaxError("Unexpected end of data");return s}function encode$g(e,t,r){const n=t[t.length-1]==="=",o=(1<<r)-1;let s="",i=0,a=0;for(let d=0;d<e.length;++d)for(a=a<<8|e[d],i+=8;i>r;)i-=r,s+=t[o&a>>i];if(i!==0&&(s+=t[o&a<<r-i]),n)for(;(s.length*r&7)!==0;)s+="=";return s}function createAlphabetIdx$1(e){const t={};for(let r=0;r<e.length;++r)t[e[r]]=r;return t}function rfc4648$3({name:e,prefix:t,bitsPerChar:r,alphabet:n}){const o=createAlphabetIdx$1(n);return from$4({prefix:t,name:e,encode(s){return encode$g(s,n,r)},decode(s){return decode$n(s,o,r,e)}})}const base32$6=rfc4648$3({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5});rfc4648$3({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5});rfc4648$3({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5});rfc4648$3({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5});rfc4648$3({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5});rfc4648$3({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});rfc4648$3({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});rfc4648$3({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5});rfc4648$3({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});const base36$6=baseX$3({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"});baseX$3({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});const base58btc$3=baseX$3({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"});baseX$3({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var encode_1$3=encode$f,MSB$3=128,MSBALL$2=-128,INT$2=Math.pow(2,31);function encode$f(e,t,r){t=t||[],r=r||0;for(var n=r;e>=INT$2;)t[r++]=e&255|MSB$3,e/=128;for(;e&MSBALL$2;)t[r++]=e&255|MSB$3,e>>>=7;return t[r]=e|0,encode$f.bytes=r-n+1,t}var decode$m=read$2,MSB$1$3=128,REST$1$2=127;function read$2(e,n){var r=0,n=n||0,o=0,s=n,i,a=e.length;do{if(s>=a)throw read$2.bytes=0,new RangeError("Could not decode varint");i=e[s++],r+=o<28?(i&REST$1$2)<<o:(i&REST$1$2)*Math.pow(2,o),o+=7}while(i>=MSB$1$3);return read$2.bytes=s-n,r}var N1$3=Math.pow(2,7),N2$3=Math.pow(2,14),N3$3=Math.pow(2,21),N4$3=Math.pow(2,28),N5$3=Math.pow(2,35),N6$3=Math.pow(2,42),N7$3=Math.pow(2,49),N8$2=Math.pow(2,56),N9$2=Math.pow(2,63),length$3=function(e){return e<N1$3?1:e<N2$3?2:e<N3$3?3:e<N4$3?4:e<N5$3?5:e<N6$3?6:e<N7$3?7:e<N8$2?8:e<N9$2?9:10},varint$4={encode:encode_1$3,decode:decode$m,encodingLength:length$3},_brrp_varint$2=varint$4;function decode$l(e,t=0){return[_brrp_varint$2.decode(e,t),_brrp_varint$2.decode.bytes]}function encodeTo$2(e,t,r=0){return _brrp_varint$2.encode(e,t,r),t}function encodingLength$3(e){return _brrp_varint$2.encodingLength(e)}function create$3(e,t){const r=t.byteLength,n=encodingLength$3(e),o=n+encodingLength$3(r),s=new Uint8Array(o+r);return encodeTo$2(e,s,0),encodeTo$2(r,s,n),s.set(t,o),new Digest$2(e,r,t,s)}function decode$k(e){const t=coerce$3(e),[r,n]=decode$l(t),[o,s]=decode$l(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Digest$2(r,o,i,t)}function equals$6(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&equals$7(e.bytes,r.bytes)}}let Digest$2=class{code;size;digest;bytes;constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}};function format$3(e,t){const{bytes:r,version:n}=e;switch(n){case 0:return toStringV0$2(r,baseCache$2(e),t??base58btc$3.encoder);default:return toStringV1$2(r,baseCache$2(e),t??base32$6.encoder)}}const cache$2=new WeakMap;function baseCache$2(e){const t=cache$2.get(e);if(t==null){const r=new Map;return cache$2.set(e,r),r}return t}let CID$2=class q{code;version;multihash;bytes;"/";constructor(t,r,n,o){this.code=r,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:r}=this;if(t!==DAG_PB_CODE$2)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==SHA_256_CODE$2)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return q.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:r}=this.multihash,n=create$3(t,r);return q.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return q.equals(this,t)}static equals(t,r){const n=r;return n!=null&&t.code===n.code&&t.version===n.version&&equals$6(t.multihash,n.multihash)}toString(t){return format$3(this,t)}toJSON(){return{"/":format$3(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;const r=t;if(r instanceof q)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){const{version:n,code:o,multihash:s,bytes:i}=r;return new q(n,o,s,i??encodeCID$3(n,o,s.bytes))}else if(r[cidSymbol$2]===!0){const{version:n,multihash:o,code:s}=r,i=decode$k(o);return q.create(n,s,i)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==DAG_PB_CODE$2)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$2}) block encoding`);return new q(t,r,n,n.bytes)}case 1:{const o=encodeCID$3(t,r,n.bytes);return new q(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return q.create(0,DAG_PB_CODE$2,t)}static createV1(t,r){return q.create(1,t,r)}static decode(t){const[r,n]=q.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(t){const r=q.inspectBytes(t),n=r.size-r.multihashSize,o=coerce$3(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");const s=o.subarray(r.multihashSize-r.digestSize),i=new Digest$2(r.multihashCode,r.digestSize,s,o);return[r.version===0?q.createV0(i):q.createV1(r.codec,i),t.subarray(r.size)]}static inspectBytes(t){let r=0;const n=()=>{const[y,g]=decode$l(t.subarray(r));return r+=g,y};let o=n(),s=DAG_PB_CODE$2;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);const i=r,a=n(),d=n(),h=r+d,b=h-i;return{version:o,codec:s,multihashCode:a,digestSize:d,multihashSize:b,size:h}}static parse(t,r){const[n,o]=parseCIDtoBytes$2(t,r),s=q.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache$2(s).set(n,t),s}};function parseCIDtoBytes$2(e,t){switch(e[0]){case"Q":{const r=t??base58btc$3;return[base58btc$3.prefix,r.decode(`${base58btc$3.prefix}${e}`)]}case base58btc$3.prefix:{const r=t??base58btc$3;return[base58btc$3.prefix,r.decode(e)]}case base32$6.prefix:{const r=t??base32$6;return[base32$6.prefix,r.decode(e)]}case base36$6.prefix:{const r=t??base36$6;return[base36$6.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}}function toStringV0$2(e,t,r){const{prefix:n}=r;if(n!==base58btc$3.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const o=t.get(n);if(o==null){const s=r.encode(e).slice(1);return t.set(n,s),s}else return o}function toStringV1$2(e,t,r){const{prefix:n}=r,o=t.get(n);if(o==null){const s=r.encode(e);return t.set(n,s),s}else return o}const DAG_PB_CODE$2=112,SHA_256_CODE$2=18;function encodeCID$3(e,t,r){const n=encodingLength$3(e),o=n+encodingLength$3(t),s=new Uint8Array(o+r.byteLength);return encodeTo$2(e,s,0),encodeTo$2(t,s,n),s.set(r,o),s}const cidSymbol$2=Symbol.for("@ipld/js-cid/CID"),base64$7=rfc4648$3({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});rfc4648$3({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});rfc4648$3({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6});rfc4648$3({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});function toByteView(e){return e instanceof ArrayBuffer?new Uint8Array(e,0,e.byteLength):e}function cidEncoder(e){if(e.asCID!==e&&e["/"]!==e.bytes)return null;const t=CID$2.asCID(e);if(!t)return null;const r=t.toString();return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.string,r,r.length),new Token(Type.break,void 0,1)]}function bytesEncoder(e){const t=base64$7.encode(e).slice(1);return[new Token(Type.map,1/0,1),new Token(Type.string,"/",1),new Token(Type.map,1/0,1),new Token(Type.string,"bytes",5),new Token(Type.string,t,t.length),new Token(Type.break,void 0,1),new Token(Type.break,void 0,1)]}function taBytesEncoder(e){return bytesEncoder(new Uint8Array(e.buffer,e.byteOffset,e.byteLength))}function abBytesEncoder(e){return bytesEncoder(new Uint8Array(e))}function undefinedEncoder(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function numberEncoder(e){if(Number.isNaN(e))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(e===1/0||e===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}const encodeOptions={typeEncoders:{Object:cidEncoder,Buffer:bytesEncoder,Uint8Array:bytesEncoder,Int8Array:taBytesEncoder,Uint16Array:taBytesEncoder,Int16Array:taBytesEncoder,Uint32Array:taBytesEncoder,Int32Array:taBytesEncoder,Float32Array:taBytesEncoder,Float64Array:taBytesEncoder,Uint8ClampedArray:taBytesEncoder,BigInt64Array:taBytesEncoder,BigUint64Array:taBytesEncoder,DataView:taBytesEncoder,ArrayBuffer:abBytesEncoder,undefined:undefinedEncoder,number:numberEncoder}};class DagJsonTokenizer extends Tokenizer{constructor(t,r){super(t,r),this.tokenBuffer=[]}done(){return this.tokenBuffer.length===0&&super.done()}_next(){return this.tokenBuffer.length>0?this.tokenBuffer.pop():super.next()}next(){const t=this._next();if(t.type===Type.map){const r=this._next();if(r.type===Type.string&&r.value==="/"){const n=this._next();if(n.type===Type.string){if(this._next().type!==Type.break)throw new Error("Invalid encoded CID form");return this.tokenBuffer.push(n),new Token(Type.tag,42,0)}if(n.type===Type.map){const o=this._next();if(o.type===Type.string&&o.value==="bytes"){const s=this._next();if(s.type===Type.string){for(let a=0;a<2;a++)if(this._next().type!==Type.break)throw new Error("Invalid encoded Bytes form");const i=base64$7.decode(`m${s.value}`);return new Token(Type.bytes,i,s.value.length)}this.tokenBuffer.push(s)}this.tokenBuffer.push(o)}this.tokenBuffer.push(n)}this.tokenBuffer.push(r)}return t}}const decodeOptions={allowIndefinite:!1,allowUndefined:!1,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};decodeOptions.tags[42]=CID$2.parse;const name$4="dag-json",code$4=297,encode$e=e=>encode$h(e,encodeOptions),decode$j=e=>{const t=toByteView(e),r=Object.assign(decodeOptions,{tokenizer:new DagJsonTokenizer(t,decodeOptions)});return decode$o(t,r)},format$2=e=>utf8Decoder.decode(encode$e(e)),utf8Decoder=new TextDecoder,parse$1=e=>decode$j(utf8Encoder.encode(e)),utf8Encoder=new TextEncoder,dagJSON=Object.freeze(Object.defineProperty({__proto__:null,code:code$4,decode:decode$j,encode:encode$e,format:format$2,name:name$4,parse:parse$1,stringify:format$2},Symbol.toStringTag,{value:"Module"}));function base$2(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=e.length,d=e.charAt(0),h=Math.log(a)/Math.log(256),b=Math.log(256)/Math.log(a);function y(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";for(var w=0,S=0,$=0,v=l.length;$!==v&&l[$]===0;)$++,w++;for(var C=(v-$)*b+1>>>0,A=new Uint8Array(C);$!==v;){for(var x=l[$],_=0,B=C-1;(x!==0||_<S)&&B!==-1;B--,_++)x+=256*A[B]>>>0,A[B]=x%a>>>0,x=x/a>>>0;if(x!==0)throw new Error("Non-zero carry");S=_,$++}for(var I=C-S;I!==C&&A[I]===0;)I++;for(var D=d.repeat(w);I<C;++I)D+=e.charAt(A[I]);return D}function g(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;var w=0;if(l[w]!==" "){for(var S=0,$=0;l[w]===d;)S++,w++;for(var v=(l.length-w)*h+1>>>0,C=new Uint8Array(v);l[w];){var A=r[l.charCodeAt(w)];if(A===255)return;for(var x=0,_=v-1;(A!==0||x<$)&&_!==-1;_--,x++)A+=a*C[_]>>>0,C[_]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");$=x,w++}if(l[w]!==" "){for(var B=v-$;B!==v&&C[B]===0;)B++;for(var I=new Uint8Array(S+(v-B)),D=S;B!==v;)I[D++]=C[B++];return I}}}function p(l){var w=g(l);if(w)return w;throw new Error(`Non-${t} character`)}return{encode:y,decodeUnsafe:g,decode:p}}var src$3=base$2,_brrp__multiformats_scope_baseX$2=src$3;const equals$5=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},coerce$2=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},fromString$6=e=>new TextEncoder().encode(e),toString$6=e=>new TextDecoder().decode(e);let Encoder$2=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Decoder$2=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return or$2(this,t)}},ComposedDecoder$2=class{constructor(t){this.decoders=t}or(t){return or$2(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$2=(e,t)=>new ComposedDecoder$2({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});let Codec$2=class{constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new Encoder$2(t,r,n),this.decoder=new Decoder$2(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};const from$3=({name:e,prefix:t,encode:r,decode:n})=>new Codec$2(e,t,r,n),baseX$2=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:o}=_brrp__multiformats_scope_baseX$2(r,t);return from$3({prefix:e,name:t,encode:n,decode:s=>coerce$2(o(s))})},decode$i=(e,t,r,n)=>{const o={};for(let b=0;b<t.length;++b)o[t[b]]=b;let s=e.length;for(;e[s-1]==="=";)--s;const i=new Uint8Array(s*r/8|0);let a=0,d=0,h=0;for(let b=0;b<s;++b){const y=o[e[b]];if(y===void 0)throw new SyntaxError(`Non-${n} character`);d=d<<r|y,a+=r,a>=8&&(a-=8,i[h++]=255&d>>a)}if(a>=r||255&d<<8-a)throw new SyntaxError("Unexpected end of data");return i},encode$d=(e,t,r)=>{const n=t[t.length-1]==="=",o=(1<<r)-1;let s="",i=0,a=0;for(let d=0;d<e.length;++d)for(a=a<<8|e[d],i+=8;i>r;)i-=r,s+=t[o&a>>i];if(i&&(s+=t[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},rfc4648$2=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>from$3({prefix:t,name:e,encode(o){return encode$d(o,n,r)},decode(o){return decode$i(o,n,r,e)}}),base64$5=rfc4648$2({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$2=rfc4648$2({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$2=rfc4648$2({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$2=rfc4648$2({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$6=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$5,base64pad:base64pad$2,base64url:base64url$2,base64urlpad:base64urlpad$2},Symbol.toStringTag,{value:"Module"}));function toBase64url(e){return base64url$2.encode(e).slice(1)}function fromBase64url(e){return base64url$2.decode(`u${e}`)}var encode_1$2=encode$c,MSB$2=128,MSBALL$1=-128,INT$1=Math.pow(2,31);function encode$c(e,t,r){t=t||[],r=r||0;for(var n=r;e>=INT$1;)t[r++]=e&255|MSB$2,e/=128;for(;e&MSBALL$1;)t[r++]=e&255|MSB$2,e>>>=7;return t[r]=e|0,encode$c.bytes=r-n+1,t}var decode$h=read$1,MSB$1$2=128,REST$1$1=127;function read$1(e,n){var r=0,n=n||0,o=0,s=n,i,a=e.length;do{if(s>=a)throw read$1.bytes=0,new RangeError("Could not decode varint");i=e[s++],r+=o<28?(i&REST$1$1)<<o:(i&REST$1$1)*Math.pow(2,o),o+=7}while(i>=MSB$1$2);return read$1.bytes=s-n,r}var N1$2=Math.pow(2,7),N2$2=Math.pow(2,14),N3$2=Math.pow(2,21),N4$2=Math.pow(2,28),N5$2=Math.pow(2,35),N6$2=Math.pow(2,42),N7$2=Math.pow(2,49),N8$1=Math.pow(2,56),N9$1=Math.pow(2,63),length$2=function(e){return e<N1$2?1:e<N2$2?2:e<N3$2?3:e<N4$2?4:e<N5$2?5:e<N6$2?6:e<N7$2?7:e<N8$1?8:e<N9$1?9:10},varint$3={encode:encode_1$2,decode:decode$h,encodingLength:length$2},_brrp_varint$1=varint$3;const decode$g=(e,t=0)=>[_brrp_varint$1.decode(e,t),_brrp_varint$1.decode.bytes],encodeTo$1=(e,t,r=0)=>(_brrp_varint$1.encode(e,t,r),t),encodingLength$2=e=>_brrp_varint$1.encodingLength(e),create$2=(e,t)=>{const r=t.byteLength,n=encodingLength$2(e),o=n+encodingLength$2(r),s=new Uint8Array(o+r);return encodeTo$1(e,s,0),encodeTo$1(r,s,n),s.set(t,o),new Digest$1(e,r,t,s)},decode$f=e=>{const t=coerce$2(e),[r,n]=decode$g(t),[o,s]=decode$g(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Digest$1(r,o,i,t)},equals$4=(e,t)=>{if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&equals$5(e.bytes,r.bytes)}};let Digest$1=class{constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}};const base58btc$2=baseX$2({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$2=baseX$2({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$2=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$2,base58flickr:base58flickr$2},Symbol.toStringTag,{value:"Module"})),base32$4=rfc4648$2({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$2=rfc4648$2({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$2=rfc4648$2({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$2=rfc4648$2({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$2=rfc4648$2({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$2=rfc4648$2({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$2=rfc4648$2({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$2=rfc4648$2({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$2=rfc4648$2({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$5=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$4,base32hex:base32hex$2,base32hexpad:base32hexpad$2,base32hexpadupper:base32hexpadupper$2,base32hexupper:base32hexupper$2,base32pad:base32pad$2,base32padupper:base32padupper$2,base32upper:base32upper$2,base32z:base32z$2},Symbol.toStringTag,{value:"Module"})),format$1=(e,t)=>{const{bytes:r,version:n}=e;switch(n){case 0:return toStringV0$1(r,baseCache$1(e),t||base58btc$2.encoder);default:return toStringV1$1(r,baseCache$1(e),t||base32$4.encoder)}},cache$1=new WeakMap,baseCache$1=e=>{const t=cache$1.get(e);if(t==null){const r=new Map;return cache$1.set(e,r),r}return t};let CID$1=class H{constructor(t,r,n,o){this.code=r,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:r}=this;if(t!==DAG_PB_CODE$1)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==SHA_256_CODE$1)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return H.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:r}=this.multihash,n=create$2(t,r);return H.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return H.equals(this,t)}static equals(t,r){const n=r;return n&&t.code===n.code&&t.version===n.version&&equals$4(t.multihash,n.multihash)}toString(t){return format$1(this,t)}toJSON(){return{"/":format$1(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;const r=t;if(r instanceof H)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){const{version:n,code:o,multihash:s,bytes:i}=r;return new H(n,o,s,i||encodeCID$2(n,o,s.bytes))}else if(r[cidSymbol$1]===!0){const{version:n,multihash:o,code:s}=r,i=decode$f(o);return H.create(n,s,i)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==DAG_PB_CODE$1)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE$1}) block encoding`);return new H(t,r,n,n.bytes)}case 1:{const o=encodeCID$2(t,r,n.bytes);return new H(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return H.create(0,DAG_PB_CODE$1,t)}static createV1(t,r){return H.create(1,t,r)}static decode(t){const[r,n]=H.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){const r=H.inspectBytes(t),n=r.size-r.multihashSize,o=coerce$2(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");const s=o.subarray(r.multihashSize-r.digestSize),i=new Digest$1(r.multihashCode,r.digestSize,s,o);return[r.version===0?H.createV0(i):H.createV1(r.codec,i),t.subarray(r.size)]}static inspectBytes(t){let r=0;const n=()=>{const[y,g]=decode$g(t.subarray(r));return r+=g,y};let o=n(),s=DAG_PB_CODE$1;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);const i=r,a=n(),d=n(),h=r+d,b=h-i;return{version:o,codec:s,multihashCode:a,digestSize:d,multihashSize:b,size:h}}static parse(t,r){const[n,o]=parseCIDtoBytes$1(t,r),s=H.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache$1(s).set(n,t),s}};const parseCIDtoBytes$1=(e,t)=>{switch(e[0]){case"Q":{const r=t||base58btc$2;return[base58btc$2.prefix,r.decode(`${base58btc$2.prefix}${e}`)]}case base58btc$2.prefix:{const r=t||base58btc$2;return[base58btc$2.prefix,r.decode(e)]}case base32$4.prefix:{const r=t||base32$4;return[base32$4.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},toStringV0$1=(e,t,r)=>{const{prefix:n}=r;if(n!==base58btc$2.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const o=t.get(n);if(o==null){const s=r.encode(e).slice(1);return t.set(n,s),s}else return o},toStringV1$1=(e,t,r)=>{const{prefix:n}=r,o=t.get(n);if(o==null){const s=r.encode(e);return t.set(n,s),s}else return o},DAG_PB_CODE$1=112,SHA_256_CODE$1=18,encodeCID$2=(e,t,r)=>{const n=encodingLength$2(e),o=n+encodingLength$2(t),s=new Uint8Array(o+r.byteLength);return encodeTo$1(e,s,0),encodeTo$1(t,s,n),s.set(r,o),s},cidSymbol$1=Symbol.for("@ipld/js-cid/CID");function fromSplit$1(e){const[t,r,n]=e;return{payload:r,signatures:[{protected:t,signature:n}],link:CID$1.decode(fromBase64url(r))}}function encodeSignature(e){const t={signature:fromBase64url(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=fromBase64url(e.protected)),t}function encode$b(e){const t=fromBase64url(e.payload);try{CID$1.decode(t)}catch{throw new Error("Not a valid DagJWS")}return{payload:t,signatures:e.signatures.map(encodeSignature)}}function decodeSignature(e){const t={signature:toBase64url(e.signature)};return e.header&&(t.header=e.header),e.protected&&(t.protected=toBase64url(e.protected)),t}function decode$e(e){const t={payload:toBase64url(e.payload),signatures:e.signatures.map(decodeSignature)};return t.link=CID$1.decode(new Uint8Array(e.payload)),t}function fromSplit(e){const[t,r,n,o,s]=e,i={ciphertext:o,iv:n,protected:t,tag:s};return r&&(i.recipients=[{encrypted_key:r}]),i}function encodeRecipient(e){const t={};return e.encrypted_key&&(t.encrypted_key=fromBase64url(e.encrypted_key)),e.header&&(t.header=e.header),t}function encode$a(e){const t={ciphertext:fromBase64url(e.ciphertext),protected:fromBase64url(e.protected),iv:fromBase64url(e.iv),tag:fromBase64url(e.tag)};return e.aad&&(t.aad=fromBase64url(e.aad)),e.recipients&&(t.recipients=e.recipients.map(encodeRecipient)),e.unprotected&&(t.unprotected=e.unprotected),t}function decodeRecipient(e){const t={};return e.encrypted_key&&(t.encrypted_key=toBase64url(e.encrypted_key)),e.header&&(t.header=e.header),t}function decode$d(e){const t={ciphertext:toBase64url(e.ciphertext),protected:toBase64url(e.protected),iv:toBase64url(e.iv),tag:toBase64url(e.tag)};return e.aad&&(t.aad=toBase64url(e.aad)),e.recipients&&(t.recipients=e.recipients.map(decodeRecipient)),e.unprotected&&(t.unprotected=e.unprotected),t}const name$3="dag-jose",code$3=133;function isDagJWS(e){return"payload"in e&&typeof e.payload=="string"&&"signatures"in e&&Array.isArray(e.signatures)}function isEncodedJWS(e){return"payload"in e&&e.payload instanceof Uint8Array&&"signatures"in e&&Array.isArray(e.signatures)}function isEncodedJWE(e){return"ciphertext"in e&&e.ciphertext instanceof Uint8Array&&"iv"in e&&e.iv instanceof Uint8Array&&"protected"in e&&e.protected instanceof Uint8Array&&"tag"in e&&e.tag instanceof Uint8Array}function isDagJWE(e){return"ciphertext"in e&&typeof e.ciphertext=="string"&&"iv"in e&&typeof e.iv=="string"&&"protected"in e&&typeof e.protected=="string"&&"tag"in e&&typeof e.tag=="string"}function toGeneral(e){if(typeof e=="string"){const t=e.split(".");if(t.length===3)return fromSplit$1(t);if(t.length===5)return fromSplit(t);throw new Error("Not a valid JOSE string")}if(isDagJWS(e)||isDagJWE(e))return e;throw new Error("Not a valid unencoded JOSE object")}function encode$9(e){typeof e=="string"&&(e=toGeneral(e));let t;if(isDagJWS(e))t=encode$b(e);else if(isDagJWE(e))t=encode$a(e);else throw new Error("Not a valid JOSE object");return new Uint8Array(encode$i(t))}function decode$c(e){let t;try{t=decode$p(e)}catch{throw new Error("Not a valid DAG-JOSE object")}if(isEncodedJWS(t))return decode$e(t);if(isEncodedJWE(t))return decode$d(t);throw new Error("Not a valid DAG-JOSE object")}const dagJOSE=Object.freeze(Object.defineProperty({__proto__:null,code:code$3,decode:decode$c,encode:encode$9,name:name$3,toGeneral},Symbol.toStringTag,{value:"Module"})),code$2=0,name$2="identity",encode$8=coerce$2,digest=e=>create$2(code$2,encode$8(e)),identity$3={code:code$2,name:name$2,encode:encode$8,digest},identity$4=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$3},Symbol.toStringTag,{value:"Module"})),identity$2=from$3({prefix:"\0",name:"identity",encode:e=>toString$6(e),decode:e=>fromString$6(e)}),identityBase$2=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$2},Symbol.toStringTag,{value:"Module"})),base2$4=rfc4648$2({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$5=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$4},Symbol.toStringTag,{value:"Module"})),base8$4=rfc4648$2({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$5=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$4},Symbol.toStringTag,{value:"Module"})),base10$4=baseX$2({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$5=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$4},Symbol.toStringTag,{value:"Module"})),base16$4=rfc4648$2({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$2=rfc4648$2({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$5=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$4,base16upper:base16upper$2},Symbol.toStringTag,{value:"Module"})),base36$4=baseX$2({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$2=baseX$2({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$5=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$4,base36upper:base36upper$2},Symbol.toStringTag,{value:"Module"})),alphabet$2=Array.from(""),alphabetBytesToChars$2=alphabet$2.reduce((e,t,r)=>(e[r]=t,e),[]),alphabetCharsToBytes$2=alphabet$2.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function encode$7(e){return e.reduce((t,r)=>(t+=alphabetBytesToChars$2[r],t),"")}function decode$b(e){const t=[];for(const r of e){const n=alphabetCharsToBytes$2[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const base256emoji$4=from$3({prefix:"",name:"base256emoji",encode:encode$7,decode:decode$b}),base256emoji$5=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$4},Symbol.toStringTag,{value:"Module"})),from$2=({name:e,code:t,encode:r})=>new Hasher(e,t,r);class Hasher{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?create$2(this.code,r):r.then(n=>create$2(this.code,n))}else throw Error("Unknown type, must be binary type")}}const sha=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),sha256=from$2({name:"sha2-256",code:18,encode:sha("SHA-256")}),sha512=from$2({name:"sha2-512",code:19,encode:sha("SHA-512")}),sha2=Object.freeze(Object.defineProperty({__proto__:null,sha256,sha512},Symbol.toStringTag,{value:"Module"})),name$1="raw",code$1=85,encode$6=e=>coerce$2(e),decode$a=e=>coerce$2(e),raw=Object.freeze(Object.defineProperty({__proto__:null,code:code$1,decode:decode$a,encode:encode$6,name:name$1},Symbol.toStringTag,{value:"Module"})),textEncoder=new TextEncoder,textDecoder=new TextDecoder,name="json",code=512,encode$5=e=>textEncoder.encode(JSON.stringify(e)),decode$9=e=>JSON.parse(textDecoder.decode(e)),json=Object.freeze(Object.defineProperty({__proto__:null,code,decode:decode$9,encode:encode$5,name},Symbol.toStringTag,{value:"Module"})),bases$2={...identityBase$2,...base2$5,...base8$5,...base10$5,...base16$5,...base32$5,...base36$5,...base58$2,...base64$6,...base256emoji$5},hashes={...sha2,...identity$4},codecs$1={raw,json};class Parser{index=0;input="";new(t){return this.index=0,this.input=t,this}readAtomically(t){const r=this.index,n=t();return n===void 0&&(this.index=r),n}parseWith(t){const r=t();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(t){return this.readAtomically(()=>{const r=this.readChar();if(r===t)return r})}readSeparator(t,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(t)===void 0))return n()})}readNumber(t,r,n,o){return this.readAtomically(()=>{let s=0,i=0;const a=this.peekChar();if(a===void 0)return;const d=a==="0",h=2**(8*o)-1;for(;;){const b=this.readAtomically(()=>{const y=this.readChar();if(y===void 0)return;const g=Number.parseInt(y,t);if(!Number.isNaN(g))return g});if(b===void 0)break;if(s*=t,s+=b,s>h||(i+=1,r!==void 0&&i>r))return}if(i!==0)return!n&&d&&i>1?void 0:s})}readIPv4Addr(){return this.readAtomically(()=>{const t=new Uint8Array(4);for(let r=0;r<t.length;r++){const n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;t[r]=n}return t})}readIPv6Addr(){const t=r=>{for(let n=0;n<r.length/2;n++){const o=n*2;if(n<r.length-3){const i=this.readSeparator(":",n,()=>this.readIPv4Addr());if(i!==void 0)return r[o]=i[0],r[o+1]=i[1],r[o+2]=i[2],r[o+3]=i[3],[o+4,!0]}const s=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(s===void 0)return[o,!1];r[o]=s>>8,r[o+1]=s&255}return[r.length,!1]};return this.readAtomically(()=>{const r=new Uint8Array(16),[n,o]=t(r);if(n===16)return r;if(o||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;const s=new Uint8Array(14),i=16-(n+2),[a]=t(s.subarray(0,i));return r.set(s.subarray(0,a),16-a),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}}const MAX_IPV6_LENGTH=45,MAX_IPV4_LENGTH=15,parser=new Parser;function parseIPv4(e){if(!(e.length>MAX_IPV4_LENGTH))return parser.new(e).parseWith(()=>parser.readIPv4Addr())}function parseIPv6(e){if(e.includes("%")&&(e=e.split("%")[0]),!(e.length>MAX_IPV6_LENGTH))return parser.new(e).parseWith(()=>parser.readIPv6Addr())}function parseIP(e,t=!1){if(e.includes("%")&&(e=e.split("%")[0]),e.length>MAX_IPV6_LENGTH)return;const r=parser.new(e).parseWith(()=>parser.readIPAddr());if(r)return t&&r.length===4?Uint8Array.from([0,0,0,0,0,0,0,0,0,0,255,255,r[0],r[1],r[2],r[3]]):r}function isIPv4(e){return!!parseIPv4(e)}function isIPv6(e){return!!parseIPv6(e)}function isIP(e){return!!parseIP(e)}function base$1(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=e.length,d=e.charAt(0),h=Math.log(a)/Math.log(256),b=Math.log(256)/Math.log(a);function y(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";for(var w=0,S=0,$=0,v=l.length;$!==v&&l[$]===0;)$++,w++;for(var C=(v-$)*b+1>>>0,A=new Uint8Array(C);$!==v;){for(var x=l[$],_=0,B=C-1;(x!==0||_<S)&&B!==-1;B--,_++)x+=256*A[B]>>>0,A[B]=x%a>>>0,x=x/a>>>0;if(x!==0)throw new Error("Non-zero carry");S=_,$++}for(var I=C-S;I!==C&&A[I]===0;)I++;for(var D=d.repeat(w);I<C;++I)D+=e.charAt(A[I]);return D}function g(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;var w=0;if(l[w]!==" "){for(var S=0,$=0;l[w]===d;)S++,w++;for(var v=(l.length-w)*h+1>>>0,C=new Uint8Array(v);l[w];){var A=r[l.charCodeAt(w)];if(A===255)return;for(var x=0,_=v-1;(A!==0||x<$)&&_!==-1;_--,x++)A+=a*C[_]>>>0,C[_]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");$=x,w++}if(l[w]!==" "){for(var B=v-$;B!==v&&C[B]===0;)B++;for(var I=new Uint8Array(S+(v-B)),D=S;B!==v;)I[D++]=C[B++];return I}}}function p(l){var w=g(l);if(w)return w;throw new Error(`Non-${t} character`)}return{encode:y,decodeUnsafe:g,decode:p}}var src$2=base$1,_brrp__multiformats_scope_baseX$1=src$2;const coerce$1=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},fromString$5=e=>new TextEncoder().encode(e),toString$5=e=>new TextDecoder().decode(e);let Encoder$1=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Decoder$1=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return or$1(this,t)}},ComposedDecoder$1=class{constructor(t){this.decoders=t}or(t){return or$1(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const or$1=(e,t)=>new ComposedDecoder$1({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});let Codec$1=class{constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new Encoder$1(t,r,n),this.decoder=new Decoder$1(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};const from$1=({name:e,prefix:t,encode:r,decode:n})=>new Codec$1(e,t,r,n),baseX$1=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:o}=_brrp__multiformats_scope_baseX$1(r,t);return from$1({prefix:e,name:t,encode:n,decode:s=>coerce$1(o(s))})},decode$8=(e,t,r,n)=>{const o={};for(let b=0;b<t.length;++b)o[t[b]]=b;let s=e.length;for(;e[s-1]==="=";)--s;const i=new Uint8Array(s*r/8|0);let a=0,d=0,h=0;for(let b=0;b<s;++b){const y=o[e[b]];if(y===void 0)throw new SyntaxError(`Non-${n} character`);d=d<<r|y,a+=r,a>=8&&(a-=8,i[h++]=255&d>>a)}if(a>=r||255&d<<8-a)throw new SyntaxError("Unexpected end of data");return i},encode$4=(e,t,r)=>{const n=t[t.length-1]==="=",o=(1<<r)-1;let s="",i=0,a=0;for(let d=0;d<e.length;++d)for(a=a<<8|e[d],i+=8;i>r;)i-=r,s+=t[o&a>>i];if(i&&(s+=t[o&a<<r-i]),n)for(;s.length*r&7;)s+="=";return s},rfc4648$1=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>from$1({prefix:t,name:e,encode(o){return encode$4(o,n,r)},decode(o){return decode$8(o,n,r,e)}}),base10$2=baseX$1({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$3=Object.freeze(Object.defineProperty({__proto__:null,base10:base10$2},Symbol.toStringTag,{value:"Module"})),base16$2=rfc4648$1({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper$1=rfc4648$1({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$3=Object.freeze(Object.defineProperty({__proto__:null,base16:base16$2,base16upper:base16upper$1},Symbol.toStringTag,{value:"Module"})),base2$2=rfc4648$1({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$3=Object.freeze(Object.defineProperty({__proto__:null,base2:base2$2},Symbol.toStringTag,{value:"Module"})),alphabet$1=Array.from(""),alphabetBytesToChars$1=alphabet$1.reduce((e,t,r)=>(e[r]=t,e),[]),alphabetCharsToBytes$1=alphabet$1.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function encode$3(e){return e.reduce((t,r)=>(t+=alphabetBytesToChars$1[r],t),"")}function decode$7(e){const t=[];for(const r of e){const n=alphabetCharsToBytes$1[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const base256emoji$2=from$1({prefix:"",name:"base256emoji",encode:encode$3,decode:decode$7}),base256emoji$3=Object.freeze(Object.defineProperty({__proto__:null,base256emoji:base256emoji$2},Symbol.toStringTag,{value:"Module"})),base32$2=rfc4648$1({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper$1=rfc4648$1({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad$1=rfc4648$1({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper$1=rfc4648$1({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex$1=rfc4648$1({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper$1=rfc4648$1({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad$1=rfc4648$1({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper$1=rfc4648$1({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z$1=rfc4648$1({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$3=Object.freeze(Object.defineProperty({__proto__:null,base32:base32$2,base32hex:base32hex$1,base32hexpad:base32hexpad$1,base32hexpadupper:base32hexpadupper$1,base32hexupper:base32hexupper$1,base32pad:base32pad$1,base32padupper:base32padupper$1,base32upper:base32upper$1,base32z:base32z$1},Symbol.toStringTag,{value:"Module"})),base36$2=baseX$1({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper$1=baseX$1({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$3=Object.freeze(Object.defineProperty({__proto__:null,base36:base36$2,base36upper:base36upper$1},Symbol.toStringTag,{value:"Module"})),base58btc$1=baseX$1({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr$1=baseX$1({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58$1=Object.freeze(Object.defineProperty({__proto__:null,base58btc:base58btc$1,base58flickr:base58flickr$1},Symbol.toStringTag,{value:"Module"})),base64$3=rfc4648$1({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad$1=rfc4648$1({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url$1=rfc4648$1({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad$1=rfc4648$1({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$4=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$3,base64pad:base64pad$1,base64url:base64url$1,base64urlpad:base64urlpad$1},Symbol.toStringTag,{value:"Module"})),base8$2=rfc4648$1({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$3=Object.freeze(Object.defineProperty({__proto__:null,base8:base8$2},Symbol.toStringTag,{value:"Module"})),identity$1=from$1({prefix:"\0",name:"identity",encode:e=>toString$5(e),decode:e=>fromString$5(e)}),identityBase$1=Object.freeze(Object.defineProperty({__proto__:null,identity:identity$1},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;const bases$1={...identityBase$1,...base2$3,...base8$3,...base10$3,...base16$3,...base32$3,...base36$3,...base58$1,...base64$4,...base256emoji$3};function asUint8Array$1(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function allocUnsafe$1(e=0){return globalThis.Buffer?.allocUnsafe!=null?asUint8Array$1(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function createCodec$1(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const string$1=createCodec$1("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),ascii$1=createCodec$1("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=allocUnsafe$1(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),BASES$1={utf8:string$1,"utf-8":string$1,hex:bases$1.base16,latin1:ascii$1,ascii:ascii$1,binary:ascii$1,...bases$1};function toString$4(e,t="utf8"){const r=BASES$1[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}const isV4$1=isIPv4,isV6$1=isIPv6,toBytes$2=function(e){let t=0;if(e=e.toString().trim(),isV4$1(e)){const r=new Uint8Array(t+4);return e.split(/\./g).forEach(n=>{r[t++]=parseInt(n,10)&255}),r}if(isV6$1(e)){const r=e.split(":",8);let n;for(n=0;n<r.length;n++){const s=isV4$1(r[n]);let i;s&&(i=toBytes$2(r[n]),r[n]=toString$4(i.slice(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,toString$4(i.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);const s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}const o=new Uint8Array(t+16);for(n=0;n<r.length;n++){const s=parseInt(r[n],16);o[t++]=s>>8&255,o[t++]=s&255}return o}throw new Error("invalid ip address")},toString$3=function(e,t=0,r){t=~~t,r=r??e.length-t;const n=new DataView(e.buffer);if(r===4){const o=[];for(let s=0;s<r;s++)o.push(e[t+s]);return o.join(".")}if(r===16){const o=[];for(let s=0;s<r;s+=2)o.push(n.getUint16(t+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},V$2=-1,names$1={},codes$1={},table$1=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,V$2,"ip6zone"],[43,8,"ipcidr"],[53,V$2,"dns",!0],[54,V$2,"dns4",!0],[55,V$2,"dns6",!0],[56,V$2,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,V$2,"unix",!1,!0],[421,V$2,"ipfs"],[421,V$2,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,V$2,"garlic64"],[448,0,"tls"],[449,V$2,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,V$2,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,V$2,"memory"]];table$1.forEach(e=>{const t=createProtocol$1(...e);codes$1[t.code]=t,names$1[t.name]=t});function createProtocol$1(e,t,r,n,o){return{code:e,size:t,name:r,resolvable:!!n,path:!!o}}function getProtocol$1(e){if(typeof e=="number"){if(codes$1[e]!=null)return codes$1[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(names$1[e]!=null)return names$1[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}var encode_1$1,hasRequiredEncode;function requireEncode(){if(hasRequiredEncode)return encode_1$1;hasRequiredEncode=1,encode_1$1=n;var e=128,t=-128,r=Math.pow(2,31);function n(o,s,i){if(Number.MAX_SAFE_INTEGER&&o>Number.MAX_SAFE_INTEGER)throw n.bytes=0,new RangeError("Could not encode varint");s=s||[],i=i||0;for(var a=i;o>=r;)s[i++]=o&255|e,o/=128;for(;o&t;)s[i++]=o&255|e,o>>>=7;return s[i]=o|0,n.bytes=i-a+1,s}return encode_1$1}var decode$6,hasRequiredDecode;function requireDecode(){if(hasRequiredDecode)return decode$6;hasRequiredDecode=1,decode$6=r;var e=128,t=127;function r(n,i){var s=0,i=i||0,a=0,d=i,h,b=n.length;do{if(d>=b||a>49)throw r.bytes=0,new RangeError("Could not decode varint");h=n[d++],s+=a<28?(h&t)<<a:(h&t)*Math.pow(2,a),a+=7}while(h>=e);return r.bytes=d-i,s}return decode$6}var length$1,hasRequiredLength;function requireLength(){if(hasRequiredLength)return length$1;hasRequiredLength=1;var e=Math.pow(2,7),t=Math.pow(2,14),r=Math.pow(2,21),n=Math.pow(2,28),o=Math.pow(2,35),s=Math.pow(2,42),i=Math.pow(2,49),a=Math.pow(2,56),d=Math.pow(2,63);return length$1=function(h){return h<e?1:h<t?2:h<r?3:h<n?4:h<o?5:h<s?6:h<i?7:h<a?8:h<d?9:10},length$1}var varint$2,hasRequiredVarint;function requireVarint(){return hasRequiredVarint||(hasRequiredVarint=1,varint$2={encode:requireEncode(),decode:requireDecode(),encodingLength:requireLength()}),varint$2}var varintExports=requireVarint();const varint$1=getDefaultExportFromCjs(varintExports);function fromString$4(e,t="utf8"){const r=BASES$1[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?asUint8Array$1(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}function concat$1(e,t){t==null&&(t=e.reduce((o,s)=>o+s.length,0));const r=allocUnsafe$1(t);let n=0;for(const o of e)r.set(o,n),n+=o.length;return asUint8Array$1(r)}function convertToString$1(e,t){switch(getProtocol$1(e).code){case 4:case 41:return bytes2ip$1(t);case 42:return bytes2str$1(t);case 6:case 273:case 33:case 132:return bytes2port$2(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return bytes2str$1(t);case 421:return bytes2mh$1(t);case 444:return bytes2onion$2(t);case 445:return bytes2onion$2(t);case 466:return bytes2mb$2(t);default:return toString$4(t,"base16")}}function convertToBytes$1(e,t){switch(getProtocol$1(e).code){case 4:return ip2bytes$1(t);case 41:return ip2bytes$1(t);case 42:return str2bytes$1(t);case 6:case 273:case 33:case 132:return port2bytes$2(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return str2bytes$1(t);case 421:return mh2bytes$1(t);case 444:return onion2bytes$2(t);case 445:return onion32bytes$2(t);case 466:return mb2bytes$2(t);default:return fromString$4(t,"base16")}}const decoders$2=Object.values(bases$2).map(e=>e.decoder),anybaseDecoder$2=(function(){let e=decoders$2[0].or(decoders$2[1]);return decoders$2.slice(2).forEach(t=>e=e.or(t)),e})();function ip2bytes$1(e){if(!isIP(e))throw new Error("invalid ip address");return toBytes$2(e)}function bytes2ip$1(e){const t=toString$3(e,0,e.length);if(t==null)throw new Error("ipBuff is required");if(!isIP(t))throw new Error("invalid ip address");return t}function port2bytes$2(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function bytes2port$2(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function str2bytes$1(e){const t=fromString$4(e),r=Uint8Array.from(varint$1.encode(t.length));return concat$1([r,t],r.length+t.length)}function bytes2str$1(e){const t=varint$1.decode(e);if(e=e.slice(varint$1.decode.bytes),e.length!==t)throw new Error("inconsistent lengths");return toString$4(e)}function mh2bytes$1(e){let t;e[0]==="Q"||e[0]==="1"?t=decode$f(base58btc$2.decode(`z${e}`)).bytes:t=CID$1.parse(e).multihash.bytes;const r=Uint8Array.from(varint$1.encode(t.length));return concat$1([r,t],r.length+t.length)}function mb2bytes$2(e){const t=anybaseDecoder$2.decode(e),r=Uint8Array.from(varint$1.encode(t.length));return concat$1([r,t],r.length+t.length)}function bytes2mb$2(e){const t=varint$1.decode(e),r=e.slice(varint$1.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return"u"+toString$4(r,"base64url")}function bytes2mh$1(e){const t=varint$1.decode(e),r=e.slice(varint$1.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return toString$4(r,"base58btc")}function onion2bytes$2(e){const t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const r=base32$4.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const o=port2bytes$2(n);return concat$1([r,o],r.length+o.length)}function onion32bytes$2(e){const t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const r=base32$4.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const o=port2bytes$2(n);return concat$1([r,o],r.length+o.length)}function bytes2onion$2(e){const t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=toString$4(t,"base32"),o=bytes2port$2(r);return`${n}:${o}`}function stringToStringTuples$1(e){const t=[],r=e.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){const o=r[n],s=getProtocol$1(o);if(s.size===0){t.push([o]);continue}if(n++,n>=r.length)throw ParseError$1("invalid address: "+e);if(s.path===!0){t.push([o,cleanPath$1(r.slice(n).join("/"))]);break}t.push([o,r[n]])}return t}function stringTuplesToString$1(e){const t=[];return e.map(r=>{const n=protoFromTuple$1(r);return t.push(n.name),r.length>1&&r[1]!=null&&t.push(r[1]),null}),cleanPath$1(t.join("/"))}function stringTuplesToTuples$1(e){return e.map(t=>{Array.isArray(t)||(t=[t]);const r=protoFromTuple$1(t);return t.length>1?[r.code,convertToBytes$1(r.code,t[1])]:[r.code]})}function tuplesToStringTuples$1(e){return e.map(t=>{const r=protoFromTuple$1(t);return t[1]!=null?[r.code,convertToString$1(r.code,t[1])]:[r.code]})}function tuplesToBytes$1(e){return fromBytes$1(concat$1(e.map(t=>{const r=protoFromTuple$1(t);let n=Uint8Array.from(varint$1.encode(r.code));return t.length>1&&t[1]!=null&&(n=concat$1([n,t[1]])),n})))}function sizeForAddr$2(e,t){return e.size>0?e.size/8:e.size===0?0:varint$1.decode(t)+(varint$1.decode.bytes??0)}function bytesToTuples$1(e){const t=[];let r=0;for(;r<e.length;){const n=varint$1.decode(e,r),o=varint$1.decode.bytes??0,s=getProtocol$1(n),i=sizeForAddr$2(s,e.slice(r+o));if(i===0){t.push([n]),r+=o;continue}const a=e.slice(r+o,r+o+i);if(r+=i+o,r>e.length)throw ParseError$1("Invalid address Uint8Array: "+toString$4(e,"base16"));t.push([n,a])}return t}function bytesToString$2(e){const t=bytesToTuples$1(e),r=tuplesToStringTuples$1(t);return stringTuplesToString$1(r)}function stringToBytes$2(e){e=cleanPath$1(e);const t=stringToStringTuples$1(e),r=stringTuplesToTuples$1(t);return tuplesToBytes$1(r)}function fromString$3(e){return stringToBytes$2(e)}function fromBytes$1(e){const t=validateBytes$1(e);if(t!=null)throw t;return Uint8Array.from(e)}function validateBytes$1(e){try{bytesToTuples$1(e)}catch(t){return t}}function cleanPath$1(e){return"/"+e.trim().split("/").filter(t=>t).join("/")}function ParseError$1(e){return new Error("Error parsing address: "+e)}function protoFromTuple$1(e){return getProtocol$1(e[0])}var errCode$1,hasRequiredErrCode;function requireErrCode(){if(hasRequiredErrCode)return errCode$1;hasRequiredErrCode=1;function e(r,n){for(const o in n)Object.defineProperty(r,o,{value:n[o],enumerable:!0,configurable:!0});return r}function t(r,n,o){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");o||(o={}),typeof n=="object"&&(o=n,n=""),n&&(o.code=n);try{return e(r,o)}catch{o.message=r.message,o.stack=r.stack;const i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(r)),e(new i,o)}}return errCode$1=t,errCode$1}var errCodeExports=requireErrCode();const errCode=getDefaultExportFromCjs(errCodeExports);function equals$3(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var __classPrivateFieldGet$1=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},__classPrivateFieldSet$1=function(e,t,r,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(e,r):o?o.value=r:t.set(e,r),r},_DefaultMultiaddr_string$1,_DefaultMultiaddr_tuples$1,_DefaultMultiaddr_stringTuples$1,_a$1;const inspect$3=Symbol.for("nodejs.util.inspect.custom"),DNS_CODES$2=[getProtocol$1("dns").code,getProtocol$1("dns4").code,getProtocol$1("dns6").code,getProtocol$1("dnsaddr").code],resolvers$2=new Map,symbol$3=Symbol.for("@multiformats/js-multiaddr/multiaddr");function isMultiaddr$2(e){return!!e?.[symbol$3]}let DefaultMultiaddr$1=class re{constructor(t){if(_DefaultMultiaddr_string$1.set(this,void 0),_DefaultMultiaddr_tuples$1.set(this,void 0),_DefaultMultiaddr_stringTuples$1.set(this,void 0),this[_a$1]=!0,t==null&&(t=""),t instanceof Uint8Array)this.bytes=fromBytes$1(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);this.bytes=fromString$3(t)}else if(isMultiaddr$2(t))this.bytes=fromBytes$1(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return __classPrivateFieldGet$1(this,_DefaultMultiaddr_string$1,"f")==null&&__classPrivateFieldSet$1(this,_DefaultMultiaddr_string$1,bytesToString$2(this.bytes),"f"),__classPrivateFieldGet$1(this,_DefaultMultiaddr_string$1,"f")}toJSON(){return this.toString()}toOptions(){let t,r,n,o,s="";const i=getProtocol$1("tcp"),a=getProtocol$1("udp"),d=getProtocol$1("ip4"),h=getProtocol$1("ip6"),b=getProtocol$1("dns6"),y=getProtocol$1("ip6zone");for(const[p,l]of this.stringTuples())p===y.code&&(s=`%${l??""}`),DNS_CODES$2.includes(p)&&(r=i.name,o=443,n=`${l??""}${s}`,t=p===b.code?6:4),(p===i.code||p===a.code)&&(r=getProtocol$1(p).name,o=parseInt(l??"")),(p===d.code||p===h.code)&&(r=getProtocol$1(p).name,n=`${l??""}${s}`,t=p===h.code?6:4);if(t==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:r,port:o}}protos(){return this.protoCodes().map(t=>Object.assign({},getProtocol$1(t)))}protoCodes(){const t=[],r=this.bytes;let n=0;for(;n<r.length;){const o=varint$1.decode(r,n),s=varint$1.decode.bytes??0,i=getProtocol$1(o),a=sizeForAddr$2(i,r.slice(n+s));n+=a+s,t.push(o)}return t}protoNames(){return this.protos().map(t=>t.name)}tuples(){return __classPrivateFieldGet$1(this,_DefaultMultiaddr_tuples$1,"f")==null&&__classPrivateFieldSet$1(this,_DefaultMultiaddr_tuples$1,bytesToTuples$1(this.bytes),"f"),__classPrivateFieldGet$1(this,_DefaultMultiaddr_tuples$1,"f")}stringTuples(){return __classPrivateFieldGet$1(this,_DefaultMultiaddr_stringTuples$1,"f")==null&&__classPrivateFieldSet$1(this,_DefaultMultiaddr_stringTuples$1,tuplesToStringTuples$1(this.tuples()),"f"),__classPrivateFieldGet$1(this,_DefaultMultiaddr_stringTuples$1,"f")}encapsulate(t){return t=new re(t),new re(this.toString()+t.toString())}decapsulate(t){const r=t.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new re(n.slice(0,o))}decapsulateCode(t){const r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===t)return new re(tuplesToBytes$1(r.slice(0,n)));return this}getPeerId(){try{const r=this.stringTuples().filter(n=>n[0]===names$1.ipfs.code).pop();if(r?.[1]!=null){const n=r[1];return n[0]==="Q"||n[0]==="1"?toString$4(base58btc$2.decode(`z${n}`),"base58btc"):toString$4(CID$1.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let t=null;try{t=this.stringTuples().filter(r=>getProtocol$1(r[0]).path===!0)[0][1],t==null&&(t=null)}catch{t=null}return t}equals(t){return equals$3(this.bytes,t.bytes)}async resolve(t){const r=this.protos().find(s=>s.resolvable);if(r==null)return[this];const n=resolvers$2.get(r.name);if(n==null)throw errCode(new Error(`no available resolver for ${r.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,t)).map(s=>new re(s))}nodeAddress(){const t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){const r=(t??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[(_DefaultMultiaddr_string$1=new WeakMap,_DefaultMultiaddr_tuples$1=new WeakMap,_DefaultMultiaddr_stringTuples$1=new WeakMap,_a$1=symbol$3,inspect$3)](){return`Multiaddr(${bytesToString$2(this.bytes)})`}};function multiaddr$2(e){return new DefaultMultiaddr$1(e)}function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var isElectron_1,hasRequiredIsElectron;function requireIsElectron(){if(hasRequiredIsElectron)return isElectron_1;hasRequiredIsElectron=1;function e(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}return isElectron_1=e,isElectron_1}var env,hasRequiredEnv;function requireEnv(){if(hasRequiredEnv)return env;hasRequiredEnv=1;var e={};const t=requireIsElectron(),r=typeof window=="object"&&typeof document=="object"&&document.nodeType===9,n=t(),o=r&&!n,s=n&&!r,i=n&&r,a=typeof commonjsRequire=="function"&&typeof process<"u"&&typeof process.release<"u"&&process.release.name==="node"&&!n,d=typeof importScripts=="function"&&typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,h=typeof process<"u"&&typeof e<"u"&&!1,b=typeof navigator<"u"&&navigator.product==="ReactNative";return env={isTest:h,isElectron:n,isElectronMain:s,isElectronRenderer:i,isNode:a,isBrowser:o,isWebWorker:d,isEnvWithDom:r,isReactNative:b},env}var envExports=requireEnv();let durationRE=/(-?(?:\d+\.?\d*|\d*\.?\d+)(?:e[-+]?\d+)?)\s*([\p{L}]*)/uig;parse.year=parse.yr=parse.y=6e4*60*24*365.25;parse.month=parse.b=6e4*60*24*(365.25/12);parse.week=parse.wk=parse.w=6e4*60*24*7;parse.day=parse.d=6e4*60*24;parse.hour=parse.hr=parse.h=6e4*60;parse.minute=parse.min=parse.m=6e4;parse.second=parse.sec=parse.s=1e3;parse.millisecond=parse.millisec=parse.ms=1;parse.s=parse.s=parse.us=parse.microsecond=1/1e3;parse.nanosecond=parse.ns=1/1e6;function parse(e="",t="ms"){var r=null,n;return e=(e+"").replace(/(\d)[,_](\d)/g,"$1$2"),e.replace(durationRE,function(o,s,i){if(i)i=i.toLowerCase();else if(n){for(var a in parse)if(parse[a]<n){i=a;break}}else i=t;Object.prototype.hasOwnProperty.call(parse,i)?i=parse[i]:Object.prototype.hasOwnProperty.call(parse,i.replace(/s$/,""))?i=parse[i.replace(/s$/,"")]:i=null,i&&(r=(r||0)+Math.abs(parseFloat(s,10))*i,n=i)}),r&&r/(parse[t]||1)*(e[0]==="-"?-1:1)}var browser$1={exports:{}},ms,hasRequiredMs;function requireMs(){if(hasRequiredMs)return ms;hasRequiredMs=1;var e=1e3,t=e*60,r=t*60,n=r*24,o=n*7,s=n*365.25;ms=function(b,y){y=y||{};var g=typeof b;if(g==="string"&&b.length>0)return i(b);if(g==="number"&&isFinite(b))return y.long?d(b):a(b);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(b))};function i(b){if(b=String(b),!(b.length>100)){var y=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(b);if(y){var g=parseFloat(y[1]),p=(y[2]||"ms").toLowerCase();switch(p){case"years":case"year":case"yrs":case"yr":case"y":return g*s;case"weeks":case"week":case"w":return g*o;case"days":case"day":case"d":return g*n;case"hours":case"hour":case"hrs":case"hr":case"h":return g*r;case"minutes":case"minute":case"mins":case"min":case"m":return g*t;case"seconds":case"second":case"secs":case"sec":case"s":return g*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return g;default:return}}}}function a(b){var y=Math.abs(b);return y>=n?Math.round(b/n)+"d":y>=r?Math.round(b/r)+"h":y>=t?Math.round(b/t)+"m":y>=e?Math.round(b/e)+"s":b+"ms"}function d(b){var y=Math.abs(b);return y>=n?h(b,y,n,"day"):y>=r?h(b,y,r,"hour"):y>=t?h(b,y,t,"minute"):y>=e?h(b,y,e,"second"):b+" ms"}function h(b,y,g,p){var l=y>=g*1.5;return Math.round(b/g)+" "+p+(l?"s":"")}return ms}var common,hasRequiredCommon;function requireCommon(){if(hasRequiredCommon)return common;hasRequiredCommon=1;function e(t){n.debug=n,n.default=n,n.coerce=h,n.disable=a,n.enable=s,n.enabled=d,n.humanize=requireMs(),n.destroy=b,Object.keys(t).forEach(y=>{n[y]=t[y]}),n.names=[],n.skips=[],n.formatters={};function r(y){let g=0;for(let p=0;p<y.length;p++)g=(g<<5)-g+y.charCodeAt(p),g|=0;return n.colors[Math.abs(g)%n.colors.length]}n.selectColor=r;function n(y){let g,p=null,l,w;function S(...$){if(!S.enabled)return;const v=S,C=Number(new Date),A=C-(g||C);v.diff=A,v.prev=g,v.curr=C,g=C,$[0]=n.coerce($[0]),typeof $[0]!="string"&&$.unshift("%O");let x=0;$[0]=$[0].replace(/%([a-zA-Z%])/g,(B,I)=>{if(B==="%%")return"%";x++;const D=n.formatters[I];if(typeof D=="function"){const F=$[x];B=D.call(v,F),$.splice(x,1),x--}return B}),n.formatArgs.call(v,$),(v.log||n.log).apply(v,$)}return S.namespace=y,S.useColors=n.useColors(),S.color=n.selectColor(y),S.extend=o,S.destroy=n.destroy,Object.defineProperty(S,"enabled",{enumerable:!0,configurable:!1,get:()=>p!==null?p:(l!==n.namespaces&&(l=n.namespaces,w=n.enabled(y)),w),set:$=>{p=$}}),typeof n.init=="function"&&n.init(S),S}function o(y,g){const p=n(this.namespace+(typeof g>"u"?":":g)+y);return p.log=this.log,p}function s(y){n.save(y),n.namespaces=y,n.names=[],n.skips=[];const g=(typeof y=="string"?y:"").trim().replace(/\s+/g,",").split(",").filter(Boolean);for(const p of g)p[0]==="-"?n.skips.push(p.slice(1)):n.names.push(p)}function i(y,g){let p=0,l=0,w=-1,S=0;for(;p<y.length;)if(l<g.length&&(g[l]===y[p]||g[l]==="*"))g[l]==="*"?(w=l,S=p,l++):(p++,l++);else if(w!==-1)l=w+1,S++,p=S;else return!1;for(;l<g.length&&g[l]==="*";)l++;return l===g.length}function a(){const y=[...n.names,...n.skips.map(g=>"-"+g)].join(",");return n.enable(""),y}function d(y){for(const g of n.skips)if(i(y,g))return!1;for(const g of n.names)if(i(y,g))return!0;return!1}function h(y){return y instanceof Error?y.stack||y.message:y}function b(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}return common=e,common}var hasRequiredBrowser$1;function requireBrowser$1(){return hasRequiredBrowser$1||(hasRequiredBrowser$1=1,(function(e,t){var r={};t.formatArgs=o,t.save=s,t.load=i,t.useColors=n,t.storage=a(),t.destroy=(()=>{let h=!1;return()=>{h||(h=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){if(typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs))return!0;if(typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;let h;return typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&(h=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(h[1],10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function o(h){if(h[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+h[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const b="color: "+this.color;h.splice(1,0,b,"color: inherit");let y=0,g=0;h[0].replace(/%[a-zA-Z%]/g,p=>{p!=="%%"&&(y++,p==="%c"&&(g=y))}),h.splice(g,0,b)}t.log=console.debug||console.log||(()=>{});function s(h){try{h?t.storage.setItem("debug",h):t.storage.removeItem("debug")}catch{}}function i(){let h;try{h=t.storage.getItem("debug")||t.storage.getItem("DEBUG")}catch{}return!h&&typeof process<"u"&&"env"in process&&(h=r.DEBUG),h}function a(){try{return localStorage}catch{}}e.exports=requireCommon()(t);const{formatters:d}=e.exports;d.j=function(h){try{return JSON.stringify(h)}catch(b){return"[UnexpectedJSONParseError]: "+b.message}}})(browser$1,browser$1.exports)),browser$1.exports}var browserExports=requireBrowser$1();const debug=getDefaultExportFromCjs(browserExports);debug.formatters.b=e=>e==null?"undefined":base58btc$2.baseEncode(e);debug.formatters.t=e=>e==null?"undefined":base32$4.baseEncode(e);debug.formatters.m=e=>e==null?"undefined":base64$5.baseEncode(e);debug.formatters.p=e=>e==null?"undefined":e.toString();debug.formatters.c=e=>e==null?"undefined":e.toString();debug.formatters.k=e=>e==null?"undefined":e.toString();debug.formatters.a=e=>e==null?"undefined":e.toString();function createDisabledLogger(e){const t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}function logger(e){let t=createDisabledLogger(`${e}:trace`);return debug.enabled(`${e}:trace`)&&debug.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(t=debug(`${e}:trace`)),Object.assign(debug(e),{error:debug(`${e}:error`),trace:t})}var error={},hasRequiredError;function requireError(){if(hasRequiredError)return error;hasRequiredError=1;class e extends Error{constructor(o="Request timed out"){super(o),this.name="TimeoutError"}}error.TimeoutError=e;class t extends Error{constructor(o="The operation was aborted."){super(o),this.name="AbortError"}}error.AbortError=t;class r extends Error{constructor(o){super(o.statusText),this.name="HTTPError",this.response=o}}return error.HTTPError=r,error}var src$1={exports:{}},browser={exports:{}},hasRequiredBrowser;function requireBrowser(){return hasRequiredBrowser||(hasRequiredBrowser=1,(function(e,t){var r=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof commonjsGlobal<"u")return commonjsGlobal;throw new Error("unable to locate global object")},n=r();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response})(browser,browser.exports)),browser.exports}var hasRequiredSrc;function requireSrc(){return hasRequiredSrc||(hasRequiredSrc=1,globalThis.fetch&&globalThis.Headers&&globalThis.Request&&globalThis.Response?src$1.exports={default:globalThis.fetch,Headers:globalThis.Headers,Request:globalThis.Request,Response:globalThis.Response}:src$1.exports={default:requireBrowser().default,Headers:requireBrowser().Headers,Request:requireBrowser().Request,Response:requireBrowser().Response}),src$1.exports}var fetch_browser$1,hasRequiredFetch_browser$1;function requireFetch_browser$1(){return hasRequiredFetch_browser$1||(hasRequiredFetch_browser$1=1,fetch_browser$1=requireSrc()),fetch_browser$1}var fetch_browser,hasRequiredFetch_browser;function requireFetch_browser(){if(hasRequiredFetch_browser)return fetch_browser;hasRequiredFetch_browser=1;const{TimeoutError:e,AbortError:t}=requireError(),{Response:r,Request:n,Headers:o,default:s}=requireFetch_browser$1(),i=(y,g={})=>{const p=new XMLHttpRequest;p.open(g.method||"GET",y.toString(),!0);const{timeout:l,headers:w}=g;if(l&&l>0&&l<1/0&&(p.timeout=l),g.overrideMimeType!=null&&p.overrideMimeType(g.overrideMimeType),w)for(const[S,$]of new o(w))p.setRequestHeader(S,$);return g.signal&&(g.signal.onabort=()=>p.abort()),g.onUploadProgress&&(p.upload.onprogress=g.onUploadProgress),p.responseType="arraybuffer",new Promise((S,$)=>{const v=C=>{switch(C.type){case"error":{S(r.error());break}case"load":{S(new b(p.responseURL,p.response,{status:p.status,statusText:p.statusText,headers:h(p.getAllResponseHeaders())}));break}case"timeout":{$(new e);break}case"abort":{$(new t);break}}};p.onerror=v,p.onload=v,p.ontimeout=v,p.onabort=v,p.send(g.body)})},a=s,d=(y,g={})=>g.onUploadProgress!=null?i(y,g):a(y,g),h=y=>{const g=new o;for(const p of y.trim().split(/[\r\n]+/)){const l=p.indexOf(": ");l>0&&g.set(p.slice(0,l),p.slice(l+1))}return g};class b extends r{constructor(g,p,l){super(p,l),Object.defineProperty(this,"url",{value:g})}}return fetch_browser={fetch:d,Request:n,Headers:o},fetch_browser}var isPlainObj,hasRequiredIsPlainObj;function requireIsPlainObj(){return hasRequiredIsPlainObj||(hasRequiredIsPlainObj=1,isPlainObj=e=>{if(Object.prototype.toString.call(e)!=="[object Object]")return!1;const t=Object.getPrototypeOf(e);return t===null||t===Object.prototype}),isPlainObj}var mergeOptions$1,hasRequiredMergeOptions;function requireMergeOptions(){if(hasRequiredMergeOptions)return mergeOptions$1;hasRequiredMergeOptions=1;const e=requireIsPlainObj(),{hasOwnProperty:t}=Object.prototype,{propertyIsEnumerable:r}=Object,n=(p,l,w)=>Object.defineProperty(p,l,{value:w,writable:!0,enumerable:!0,configurable:!0}),o=mergeOptions$1,s={concatArrays:!1,ignoreUndefined:!1},i=p=>{const l=[];for(const w in p)t.call(p,w)&&l.push(w);if(Object.getOwnPropertySymbols){const w=Object.getOwnPropertySymbols(p);for(const S of w)r.call(p,S)&&l.push(S)}return l};function a(p){return Array.isArray(p)?d(p):e(p)?h(p):p}function d(p){const l=p.slice(0,0);return i(p).forEach(w=>{n(l,w,a(p[w]))}),l}function h(p){const l=Object.getPrototypeOf(p)===null?Object.create(null):{};return i(p).forEach(w=>{n(l,w,a(p[w]))}),l}const b=(p,l,w,S)=>(w.forEach($=>{typeof l[$]>"u"&&S.ignoreUndefined||($ in p&&p[$]!==Object.getPrototypeOf(p)?n(p,$,g(p[$],l[$],S)):n(p,$,a(l[$])))}),p),y=(p,l,w)=>{let S=p.slice(0,0),$=0;return[p,l].forEach(v=>{const C=[];for(let A=0;A<v.length;A++)t.call(v,A)&&(C.push(String(A)),v===p?n(S,$++,v[A]):n(S,$++,a(v[A])));S=b(S,v,i(v).filter(A=>!C.includes(A)),w)}),S};function g(p,l,w){return w.concatArrays&&Array.isArray(p)&&Array.isArray(l)?y(p,l,w):!e(l)||!e(p)?a(l):b(p,l,i(l),w)}return mergeOptions$1=function(...p){const l=g(a(s),this!==o&&this||{},s);let w={_:{}};for(const S of p)if(S!==void 0){if(!e(S))throw new TypeError("`"+S+"` is not an Option Object");w=g(w,{_:S},l)}return w._},mergeOptions$1}var urlBrowser,hasRequiredUrlBrowser;function requireUrlBrowser(){if(hasRequiredUrlBrowser)return urlBrowser;hasRequiredUrlBrowser=1;const e=typeof navigator<"u"&&navigator.product==="ReactNative";function t(){return e?"http://localhost":self.location?self.location.protocol+"//"+self.location.host:""}const r=self.URL,n=t();class o{constructor(a="",d=n){this.super=new r(a,d),this.path=this.pathname+this.search,this.auth=this.username&&this.password?this.username+":"+this.password:null,this.query=this.search&&this.search.startsWith("?")?this.search.slice(1):null}get hash(){return this.super.hash}get host(){return this.super.host}get hostname(){return this.super.hostname}get href(){return this.super.href}get origin(){return this.super.origin}get password(){return this.super.password}get pathname(){return this.super.pathname}get port(){return this.super.port}get protocol(){return this.super.protocol}get search(){return this.super.search}get searchParams(){return this.super.searchParams}get username(){return this.super.username}set hash(a){this.super.hash=a}set host(a){this.super.host=a}set hostname(a){this.super.hostname=a}set href(a){this.super.href=a}set password(a){this.super.password=a}set pathname(a){this.super.pathname=a}set port(a){this.super.port=a}set protocol(a){this.super.protocol=a}set search(a){this.super.search=a}set username(a){this.super.username=a}static createObjectURL(a){return r.createObjectURL(a)}static revokeObjectURL(a){r.revokeObjectURL(a)}toJSON(){return this.super.toJSON()}toString(){return this.super.toString()}format(){return this.toString()}}function s(i){if(typeof i=="string")return new r(i).toString();if(!(i instanceof r)){const a=i.username&&i.password?`${i.username}:${i.password}@`:"",d=i.auth?i.auth+"@":"",h=i.port?":"+i.port:"",b=i.protocol?i.protocol+"//":"",y=i.host||"",g=i.hostname||"",p=i.search||(i.query?"?"+i.query:""),l=i.hash||"",w=i.pathname||"",S=i.path||w+p;return`${b}${a||d}${y||g+h}${S}${l}`}}return urlBrowser={URLWithLegacySupport:o,URLSearchParams:self.URLSearchParams,defaultBase:n,format:s},urlBrowser}var relative,hasRequiredRelative;function requireRelative(){if(hasRequiredRelative)return relative;hasRequiredRelative=1;const{URLWithLegacySupport:e,format:t}=requireUrlBrowser();return relative=(r,n={},o={},s)=>{let i=n.protocol?n.protocol.replace(":",""):"http";i=(o[i]||s||i)+":";let a;try{a=new e(r)}catch{a={}}const d=Object.assign({},n,{protocol:i||a.protocol,host:n.host||a.host});return new e(r,t(d)).toString()},relative}var isoUrl,hasRequiredIsoUrl;function requireIsoUrl(){if(hasRequiredIsoUrl)return isoUrl;hasRequiredIsoUrl=1;const{URLWithLegacySupport:e,format:t,URLSearchParams:r,defaultBase:n}=requireUrlBrowser(),o=requireRelative();return isoUrl={URL:e,URLSearchParams:r,format:t,relative:o,defaultBase:n},isoUrl}var anySignal={exports:{}},hasRequiredAnySignal;function requireAnySignal(){if(hasRequiredAnySignal)return anySignal.exports;hasRequiredAnySignal=1;function e(t){const r=new globalThis.AbortController;function n(){r.abort();for(const o of t)!o||!o.removeEventListener||o.removeEventListener("abort",n)}for(const o of t)if(!(!o||!o.addEventListener)){if(o.aborted){n();break}o.addEventListener("abort",n)}return r.signal}return anySignal.exports=e,anySignal.exports.anySignal=e,anySignal.exports}var browserReadablestreamToIt,hasRequiredBrowserReadablestreamToIt;function requireBrowserReadablestreamToIt(){if(hasRequiredBrowserReadablestreamToIt)return browserReadablestreamToIt;hasRequiredBrowserReadablestreamToIt=1;async function*e(t,r={}){const n=t.getReader();try{for(;;){const o=await n.read();if(o.done)return;yield o.value}}finally{r.preventCancel!==!0&&n.cancel(),n.releaseLock()}}return browserReadablestreamToIt=e,browserReadablestreamToIt}var itAll,hasRequiredItAll;function requireItAll(){return hasRequiredItAll||(hasRequiredItAll=1,itAll=async t=>{const r=[];for await(const n of t)r.push(n);return r}),itAll}var http,hasRequiredHttp;function requireHttp(){if(hasRequiredHttp)return http;hasRequiredHttp=1;const{fetch:e,Request:t,Headers:r}=requireFetch_browser(),{TimeoutError:n,HTTPError:o}=requireError(),s=requireMergeOptions().bind({ignoreUndefined:!0}),{URL:i,URLSearchParams:a}=requireIsoUrl(),d=requireAnySignal(),h=requireBrowserReadablestreamToIt(),{isBrowser:b,isWebWorker:y}=requireEnv(),g=requireItAll(),p=(x,_,B)=>{if(_===void 0)return x;const I=Date.now(),D=()=>Date.now()-I>=_;return new Promise((F,M)=>{const X=setTimeout(()=>{D()&&(M(new n),B.abort())},_),Z=K=>G=>{if(clearTimeout(X),D()){M(new n);return}K(G)};x.then(Z(F),Z(M))})},l={throwHttpErrors:!0,credentials:"same-origin"};class w{constructor(_={}){this.opts=s(l,_)}async fetch(_,B={}){const I=s(this.opts,B),D=new r(I.headers);if(typeof _!="string"&&!(_ instanceof i||_ instanceof t))throw new TypeError("`resource` must be a string, URL, or Request");const F=new i(_.toString(),I.base),{searchParams:M,transformSearchParams:X,json:Z}=I;M&&(typeof X=="function"?F.search=X(new a(I.searchParams)):F.search=new a(I.searchParams)),Z&&(I.body=JSON.stringify(I.json),D.set("content-type","application/json"));const K=new AbortController,Q=d([K.signal,I.signal]);globalThis.ReadableStream!=null&&I.body instanceof globalThis.ReadableStream&&(b||y)&&(I.body=new Blob(await g(h(I.body))));const G=await p(e(F.toString(),{...I,signal:Q,timeout:void 0,headers:D,duplex:"half"}),I.timeout,K);if(!G.ok&&I.throwHttpErrors)throw I.handleError&&await I.handleError(G),new o(G);return G.iterator=async function*(){yield*$(G.body)},G.ndjson=async function*(){for await(const oe of S(G.iterator()))B.transform?yield B.transform(oe):yield oe},G}post(_,B={}){return this.fetch(_,{...B,method:"POST"})}get(_,B={}){return this.fetch(_,{...B,method:"GET"})}put(_,B={}){return this.fetch(_,{...B,method:"PUT"})}delete(_,B={}){return this.fetch(_,{...B,method:"DELETE"})}options(_,B={}){return this.fetch(_,{...B,method:"OPTIONS"})}}const S=async function*(x){const _=new TextDecoder;let B="";for await(const I of x){B+=_.decode(I,{stream:!0});const D=B.split(/\r?\n/);for(let F=0;F<D.length-1;F++){const M=D[F].trim();M.length>0&&(yield JSON.parse(M))}B=D[D.length-1]}B+=_.decode(),B=B.trim(),B.length!==0&&(yield JSON.parse(B))},$=x=>{if(v(x))return x;if(A(x)){const _=x[Symbol.asyncIterator]();return{[Symbol.asyncIterator](){return{next:_.next.bind(_),return(B){return x.destroy(),typeof _.return=="function"?_.return():Promise.resolve({done:!0,value:B})}}}}}if(C(x)){const _=x.getReader();return(async function*(){try{for(;;){const{done:B,value:I}=await _.read();if(B)return;I&&(yield I)}}finally{_.releaseLock()}})()}throw new TypeError("Body can't be converted to AsyncIterable")},v=x=>typeof x=="object"&&x!==null&&typeof x[Symbol.asyncIterator]=="function",C=x=>x&&typeof x.getReader=="function",A=x=>Object.prototype.hasOwnProperty.call(x,"readable")&&Object.prototype.hasOwnProperty.call(x,"writable");return w.HTTPError=o,w.TimeoutError=n,w.streamToAsyncIterator=$,w.post=(x,_)=>new w(_).post(x,_),w.get=(x,_)=>new w(_).get(x,_),w.put=(x,_)=>new w(_).put(x,_),w.delete=(x,_)=>new w(_).delete(x,_),w.options=(x,_)=>new w(_).options(x,_),http=w,http}var httpExports=requireHttp();const HTTP=getDefaultExportFromCjs(httpExports);var mergeOptionsExports=requireMergeOptions();const mergeOptions=getDefaultExportFromCjs(mergeOptionsExports),isV4=isIPv4,isV6=isIPv6,toBytes$1=function(e){let t=0;if(e=e.toString().trim(),isV4(e)){const r=new Uint8Array(t+4);return e.split(/\./g).forEach(n=>{r[t++]=parseInt(n,10)&255}),r}if(isV6(e)){const r=e.split(":",8);let n;for(n=0;n<r.length;n++){const s=isV4(r[n]);let i;s&&(i=toBytes$1(r[n]),r[n]=toString$4(i.slice(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,toString$4(i.slice(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);const s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}const o=new Uint8Array(t+16);for(n=0;n<r.length;n++){const s=parseInt(r[n],16);o[t++]=s>>8&255,o[t++]=s&255}return o}throw new Error("invalid ip address")},toString$2=function(e,t=0,r){t=~~t,r=r??e.length-t;const n=new DataView(e.buffer);if(r===4){const o=[];for(let s=0;s<r;s++)o.push(e[t+s]);return o.join(".")}if(r===16){const o=[];for(let s=0;s<r;s+=2)o.push(n.getUint16(t+s).toString(16));return o.join(":").replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}return""},V$1=-1,names={},codes={},table=[[4,32,"ip4"],[6,16,"tcp"],[33,16,"dccp"],[41,128,"ip6"],[42,V$1,"ip6zone"],[43,8,"ipcidr"],[53,V$1,"dns",!0],[54,V$1,"dns4",!0],[55,V$1,"dns6",!0],[56,V$1,"dnsaddr",!0],[132,16,"sctp"],[273,16,"udp"],[275,0,"p2p-webrtc-star"],[276,0,"p2p-webrtc-direct"],[277,0,"p2p-stardust"],[280,0,"webrtc"],[281,0,"webrtc-w3c"],[290,0,"p2p-circuit"],[301,0,"udt"],[302,0,"utp"],[400,V$1,"unix",!1,!0],[421,V$1,"ipfs"],[421,V$1,"p2p"],[443,0,"https"],[444,96,"onion"],[445,296,"onion3"],[446,V$1,"garlic64"],[448,0,"tls"],[449,V$1,"sni"],[460,0,"quic"],[461,0,"quic-v1"],[465,0,"webtransport"],[466,V$1,"certhash"],[477,0,"ws"],[478,0,"wss"],[479,0,"p2p-websocket-star"],[480,0,"http"],[777,V$1,"memory"]];table.forEach(e=>{const t=createProtocol(...e);codes[t.code]=t,names[t.name]=t});function createProtocol(e,t,r,n,o){return{code:e,size:t,name:r,resolvable:!!n,path:!!o}}function getProtocol(e){if(typeof e=="number"){if(codes[e]!=null)return codes[e];throw new Error(`no protocol with code: ${e}`)}else if(typeof e=="string"){if(names[e]!=null)return names[e];throw new Error(`no protocol with name: ${e}`)}throw new Error(`invalid protocol id type: ${typeof e}`)}function convertToString(e,t){switch(getProtocol(e).code){case 4:case 41:return bytes2ip(t);case 42:return bytes2str(t);case 6:case 273:case 33:case 132:return bytes2port$1(t).toString();case 53:case 54:case 55:case 56:case 400:case 449:case 777:return bytes2str(t);case 421:return bytes2mh(t);case 444:return bytes2onion$1(t);case 445:return bytes2onion$1(t);case 466:return bytes2mb$1(t);default:return toString$4(t,"base16")}}function convertToBytes(e,t){switch(getProtocol(e).code){case 4:return ip2bytes(t);case 41:return ip2bytes(t);case 42:return str2bytes(t);case 6:case 273:case 33:case 132:return port2bytes$1(parseInt(t,10));case 53:case 54:case 55:case 56:case 400:case 449:case 777:return str2bytes(t);case 421:return mh2bytes(t);case 444:return onion2bytes$1(t);case 445:return onion32bytes$1(t);case 466:return mb2bytes$1(t);default:return fromString$4(t,"base16")}}const decoders$1=Object.values(bases$2).map(e=>e.decoder),anybaseDecoder$1=(function(){let e=decoders$1[0].or(decoders$1[1]);return decoders$1.slice(2).forEach(t=>e=e.or(t)),e})();function ip2bytes(e){if(!isIP(e))throw new Error("invalid ip address");return toBytes$1(e)}function bytes2ip(e){const t=toString$2(e,0,e.length);if(t==null)throw new Error("ipBuff is required");if(!isIP(t))throw new Error("invalid ip address");return t}function port2bytes$1(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,e),new Uint8Array(t)}function bytes2port$1(e){return new DataView(e.buffer).getUint16(e.byteOffset)}function str2bytes(e){const t=fromString$4(e),r=Uint8Array.from(varint$1.encode(t.length));return concat$1([r,t],r.length+t.length)}function bytes2str(e){const t=varint$1.decode(e);if(e=e.slice(varint$1.decode.bytes),e.length!==t)throw new Error("inconsistent lengths");return toString$4(e)}function mh2bytes(e){let t;e[0]==="Q"||e[0]==="1"?t=decode$f(base58btc$2.decode(`z${e}`)).bytes:t=CID$1.parse(e).multihash.bytes;const r=Uint8Array.from(varint$1.encode(t.length));return concat$1([r,t],r.length+t.length)}function mb2bytes$1(e){const t=anybaseDecoder$1.decode(e),r=Uint8Array.from(varint$1.encode(t.length));return concat$1([r,t],r.length+t.length)}function bytes2mb$1(e){const t=varint$1.decode(e),r=e.slice(varint$1.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return"u"+toString$4(r,"base64url")}function bytes2mh(e){const t=varint$1.decode(e),r=e.slice(varint$1.decode.bytes);if(r.length!==t)throw new Error("inconsistent lengths");return toString$4(r,"base58btc")}function onion2bytes$1(e){const t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const r=base32$4.decode("b"+t[0]),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const o=port2bytes$1(n);return concat$1([r,o],r.length+o.length)}function onion32bytes$1(e){const t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const r=base32$4.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const o=port2bytes$1(n);return concat$1([r,o],r.length+o.length)}function bytes2onion$1(e){const t=e.slice(0,e.length-2),r=e.slice(e.length-2),n=toString$4(t,"base32"),o=bytes2port$1(r);return`${n}:${o}`}function stringToStringTuples(e){const t=[],r=e.split("/").slice(1);if(r.length===1&&r[0]==="")return[];for(let n=0;n<r.length;n++){const o=r[n],s=getProtocol(o);if(s.size===0){t.push([o]);continue}if(n++,n>=r.length)throw ParseError("invalid address: "+e);if(s.path===!0){t.push([o,cleanPath(r.slice(n).join("/"))]);break}t.push([o,r[n]])}return t}function stringTuplesToString(e){const t=[];return e.map(r=>{const n=protoFromTuple(r);return t.push(n.name),r.length>1&&r[1]!=null&&t.push(r[1]),null}),cleanPath(t.join("/"))}function stringTuplesToTuples(e){return e.map(t=>{Array.isArray(t)||(t=[t]);const r=protoFromTuple(t);return t.length>1?[r.code,convertToBytes(r.code,t[1])]:[r.code]})}function tuplesToStringTuples(e){return e.map(t=>{const r=protoFromTuple(t);return t[1]!=null?[r.code,convertToString(r.code,t[1])]:[r.code]})}function tuplesToBytes(e){return fromBytes(concat$1(e.map(t=>{const r=protoFromTuple(t);let n=Uint8Array.from(varint$1.encode(r.code));return t.length>1&&t[1]!=null&&(n=concat$1([n,t[1]])),n})))}function sizeForAddr$1(e,t){return e.size>0?e.size/8:e.size===0?0:varint$1.decode(t)+(varint$1.decode.bytes??0)}function bytesToTuples(e){const t=[];let r=0;for(;r<e.length;){const n=varint$1.decode(e,r),o=varint$1.decode.bytes??0,s=getProtocol(n),i=sizeForAddr$1(s,e.slice(r+o));if(i===0){t.push([n]),r+=o;continue}const a=e.slice(r+o,r+o+i);if(r+=i+o,r>e.length)throw ParseError("Invalid address Uint8Array: "+toString$4(e,"base16"));t.push([n,a])}return t}function bytesToString$1(e){const t=bytesToTuples(e),r=tuplesToStringTuples(t);return stringTuplesToString(r)}function stringToBytes$1(e){e=cleanPath(e);const t=stringToStringTuples(e),r=stringTuplesToTuples(t);return tuplesToBytes(r)}function fromString$2(e){return stringToBytes$1(e)}function fromBytes(e){const t=validateBytes(e);if(t!=null)throw t;return Uint8Array.from(e)}function validateBytes(e){try{bytesToTuples(e)}catch(t){return t}}function cleanPath(e){return"/"+e.trim().split("/").filter(t=>t).join("/")}function ParseError(e){return new Error("Error parsing address: "+e)}function protoFromTuple(e){return getProtocol(e[0])}var __classPrivateFieldGet=function(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)},__classPrivateFieldSet=function(e,t,r,n,o){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!o)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?o.call(e,r):o?o.value=r:t.set(e,r),r},_DefaultMultiaddr_string,_DefaultMultiaddr_tuples,_DefaultMultiaddr_stringTuples,_a;const inspect$2=Symbol.for("nodejs.util.inspect.custom"),DNS_CODES$1=[getProtocol("dns").code,getProtocol("dns4").code,getProtocol("dns6").code,getProtocol("dnsaddr").code],resolvers$1=new Map,symbol$2=Symbol.for("@multiformats/js-multiaddr/multiaddr");function isMultiaddr$1(e){return!!e?.[symbol$2]}class DefaultMultiaddr{constructor(t){if(_DefaultMultiaddr_string.set(this,void 0),_DefaultMultiaddr_tuples.set(this,void 0),_DefaultMultiaddr_stringTuples.set(this,void 0),this[_a]=!0,t==null&&(t=""),t instanceof Uint8Array)this.bytes=fromBytes(t);else if(typeof t=="string"){if(t.length>0&&t.charAt(0)!=="/")throw new Error(`multiaddr "${t}" must start with a "/"`);this.bytes=fromString$2(t)}else if(isMultiaddr$1(t))this.bytes=fromBytes(t.bytes);else throw new Error("addr must be a string, Buffer, or another Multiaddr")}toString(){return __classPrivateFieldGet(this,_DefaultMultiaddr_string,"f")==null&&__classPrivateFieldSet(this,_DefaultMultiaddr_string,bytesToString$1(this.bytes),"f"),__classPrivateFieldGet(this,_DefaultMultiaddr_string,"f")}toJSON(){return this.toString()}toOptions(){let t,r,n,o,s="";const i=getProtocol("tcp"),a=getProtocol("udp"),d=getProtocol("ip4"),h=getProtocol("ip6"),b=getProtocol("dns6"),y=getProtocol("ip6zone");for(const[p,l]of this.stringTuples())p===y.code&&(s=`%${l??""}`),DNS_CODES$1.includes(p)&&(r=i.name,o=443,n=`${l??""}${s}`,t=p===b.code?6:4),(p===i.code||p===a.code)&&(r=getProtocol(p).name,o=parseInt(l??"")),(p===d.code||p===h.code)&&(r=getProtocol(p).name,n=`${l??""}${s}`,t=p===h.code?6:4);if(t==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:r,port:o}}protos(){return this.protoCodes().map(t=>Object.assign({},getProtocol(t)))}protoCodes(){const t=[],r=this.bytes;let n=0;for(;n<r.length;){const o=varint$1.decode(r,n),s=varint$1.decode.bytes??0,i=getProtocol(o),a=sizeForAddr$1(i,r.slice(n+s));n+=a+s,t.push(o)}return t}protoNames(){return this.protos().map(t=>t.name)}tuples(){return __classPrivateFieldGet(this,_DefaultMultiaddr_tuples,"f")==null&&__classPrivateFieldSet(this,_DefaultMultiaddr_tuples,bytesToTuples(this.bytes),"f"),__classPrivateFieldGet(this,_DefaultMultiaddr_tuples,"f")}stringTuples(){return __classPrivateFieldGet(this,_DefaultMultiaddr_stringTuples,"f")==null&&__classPrivateFieldSet(this,_DefaultMultiaddr_stringTuples,tuplesToStringTuples(this.tuples()),"f"),__classPrivateFieldGet(this,_DefaultMultiaddr_stringTuples,"f")}encapsulate(t){return t=new DefaultMultiaddr(t),new DefaultMultiaddr(this.toString()+t.toString())}decapsulate(t){const r=t.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new Error(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new DefaultMultiaddr(n.slice(0,o))}decapsulateCode(t){const r=this.tuples();for(let n=r.length-1;n>=0;n--)if(r[n][0]===t)return new DefaultMultiaddr(tuplesToBytes(r.slice(0,n)));return this}getPeerId(){try{const r=this.stringTuples().filter(n=>n[0]===names.ipfs.code).pop();if(r?.[1]!=null){const n=r[1];return n[0]==="Q"||n[0]==="1"?toString$4(base58btc$2.decode(`z${n}`),"base58btc"):toString$4(CID$1.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){let t=null;try{t=this.stringTuples().filter(r=>getProtocol(r[0]).path===!0)[0][1],t==null&&(t=null)}catch{t=null}return t}equals(t){return equals$3(this.bytes,t.bytes)}async resolve(t){const r=this.protos().find(s=>s.resolvable);if(r==null)return[this];const n=resolvers$1.get(r.name);if(n==null)throw errCode(new Error(`no available resolver for ${r.name}`),"ERR_NO_AVAILABLE_RESOLVER");return(await n(this,t)).map(s=>new DefaultMultiaddr(s))}nodeAddress(){const t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(t){const r=(t??this).protos();return!(r.length!==2||r[0].code!==4&&r[0].code!==41||r[1].code!==6&&r[1].code!==273)}[(_DefaultMultiaddr_string=new WeakMap,_DefaultMultiaddr_tuples=new WeakMap,_DefaultMultiaddr_stringTuples=new WeakMap,_a=symbol$2,inspect$2)](){return`Multiaddr(${bytesToString$1(this.bytes)})`}}function multiaddr$1(e){return new DefaultMultiaddr(e)}function equals$2(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function coerce(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function fromString$1(e){return new TextEncoder().encode(e)}function toString$1(e){return new TextDecoder().decode(e)}function base(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=e.length,d=e.charAt(0),h=Math.log(a)/Math.log(256),b=Math.log(256)/Math.log(a);function y(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";for(var w=0,S=0,$=0,v=l.length;$!==v&&l[$]===0;)$++,w++;for(var C=(v-$)*b+1>>>0,A=new Uint8Array(C);$!==v;){for(var x=l[$],_=0,B=C-1;(x!==0||_<S)&&B!==-1;B--,_++)x+=256*A[B]>>>0,A[B]=x%a>>>0,x=x/a>>>0;if(x!==0)throw new Error("Non-zero carry");S=_,$++}for(var I=C-S;I!==C&&A[I]===0;)I++;for(var D=d.repeat(w);I<C;++I)D+=e.charAt(A[I]);return D}function g(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;var w=0;if(l[w]!==" "){for(var S=0,$=0;l[w]===d;)S++,w++;for(var v=(l.length-w)*h+1>>>0,C=new Uint8Array(v);l[w];){var A=r[l.charCodeAt(w)];if(A===255)return;for(var x=0,_=v-1;(A!==0||x<$)&&_!==-1;_--,x++)A+=a*C[_]>>>0,C[_]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");$=x,w++}if(l[w]!==" "){for(var B=v-$;B!==v&&C[B]===0;)B++;for(var I=new Uint8Array(S+(v-B)),D=S;B!==v;)I[D++]=C[B++];return I}}}function p(l){var w=g(l);if(w)return w;throw new Error(`Non-${t} character`)}return{encode:y,decodeUnsafe:g,decode:p}}var src=base,_brrp__multiformats_scope_baseX=src;class Encoder{name;prefix;baseEncode;constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Decoder{name;prefix;baseDecode;prefixCodePoint;constructor(t,r,n){this.name=t,this.prefix=r;const o=r.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return or(this,t)}}class ComposedDecoder{decoders;constructor(t){this.decoders=t}or(t){return or(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}function or(e,t){return new ComposedDecoder({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}class Codec{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new Encoder(t,r,n),this.decoder=new Decoder(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}function from({name:e,prefix:t,encode:r,decode:n}){return new Codec(e,t,r,n)}function baseX({name:e,prefix:t,alphabet:r}){const{encode:n,decode:o}=_brrp__multiformats_scope_baseX(r,e);return from({prefix:t,name:e,encode:n,decode:s=>coerce(o(s))})}function decode$5(e,t,r,n){let o=e.length;for(;e[o-1]==="=";)--o;const s=new Uint8Array(o*r/8|0);let i=0,a=0,d=0;for(let h=0;h<o;++h){const b=t[e[h]];if(b===void 0)throw new SyntaxError(`Non-${n} character`);a=a<<r|b,i+=r,i>=8&&(i-=8,s[d++]=255&a>>i)}if(i>=r||(255&a<<8-i)!==0)throw new SyntaxError("Unexpected end of data");return s}function encode$2(e,t,r){const n=t[t.length-1]==="=",o=(1<<r)-1;let s="",i=0,a=0;for(let d=0;d<e.length;++d)for(a=a<<8|e[d],i+=8;i>r;)i-=r,s+=t[o&a>>i];if(i!==0&&(s+=t[o&a<<r-i]),n)for(;(s.length*r&7)!==0;)s+="=";return s}function createAlphabetIdx(e){const t={};for(let r=0;r<e.length;++r)t[e[r]]=r;return t}function rfc4648({name:e,prefix:t,bitsPerChar:r,alphabet:n}){const o=createAlphabetIdx(n);return from({prefix:t,name:e,encode(s){return encode$2(s,n,r)},decode(s){return decode$5(s,o,r,e)}})}const base10=baseX({prefix:"9",name:"base10",alphabet:"0123456789"}),base10$1=Object.freeze(Object.defineProperty({__proto__:null,base10},Symbol.toStringTag,{value:"Module"})),base16=rfc4648({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper=rfc4648({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),base16$1=Object.freeze(Object.defineProperty({__proto__:null,base16,base16upper},Symbol.toStringTag,{value:"Module"})),base2=rfc4648({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),base2$1=Object.freeze(Object.defineProperty({__proto__:null,base2},Symbol.toStringTag,{value:"Module"})),alphabet=Array.from(""),alphabetBytesToChars=alphabet.reduce((e,t,r)=>(e[r]=t,e),[]),alphabetCharsToBytes=alphabet.reduce((e,t,r)=>{const n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);return e[n]=r,e},[]);function encode$1(e){return e.reduce((t,r)=>(t+=alphabetBytesToChars[r],t),"")}function decode$4(e){const t=[];for(const r of e){const n=r.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${r}`);const o=alphabetCharsToBytes[n];if(o==null)throw new Error(`Non-base256emoji character: ${r}`);t.push(o)}return new Uint8Array(t)}const base256emoji=from({prefix:"",name:"base256emoji",encode:encode$1,decode:decode$4}),base256emoji$1=Object.freeze(Object.defineProperty({__proto__:null,base256emoji},Symbol.toStringTag,{value:"Module"})),base32=rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),base32upper=rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),base32pad=rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),base32padupper=rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),base32hex=rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),base32hexupper=rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),base32hexpad=rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper=rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z=rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),base32$1=Object.freeze(Object.defineProperty({__proto__:null,base32,base32hex,base32hexpad,base32hexpadupper,base32hexupper,base32pad,base32padupper,base32upper,base32z},Symbol.toStringTag,{value:"Module"})),base36=baseX({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper=baseX({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),base36$1=Object.freeze(Object.defineProperty({__proto__:null,base36,base36upper},Symbol.toStringTag,{value:"Module"})),base58btc=baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr=baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),base58=Object.freeze(Object.defineProperty({__proto__:null,base58btc,base58flickr},Symbol.toStringTag,{value:"Module"})),base64$1=rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),base64pad=rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url=rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad=rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),base64$2=Object.freeze(Object.defineProperty({__proto__:null,base64:base64$1,base64pad,base64url,base64urlpad},Symbol.toStringTag,{value:"Module"})),base8=rfc4648({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),base8$1=Object.freeze(Object.defineProperty({__proto__:null,base8},Symbol.toStringTag,{value:"Module"})),identity=from({prefix:"\0",name:"identity",encode:e=>toString$1(e),decode:e=>fromString$1(e)}),identityBase=Object.freeze(Object.defineProperty({__proto__:null,identity},Symbol.toStringTag,{value:"Module"}));new TextEncoder;new TextDecoder;var encode_1=encode,MSB$1=128,MSBALL=-128,INT=Math.pow(2,31);function encode(e,t,r){t=t||[],r=r||0;for(var n=r;e>=INT;)t[r++]=e&255|MSB$1,e/=128;for(;e&MSBALL;)t[r++]=e&255|MSB$1,e>>>=7;return t[r]=e|0,encode.bytes=r-n+1,t}var decode$3=read,MSB$1$1=128,REST$1=127;function read(e,n){var r=0,n=n||0,o=0,s=n,i,a=e.length;do{if(s>=a)throw read.bytes=0,new RangeError("Could not decode varint");i=e[s++],r+=o<28?(i&REST$1)<<o:(i&REST$1)*Math.pow(2,o),o+=7}while(i>=MSB$1$1);return read.bytes=s-n,r}var N1$1=Math.pow(2,7),N2$1=Math.pow(2,14),N3$1=Math.pow(2,21),N4$1=Math.pow(2,28),N5$1=Math.pow(2,35),N6$1=Math.pow(2,42),N7$1=Math.pow(2,49),N8=Math.pow(2,56),N9=Math.pow(2,63),length=function(e){return e<N1$1?1:e<N2$1?2:e<N3$1?3:e<N4$1?4:e<N5$1?5:e<N6$1?6:e<N7$1?7:e<N8?8:e<N9?9:10},varint={encode:encode_1,decode:decode$3,encodingLength:length},_brrp_varint=varint;function decode$2(e,t=0){return[_brrp_varint.decode(e,t),_brrp_varint.decode.bytes]}function encodeTo(e,t,r=0){return _brrp_varint.encode(e,t,r),t}function encodingLength$1(e){return _brrp_varint.encodingLength(e)}function create$1(e,t){const r=t.byteLength,n=encodingLength$1(e),o=n+encodingLength$1(r),s=new Uint8Array(o+r);return encodeTo(e,s,0),encodeTo(r,s,n),s.set(t,o),new Digest(e,r,t,s)}function decode$1(e){const t=coerce(e),[r,n]=decode$2(t),[o,s]=decode$2(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Digest(r,o,i,t)}function equals$1(e,t){if(e===t)return!0;{const r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&equals$2(e.bytes,r.bytes)}}class Digest{code;size;digest;bytes;constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}}function format(e,t){const{bytes:r,version:n}=e;switch(n){case 0:return toStringV0(r,baseCache(e),t??base58btc.encoder);default:return toStringV1(r,baseCache(e),t??base32.encoder)}}const cache=new WeakMap;function baseCache(e){const t=cache.get(e);if(t==null){const r=new Map;return cache.set(e,r),r}return t}class CID{code;version;multihash;bytes;"/";constructor(t,r,n,o){this.code=r,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{const{code:t,multihash:r}=this;if(t!==DAG_PB_CODE)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==SHA_256_CODE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return CID.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{const{code:t,digest:r}=this.multihash,n=create$1(t,r);return CID.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return CID.equals(this,t)}static equals(t,r){const n=r;return n!=null&&t.code===n.code&&t.version===n.version&&equals$1(t.multihash,n.multihash)}toString(t){return format(this,t)}toJSON(){return{"/":format(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;const r=t;if(r instanceof CID)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){const{version:n,code:o,multihash:s,bytes:i}=r;return new CID(n,o,s,i??encodeCID$1(n,o,s.bytes))}else if(r[cidSymbol]===!0){const{version:n,multihash:o,code:s}=r,i=decode$1(o);return CID.create(n,s,i)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==DAG_PB_CODE)throw new Error(`Version 0 CID must use dag-pb (code: ${DAG_PB_CODE}) block encoding`);return new CID(t,r,n,n.bytes)}case 1:{const o=encodeCID$1(t,r,n.bytes);return new CID(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return CID.create(0,DAG_PB_CODE,t)}static createV1(t,r){return CID.create(1,t,r)}static decode(t){const[r,n]=CID.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(t){const r=CID.inspectBytes(t),n=r.size-r.multihashSize,o=coerce(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");const s=o.subarray(r.multihashSize-r.digestSize),i=new Digest(r.multihashCode,r.digestSize,s,o);return[r.version===0?CID.createV0(i):CID.createV1(r.codec,i),t.subarray(r.size)]}static inspectBytes(t){let r=0;const n=()=>{const[y,g]=decode$2(t.subarray(r));return r+=g,y};let o=n(),s=DAG_PB_CODE;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);const i=r,a=n(),d=n(),h=r+d,b=h-i;return{version:o,codec:s,multihashCode:a,digestSize:d,multihashSize:b,size:h}}static parse(t,r){const[n,o]=parseCIDtoBytes(t,r),s=CID.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return baseCache(s).set(n,t),s}}function parseCIDtoBytes(e,t){switch(e[0]){case"Q":{const r=t??base58btc;return[base58btc.prefix,r.decode(`${base58btc.prefix}${e}`)]}case base58btc.prefix:{const r=t??base58btc;return[base58btc.prefix,r.decode(e)]}case base32.prefix:{const r=t??base32;return[base32.prefix,r.decode(e)]}case base36.prefix:{const r=t??base36;return[base36.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}}function toStringV0(e,t,r){const{prefix:n}=r;if(n!==base58btc.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);const o=t.get(n);if(o==null){const s=r.encode(e).slice(1);return t.set(n,s),s}else return o}function toStringV1(e,t,r){const{prefix:n}=r,o=t.get(n);if(o==null){const s=r.encode(e);return t.set(n,s),s}else return o}const DAG_PB_CODE=112,SHA_256_CODE=18;function encodeCID$1(e,t,r){const n=encodingLength$1(e),o=n+encodingLength$1(t),s=new Uint8Array(o+r.byteLength);return encodeTo(e,s,0),encodeTo(t,s,n),s.set(r,o),s}const cidSymbol=Symbol.for("@ipld/js-cid/CID"),bases={...identityBase,...base2$1,...base8$1,...base10$1,...base16$1,...base32$1,...base36$1,...base58,...base64$2,...base256emoji$1};function allocUnsafe(e=0){return new Uint8Array(e)}function createCodec(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const string=createCodec("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),ascii=createCodec("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=allocUnsafe(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),BASES={utf8:string,"utf-8":string,hex:bases.base16,latin1:ascii,ascii,binary:ascii,...bases};function toString(e,t="utf8"){const r=BASES[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}class InvalidMultiaddrError extends Error{static name="InvalidMultiaddrError";name="InvalidMultiaddrError"}class ValidationError extends Error{static name="ValidationError";name="ValidationError"}class InvalidParametersError extends Error{static name="InvalidParametersError";name="InvalidParametersError"}class UnknownProtocolError extends Error{static name="UnknownProtocolError";name="UnknownProtocolError"}function equals(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function fromString(e,t="utf8"){const r=BASES[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}const N1=Math.pow(2,7),N2=Math.pow(2,14),N3=Math.pow(2,21),N4=Math.pow(2,28),N5=Math.pow(2,35),N6=Math.pow(2,42),N7=Math.pow(2,49),MSB=128,REST=127;function encodingLength(e){if(e<N1)return 1;if(e<N2)return 2;if(e<N3)return 3;if(e<N4)return 4;if(e<N5)return 5;if(e<N6)return 6;if(e<N7)return 7;if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function encodeUint8Array(e,t,r=0){switch(encodingLength(e)){case 8:t[r++]=e&255|MSB,e/=128;case 7:t[r++]=e&255|MSB,e/=128;case 6:t[r++]=e&255|MSB,e/=128;case 5:t[r++]=e&255|MSB,e/=128;case 4:t[r++]=e&255|MSB,e>>>=7;case 3:t[r++]=e&255|MSB,e>>>=7;case 2:t[r++]=e&255|MSB,e>>>=7;case 1:{t[r++]=e&255,e>>>=7;break}default:throw new Error("unreachable")}return t}function decodeUint8Array(e,t){let r=e[t],n=0;if(n+=r&REST,r<MSB||(r=e[t+1],n+=(r&REST)<<7,r<MSB)||(r=e[t+2],n+=(r&REST)<<14,r<MSB)||(r=e[t+3],n+=(r&REST)<<21,r<MSB)||(r=e[t+4],n+=(r&REST)*N4,r<MSB)||(r=e[t+5],n+=(r&REST)*N5,r<MSB)||(r=e[t+6],n+=(r&REST)*N6,r<MSB)||(r=e[t+7],n+=(r&REST)*N7,r<MSB))return n;throw new RangeError("Could not decode varint")}function decodeUint8ArrayList(e,t){let r=e.get(t),n=0;if(n+=r&REST,r<MSB||(r=e.get(t+1),n+=(r&REST)<<7,r<MSB)||(r=e.get(t+2),n+=(r&REST)<<14,r<MSB)||(r=e.get(t+3),n+=(r&REST)<<21,r<MSB)||(r=e.get(t+4),n+=(r&REST)*N4,r<MSB)||(r=e.get(t+5),n+=(r&REST)*N5,r<MSB)||(r=e.get(t+6),n+=(r&REST)*N6,r<MSB)||(r=e.get(t+7),n+=(r&REST)*N7,r<MSB))return n;throw new RangeError("Could not decode varint")}function decode(e,t=0){return e instanceof Uint8Array?decodeUint8Array(e,t):decodeUint8ArrayList(e,t)}function asUint8Array(e){return e}function concat(e,t){t==null&&(t=e.reduce((o,s)=>o+s.length,0));const r=allocUnsafe(t);let n=0;for(const o of e)r.set(o,n),n+=o.length;return r}const CODE_IP4=4,CODE_TCP=6,CODE_UDP=273,CODE_DCCP=33,CODE_IP6=41,CODE_IP6ZONE=42,CODE_IPCIDR=43,CODE_DNS=53,CODE_DNS4=54,CODE_DNS6=55,CODE_DNSADDR=56,CODE_SCTP=132,CODE_UDT=301,CODE_UTP=302,CODE_UNIX=400,CODE_P2P=421,CODE_ONION=444,CODE_ONION3=445,CODE_GARLIC64=446,CODE_GARLIC32=447,CODE_TLS=448,CODE_SNI=449,CODE_NOISE=454,CODE_QUIC=460,CODE_QUIC_V1=461,CODE_WEBTRANSPORT=465,CODE_CERTHASH=466,CODE_HTTP=480,CODE_HTTP_PATH=481,CODE_HTTPS=443,CODE_WS=477,CODE_WSS=478,CODE_P2P_WEBSOCKET_STAR=479,CODE_P2P_STARDUST=277,CODE_P2P_WEBRTC_STAR=275,CODE_P2P_WEBRTC_DIRECT=276,CODE_WEBRTC_DIRECT=280,CODE_WEBRTC=281,CODE_P2P_CIRCUIT=290,CODE_MEMORY=777;function bytesToString(e){return t=>toString(t,e)}function stringToBytes(e){return t=>fromString(t,e)}function bytes2port(e){return new DataView(e.buffer).getUint16(e.byteOffset).toString()}function port2bytes(e){const t=new ArrayBuffer(2);return new DataView(t).setUint16(0,typeof e=="string"?parseInt(e):e),new Uint8Array(t)}function onion2bytes(e){const t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==16)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion address.`);const r=fromString(t[0],"base32"),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const o=port2bytes(n);return concat([r,o],r.length+o.length)}function onion32bytes(e){const t=e.split(":");if(t.length!==2)throw new Error(`failed to parse onion addr: ["'${t.join('", "')}'"]' does not contain a port number`);if(t[0].length!==56)throw new Error(`failed to parse onion addr: ${t[0]} not a Tor onion3 address.`);const r=base32.decode(`b${t[0]}`),n=parseInt(t[1],10);if(n<1||n>65536)throw new Error("Port number is not in range(1, 65536)");const o=port2bytes(n);return concat([r,o],r.length+o.length)}function bytes2onion(e){const t=e.subarray(0,e.length-2),r=e.subarray(e.length-2),n=toString(t,"base32"),o=bytes2port(r);return`${n}:${o}`}const ip4ToBytes=function(e){e=e.toString().trim();const t=new Uint8Array(4);return e.split(/\./g).forEach((r,n)=>{const o=parseInt(r,10);if(isNaN(o)||o<0||o>255)throw new InvalidMultiaddrError("Invalid byte value in IP address");t[n]=o}),t},ip6ToBytes=function(e){let t=0;e=e.toString().trim();const r=e.split(":",8);let n;for(n=0;n<r.length;n++){const s=isIPv4(r[n]);let i;s&&(i=ip4ToBytes(r[n]),r[n]=toString(i.subarray(0,2),"base16")),i!=null&&++n<8&&r.splice(n,0,toString(i.subarray(2,4),"base16"))}if(r[0]==="")for(;r.length<8;)r.unshift("0");else if(r[r.length-1]==="")for(;r.length<8;)r.push("0");else if(r.length<8){for(n=0;n<r.length&&r[n]!=="";n++);const s=[n,1];for(n=9-r.length;n>0;n--)s.push("0");r.splice.apply(r,s)}const o=new Uint8Array(t+16);for(n=0;n<r.length;n++){r[n]===""&&(r[n]="0");const s=parseInt(r[n],16);if(isNaN(s)||s<0||s>65535)throw new InvalidMultiaddrError("Invalid byte value in IP address");o[t++]=s>>8&255,o[t++]=s&255}return o},ip4ToString=function(e){if(e.byteLength!==4)throw new InvalidMultiaddrError("IPv4 address was incorrect length");const t=[];for(let r=0;r<e.byteLength;r++)t.push(e[r]);return t.join(".")},ip6ToString=function(e){if(e.byteLength!==16)throw new InvalidMultiaddrError("IPv6 address was incorrect length");const t=[];for(let n=0;n<e.byteLength;n+=2){const o=e[n],s=e[n+1],i=`${o.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}`;t.push(i)}const r=t.join(":");try{const n=new URL(`http://[${r}]`);return n.hostname.substring(1,n.hostname.length-1)}catch{throw new InvalidMultiaddrError(`Invalid IPv6 address "${r}"`)}};function ip6StringToValue(e){try{const t=new URL(`http://[${e}]`);return t.hostname.substring(1,t.hostname.length-1)}catch{throw new InvalidMultiaddrError(`Invalid IPv6 address "${e}"`)}}const decoders=Object.values(bases).map(e=>e.decoder),anybaseDecoder=(function(){let e=decoders[0].or(decoders[1]);return decoders.slice(2).forEach(t=>e=e.or(t)),e})();function mb2bytes(e){return anybaseDecoder.decode(e)}function bytes2mb(e){return t=>e.encoder.encode(t)}function integer(e){if(parseInt(e).toString()!==e)throw new ValidationError("Value must be an integer")}function positive(e){if(e<0)throw new ValidationError("Value must be a positive integer, or zero")}function maxValue(e){return t=>{if(t>e)throw new ValidationError(`Value must be smaller than or equal to ${e}`)}}function validate$1(...e){return t=>{for(const r of e)r(t)}}const validatePort=validate$1(integer,positive,maxValue(65535)),V=-1;class Registry{protocolsByCode=new Map;protocolsByName=new Map;getProtocol(t){let r;if(typeof t=="string"?r=this.protocolsByName.get(t):r=this.protocolsByCode.get(t),r==null)throw new UnknownProtocolError(`Protocol ${t} was unknown`);return r}addProtocol(t){this.protocolsByCode.set(t.code,t),this.protocolsByName.set(t.name,t),t.aliases?.forEach(r=>{this.protocolsByName.set(r,t)})}removeProtocol(t){const r=this.protocolsByCode.get(t);r!=null&&(this.protocolsByCode.delete(r.code),this.protocolsByName.delete(r.name),r.aliases?.forEach(n=>{this.protocolsByName.delete(n)}))}}const registry=new Registry,codecs=[{code:CODE_IP4,name:"ip4",size:32,valueToBytes:ip4ToBytes,bytesToValue:ip4ToString,validate:e=>{if(!isIPv4(e))throw new ValidationError(`Invalid IPv4 address "${e}"`)}},{code:CODE_TCP,name:"tcp",size:16,valueToBytes:port2bytes,bytesToValue:bytes2port,validate:validatePort},{code:CODE_UDP,name:"udp",size:16,valueToBytes:port2bytes,bytesToValue:bytes2port,validate:validatePort},{code:CODE_DCCP,name:"dccp",size:16,valueToBytes:port2bytes,bytesToValue:bytes2port,validate:validatePort},{code:CODE_IP6,name:"ip6",size:128,valueToBytes:ip6ToBytes,bytesToValue:ip6ToString,stringToValue:ip6StringToValue,validate:e=>{if(!isIPv6(e))throw new ValidationError(`Invalid IPv6 address "${e}"`)}},{code:CODE_IP6ZONE,name:"ip6zone",size:V},{code:CODE_IPCIDR,name:"ipcidr",size:8,bytesToValue:bytesToString("base10"),valueToBytes:stringToBytes("base10")},{code:CODE_DNS,name:"dns",size:V,resolvable:!0},{code:CODE_DNS4,name:"dns4",size:V,resolvable:!0},{code:CODE_DNS6,name:"dns6",size:V,resolvable:!0},{code:CODE_DNSADDR,name:"dnsaddr",size:V,resolvable:!0},{code:CODE_SCTP,name:"sctp",size:16,valueToBytes:port2bytes,bytesToValue:bytes2port,validate:validatePort},{code:CODE_UDT,name:"udt"},{code:CODE_UTP,name:"utp"},{code:CODE_UNIX,name:"unix",size:V,path:!0,stringToValue:e=>decodeURIComponent(e),valueToString:e=>encodeURIComponent(e)},{code:CODE_P2P,name:"p2p",aliases:["ipfs"],size:V,bytesToValue:bytesToString("base58btc"),valueToBytes:e=>e.startsWith("Q")||e.startsWith("1")?stringToBytes("base58btc")(e):CID.parse(e).multihash.bytes},{code:CODE_ONION,name:"onion",size:96,bytesToValue:bytes2onion,valueToBytes:onion2bytes},{code:CODE_ONION3,name:"onion3",size:296,bytesToValue:bytes2onion,valueToBytes:onion32bytes},{code:CODE_GARLIC64,name:"garlic64",size:V},{code:CODE_GARLIC32,name:"garlic32",size:V},{code:CODE_TLS,name:"tls"},{code:CODE_SNI,name:"sni",size:V},{code:CODE_NOISE,name:"noise"},{code:CODE_QUIC,name:"quic"},{code:CODE_QUIC_V1,name:"quic-v1"},{code:CODE_WEBTRANSPORT,name:"webtransport"},{code:CODE_CERTHASH,name:"certhash",size:V,bytesToValue:bytes2mb(base64url),valueToBytes:mb2bytes},{code:CODE_HTTP,name:"http"},{code:CODE_HTTP_PATH,name:"http-path",size:V,stringToValue:e=>`/${decodeURIComponent(e)}`,valueToString:e=>encodeURIComponent(e.substring(1))},{code:CODE_HTTPS,name:"https"},{code:CODE_WS,name:"ws"},{code:CODE_WSS,name:"wss"},{code:CODE_P2P_WEBSOCKET_STAR,name:"p2p-websocket-star"},{code:CODE_P2P_STARDUST,name:"p2p-stardust"},{code:CODE_P2P_WEBRTC_STAR,name:"p2p-webrtc-star"},{code:CODE_P2P_WEBRTC_DIRECT,name:"p2p-webrtc-direct"},{code:CODE_WEBRTC_DIRECT,name:"webrtc-direct"},{code:CODE_WEBRTC,name:"webrtc"},{code:CODE_P2P_CIRCUIT,name:"p2p-circuit"},{code:CODE_MEMORY,name:"memory",size:V}];codecs.forEach(e=>{registry.addProtocol(e)});function bytesToComponents(e){const t=[];let r=0;for(;r<e.length;){const n=decode(e,r),o=registry.getProtocol(n),s=encodingLength(n),i=sizeForAddr(o,e,r+s);let a=0;i>0&&o.size===V&&(a=encodingLength(i));const d=s+a+i,h={code:n,name:o.name,bytes:e.subarray(r,r+d)};if(i>0){const b=r+s+a,y=e.subarray(b,b+i);h.value=o.bytesToValue?.(y)??toString(y)}t.push(h),r+=d}return t}function componentsToBytes(e){let t=0;const r=[];for(const n of e){if(n.bytes==null){const o=registry.getProtocol(n.code),s=encodingLength(n.code);let i,a=0,d=0;n.value!=null&&(i=o.valueToBytes?.(n.value)??fromString(n.value),a=i.byteLength,o.size===V&&(d=encodingLength(a)));const h=new Uint8Array(s+d+a);let b=0;encodeUint8Array(n.code,h,b),b+=s,i!=null&&(o.size===V&&(encodeUint8Array(a,h,b),b+=d),h.set(i,b)),n.bytes=h}r.push(n.bytes),t+=n.bytes.byteLength}return concat(r,t)}function stringToComponents(e){if(e.charAt(0)!=="/")throw new InvalidMultiaddrError('String multiaddr must start with "/"');const t=[];let r="protocol",n="",o="";for(let s=1;s<e.length;s++){const i=e.charAt(s);i!=="/"&&(r==="protocol"?o+=e.charAt(s):n+=e.charAt(s));const a=s===e.length-1;if(i==="/"||a){const d=registry.getProtocol(o);if(r==="protocol"){if(d.size==null||d.size===0){t.push({code:d.code,name:d.name}),n="",o="",r="protocol";continue}else if(a)throw new InvalidMultiaddrError(`Component ${o} was missing value`);r="value"}else if(r==="value"){const h={code:d.code,name:d.name};if(d.size!=null&&d.size!==0){if(n==="")throw new InvalidMultiaddrError(`Component ${o} was missing value`);h.value=d.stringToValue?.(n)??n}t.push(h),n="",o="",r="protocol"}}}if(o!==""&&n!=="")throw new InvalidMultiaddrError("Incomplete multiaddr");return t}function componentsToString(e){return`/${e.flatMap(t=>{if(t.value==null)return t.name;const r=registry.getProtocol(t.code);if(r==null)throw new InvalidMultiaddrError(`Unknown protocol code ${t.code}`);return[t.name,r.valueToString?.(t.value)??t.value]}).join("/")}`}function sizeForAddr(e,t,r){return e.size==null||e.size===0?0:e.size>0?e.size/8:decode(t,r)}const inspect$1=Symbol.for("nodejs.util.inspect.custom"),symbol$1=Symbol.for("@multiformats/multiaddr"),DNS_CODES=[CODE_DNS,CODE_DNS4,CODE_DNS6,CODE_DNSADDR];class NoAvailableResolverError extends Error{constructor(t="No available resolver"){super(t),this.name="NoAvailableResolverError"}}function toComponents(e){if(e==null&&(e="/"),isMultiaddr(e))return e.getComponents();if(e instanceof Uint8Array)return bytesToComponents(e);if(typeof e=="string")return e=e.replace(/\/(\/)+/,"/").replace(/(\/)+$/,""),e===""&&(e="/"),stringToComponents(e);if(Array.isArray(e))return e;throw new InvalidMultiaddrError("Must be a string, Uint8Array, Component[], or another Multiaddr")}class Multiaddr{[symbol$1]=!0;#e;#t;#r;constructor(t="/",r={}){this.#e=toComponents(t),r.validate!==!1&&validate(this)}get bytes(){return this.#r==null&&(this.#r=componentsToBytes(this.#e)),this.#r}toString(){return this.#t==null&&(this.#t=componentsToString(this.#e)),this.#t}toJSON(){return this.toString()}toOptions(){let t,r,n,o,s="";for(const{code:a,name:d,value:h}of this.#e)a===CODE_IP6ZONE&&(s=`%${h??""}`),DNS_CODES.includes(a)&&(r="tcp",o=443,n=`${h??""}${s}`,t=a===CODE_DNS6?6:4),(a===CODE_TCP||a===CODE_UDP)&&(r=d==="tcp"?"tcp":"udp",o=parseInt(h??"")),(a===CODE_IP4||a===CODE_IP6)&&(r="tcp",n=`${h??""}${s}`,t=a===CODE_IP6?6:4);if(t==null||r==null||n==null||o==null)throw new Error('multiaddr must have a valid format: "/{ip4, ip6, dns4, dns6, dnsaddr}/{address}/{tcp, udp}/{port}".');return{family:t,host:n,transport:r,port:o}}getComponents(){return[...this.#e]}protos(){return this.#e.map(({code:t,value:r})=>{const n=registry.getProtocol(t);return{code:t,size:n.size??0,name:n.name,resolvable:!!n.resolvable,path:!!n.path}})}protoCodes(){return this.#e.map(({code:t})=>t)}protoNames(){return this.#e.map(({name:t})=>t)}tuples(){return this.#e.map(({code:t,value:r})=>{if(r==null)return[t];const n=registry.getProtocol(t),o=[t];return r!=null&&o.push(n.valueToBytes?.(r)??fromString(r)),o})}stringTuples(){return this.#e.map(({code:t,value:r})=>r==null?[t]:[t,r])}encapsulate(t){const r=new Multiaddr(t);return new Multiaddr([...this.#e,...r.getComponents()],{validate:!1})}decapsulate(t){const r=t.toString(),n=this.toString(),o=n.lastIndexOf(r);if(o<0)throw new InvalidParametersError(`Address ${this.toString()} does not contain subaddress: ${t.toString()}`);return new Multiaddr(n.slice(0,o),{validate:!1})}decapsulateCode(t){let r;for(let n=this.#e.length-1;n>-1;n--)if(this.#e[n].code===t){r=n;break}return new Multiaddr(this.#e.slice(0,r),{validate:!1})}getPeerId(){try{let t=[];this.#e.forEach(({code:n,value:o})=>{n===CODE_P2P&&t.push([n,o]),n===CODE_P2P_CIRCUIT&&(t=[])});const r=t.pop();if(r?.[1]!=null){const n=r[1];return n[0]==="Q"||n[0]==="1"?toString(base58btc.decode(`z${n}`),"base58btc"):toString(CID.parse(n).multihash.bytes,"base58btc")}return null}catch{return null}}getPath(){for(const t of this.#e)if(registry.getProtocol(t.code).path)return t.value??null;return null}equals(t){return equals(this.bytes,t.bytes)}async resolve(t){const r=this.protos().find(s=>s.resolvable);if(r==null)return[this];const n=resolvers.get(r.name);if(n==null)throw new NoAvailableResolverError(`no available resolver for ${r.name}`);return(await n(this,t)).map(s=>multiaddr(s))}nodeAddress(){const t=this.toOptions();if(t.transport!=="tcp"&&t.transport!=="udp")throw new Error(`multiaddr must have a valid format - no protocol with name: "${t.transport}". Must have a valid transport protocol: "{tcp, udp}"`);return{family:t.family,address:t.host,port:t.port}}isThinWaistAddress(){return!(this.#e.length!==2||this.#e[0].code!==CODE_IP4&&this.#e[0].code!==CODE_IP6||this.#e[1].code!==CODE_TCP&&this.#e[1].code!==CODE_UDP)}[inspect$1](){return`Multiaddr(${this.toString()})`}}function validate(e){e.getComponents().forEach(t=>{const r=registry.getProtocol(t.code);t.value!=null&&r.validate?.(t.value)})}const resolvers=new Map;function isMultiaddr(e){return!!e?.[symbol$1]}function multiaddr(e){return new Multiaddr(e)}function protocols(e){const t=registry.getProtocol(e);return{code:t.code,size:t.size??0,name:t.name,resolvable:!!t.resolvable,path:!!t.path}}function extractSNI(e){let t;try{t=protocols("sni").code}catch{return null}for(const[r,n]of e)if(r===t&&n!==void 0)return n;return null}function hasTLS(e){return e.some(([t,r])=>t===protocols("tls").code)}function interpretNext(e,t,r){const n=interpreters[protocols(e).name];if(n===void 0)throw new Error(`Can't interpret protocol ${protocols(e).name}`);const o=n(t,r);return e===protocols("ip6").code?`[${o}]`:o}const interpreters={ip4:(e,t)=>e,ip6:(e,t)=>t.length===0?e:`[${e}]`,tcp:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`tcp://${interpretNext(r[0],r[1]??"",t)}:${e}`},udp:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`udp://${interpretNext(r[0],r[1]??"",t)}:${e}`},dnsaddr:(e,t)=>e,dns4:(e,t)=>e,dns6:(e,t)=>e,dns:(e,t)=>e,ipfs:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(r[0],r[1]??"",t)}/ipfs/${e}`},p2p:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(r[0],r[1]??"",t)}/p2p/${e}`},http:(e,t)=>{const r=hasTLS(t),n=extractSNI(t);if(r&&n!==null)return`https://${n}`;const o=r?"https://":"http://",s=t.pop();if(s===void 0)throw new Error("Unexpected end of multiaddr");let i=interpretNext(s[0],s[1]??"",t);return i=i.replace("tcp://",""),`${o}${i}`},tls:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return interpretNext(r[0],r[1]??"",t)},sni:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return interpretNext(r[0],r[1]??"",t)},https:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");let n=interpretNext(r[0],r[1]??"",t);return n=n.replace("tcp://",""),`https://${n}`},ws:(e,t)=>{const r=hasTLS(t),n=extractSNI(t);if(r&&n!==null)return`wss://${n}`;const o=r?"wss://":"ws://",s=t.pop();if(s===void 0)throw new Error("Unexpected end of multiaddr");let i=interpretNext(s[0],s[1]??"",t);return i=i.replace("tcp://",""),`${o}${i}`},wss:(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");let n=interpretNext(r[0],r[1]??"",t);return n=n.replace("tcp://",""),`wss://${n}`},"p2p-websocket-star":(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(r[0],r[1]??"",t)}/p2p-websocket-star`},"p2p-webrtc-star":(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(r[0],r[1]??"",t)}/p2p-webrtc-star`},"p2p-webrtc-direct":(e,t)=>{const r=t.pop();if(r===void 0)throw new Error("Unexpected end of multiaddr");return`${interpretNext(r[0],r[1]??"",t)}/p2p-webrtc-direct`}};function multiaddrToUri(e,t){const n=multiaddr(e).stringTuples(),o=n.pop();if(o===void 0)throw new Error("Unexpected end of multiaddr");const s=protocols(o[0]),i=interpreters[s.name];if(i==null)throw new Error(`No interpreter found for ${s.name}`);let a=i(o[1]??"",n);return o[0]===protocols("tcp").code&&(a=a.replace("tcp://","http://"),(o[1]==="443"||o[1]==="80")&&(o[1]==="443"&&(a=a.replace("http://","https://")),a=a.substring(0,a.lastIndexOf(":")))),a}function toUrlString(e){try{e=multiaddrToUri(multiaddr$1(e))}catch{}return e=e.toString(),e}const getAgent=()=>{},log$1=logger("ipfs-http-client:lib:error-handler"),merge=mergeOptions.bind({ignoreUndefined:!0}),DEFAULT_PROTOCOL=envExports.isBrowser||envExports.isWebWorker?location.protocol:"http",DEFAULT_HOST=envExports.isBrowser||envExports.isWebWorker?location.hostname:"localhost",DEFAULT_PORT=envExports.isBrowser||envExports.isWebWorker?location.port:"5001",normalizeOptions=(e={})=>{let t,r={},n;if(typeof e=="string"||isMultiaddr$2(e))t=new URL(toUrlString(e));else if(e instanceof URL)t=e;else if(typeof e.url=="string"||isMultiaddr$2(e.url))t=new URL(toUrlString(e.url)),r=e;else if(e.url instanceof URL)t=e.url,r=e;else{r=e||{};const o=(r.protocol||DEFAULT_PROTOCOL).replace(":",""),s=(r.host||DEFAULT_HOST).split(":")[0],i=r.port||DEFAULT_PORT;t=new URL(`${o}://${s}:${i}`)}if(r.apiPath?t.pathname=r.apiPath:(t.pathname==="/"||t.pathname===void 0)&&(t.pathname="api/v0"),envExports.isNode){const o=getAgent();n=r.agent||new o({keepAlive:!0,maxSockets:6})}return{...r,host:t.host,protocol:t.protocol.replace(":",""),port:Number(t.port),apiPath:t.pathname,url:t,agent:n}},errorHandler=async e=>{let t;try{if((e.headers.get("Content-Type")||"").startsWith("application/json")){const n=await e.json();log$1(n),t=n.Message||n.message}else t=await e.text()}catch(n){log$1("Failed to parse error response",n),t=n.message}let r=new HTTP.HTTPError(e);throw t&&(t.includes("deadline has elapsed")&&(r=new HTTP.TimeoutError),t&&t.includes("context deadline exceeded")&&(r=new HTTP.TimeoutError)),t&&t.includes("request timed out")&&(r=new HTTP.TimeoutError),t&&(r.message=t),r},KEBAB_REGEX=/[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,kebabCase=e=>e.replace(KEBAB_REGEX,function(t){return"-"+t.toLowerCase()}),parseTimeout=e=>typeof e=="string"?parse(e):e;class Client extends HTTP{constructor(t={}){const r=normalizeOptions(t);super({timeout:parseTimeout(r.timeout||0)||void 0,headers:r.headers,base:`${r.url}`,handleError:errorHandler,transformSearchParams:o=>{const s=new URLSearchParams;for(const[i,a]of o)a!=="undefined"&&a!=="null"&&i!=="signal"&&s.append(kebabCase(i),a),i==="timeout"&&!isNaN(a)&&s.append(kebabCase(i),a);return s},agent:r.agent}),delete this.get,delete this.put,delete this.delete,delete this.options;const n=this.fetch;this.fetch=(o,s={})=>(typeof o=="string"&&!o.startsWith("/")&&(o=`${r.url}/${o}`),n.call(this,o,merge(s,{method:"POST"})))}}HTTP.HTTPError;const configure=e=>t=>e(new Client(t),t);function modeToString$1(e){if(e!=null)return typeof e=="string"?e:e.toString(8).padStart(4,"0")}function parseMtime$1(e){if(e==null)return;let t;if(e.secs!=null&&(t={secs:e.secs,nsecs:e.nsecs}),e.Seconds!=null&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:(r-n*1e3)*1e3}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(t!=null&&t.nsecs!=null&&(t.nsecs<0||t.nsecs>999999999))throw errCode(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}function toUrlSearchParams({arg:e,searchParams:t,hashAlg:r,mtime:n,mode:o,...s}={}){t&&(s={...s,...t}),r&&(s.hash=r),n!=null&&(n=parseMtime$1(n),s.mtime=n.secs,s.mtimeNsecs=n.nsecs),o!=null&&(s.mode=modeToString$1(o)),s.timeout&&!isNaN(s.timeout)&&(s.timeout=`${s.timeout}ms`),e==null?e=[]:Array.isArray(e)||(e=[e]);const i=new URLSearchParams(s);return e.forEach(a=>i.append("arg",a)),i}const createWantlist=configure(e=>{async function t(r={}){return((await(await e.post("bitswap/wantlist",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()).Keys||[]).map(o=>CID$1.parse(o["/"]))}return t}),createWantlistForPeer=configure(e=>{async function t(r,n={}){return((await(await e.post("bitswap/wantlist",{signal:n.signal,searchParams:toUrlSearchParams({...n,peer:r.toString()}),headers:n.headers})).json()).Keys||[]).map(s=>CID$1.parse(s["/"]))}return t}),symbol=Symbol.for("@libp2p/peer-id"),inspect=Symbol.for("nodejs.util.inspect.custom"),baseDecoder=Object.values(bases$2).map(e=>e.decoder).reduce((e,t)=>e.or(t),bases$2.identity.decoder),LIBP2P_KEY_CODE=114,MARSHALLED_ED225519_PUBLIC_KEY_LENGTH=36,MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH=37;class PeerIdImpl{type;multihash;privateKey;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[symbol]=!0;toString(){return this.string==null&&(this.string=base58btc$2.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return CID$1.createV1(LIBP2P_KEY_CODE,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){if(t instanceof Uint8Array)return equals$3(this.multihash.bytes,t);if(typeof t=="string")return peerIdFromString(t).equals(this);if(t?.multihash?.bytes!=null)return equals$3(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}[inspect](){return`PeerId(${this.toString()})`}}class RSAPeerIdImpl extends PeerIdImpl{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}}class Ed25519PeerIdImpl extends PeerIdImpl{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.multihash.digest}}class Secp256k1PeerIdImpl extends PeerIdImpl{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.multihash.digest}}function peerIdFromString(e,t){if(e.charAt(0)==="1"||e.charAt(0)==="Q"){const r=decode$f(base58btc$2.decode(`z${e}`));return e.startsWith("12D")?new Ed25519PeerIdImpl({multihash:r}):e.startsWith("16U")?new Secp256k1PeerIdImpl({multihash:r}):new RSAPeerIdImpl({multihash:r})}return peerIdFromBytes(baseDecoder.decode(e))}function peerIdFromBytes(e){try{const t=decode$f(e);if(t.code===identity$3.code){if(t.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH)return new Ed25519PeerIdImpl({multihash:t});if(t.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH)return new Secp256k1PeerIdImpl({multihash:t})}if(t.code===sha256.code)return new RSAPeerIdImpl({multihash:t})}catch{return peerIdFromCID(CID$1.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function peerIdFromCID(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==LIBP2P_KEY_CODE)throw new Error("Supplied PeerID CID is invalid");const t=e.multihash;if(t.code===sha256.code)return new RSAPeerIdImpl({multihash:e.multihash});if(t.code===identity$3.code){if(t.digest.length===MARSHALLED_ED225519_PUBLIC_KEY_LENGTH)return new Ed25519PeerIdImpl({multihash:e.multihash});if(t.digest.length===MARSHALLED_SECP256K1_PUBLIC_KEY_LENGTH)return new Secp256k1PeerIdImpl({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}const createStat$4=configure(e=>{async function t(r={}){const n=await e.post("bitswap/stat",{searchParams:toUrlSearchParams(r),signal:r.signal,headers:r.headers});return toCoreInterface$4(await n.json())}return t});function toCoreInterface$4(e){return{provideBufLen:e.ProvideBufLen,wantlist:(e.Wantlist||[]).map(t=>CID$1.parse(t["/"])),peers:(e.Peers||[]).map(t=>peerIdFromString(t)),blocksReceived:BigInt(e.BlocksReceived),dataReceived:BigInt(e.DataReceived),blocksSent:BigInt(e.BlocksSent),dataSent:BigInt(e.DataSent),dupBlksReceived:BigInt(e.DupBlksReceived),dupDataReceived:BigInt(e.DupDataReceived)}}const createUnwant=configure(e=>{async function t(r,n={}){return(await e.post("bitswap/unwant",{signal:n.signal,searchParams:toUrlSearchParams({arg:r.toString(),...n}),headers:n.headers})).json()}return t});function createBitswap(e){return{wantlist:createWantlist(e),wantlistForPeer:createWantlistForPeer(e),unwant:createUnwant(e),stat:createStat$4(e)}}const createGet$5=configure(e=>{async function t(r,n={}){const o=await e.post("block/get",{signal:n.signal,searchParams:toUrlSearchParams({arg:r.toString(),...n}),headers:n.headers});return new Uint8Array(await o.arrayBuffer())}return t});function peekableIterator(e){const[t,r]=e[Symbol.asyncIterator]!=null?[e[Symbol.asyncIterator](),Symbol.asyncIterator]:[e[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>t.next(),push:o=>{n.push(o)},next:()=>n.length>0?{done:!1,value:n.shift()}:t.next(),[r](){return this}}}async function*browserReadableStreamToIt(e,t={}){const r=e.getReader();try{for(;;){const n=await r.read();if(n.done)return;yield n.value}}finally{t.preventCancel!==!0&&await r.cancel(),r.releaseLock()}}async function all(e){const t=[];for await(const r of e)t.push(r);return t}function isBytes(e){return ArrayBuffer.isView(e)||e instanceof ArrayBuffer}function isBlob(e){return e.constructor&&(e.constructor.name==="Blob"||e.constructor.name==="File")&&typeof e.stream=="function"}function isFileObject(e){return typeof e=="object"&&(e.path||e.content)}const isReadableStream=e=>e&&typeof e.getReader=="function";async function normaliseContent$1(e){if(isBytes(e))return new Blob([e]);if(typeof e=="string"||e instanceof String)return new Blob([e.toString()]);if(isBlob(e))return e;if(isReadableStream(e)&&(e=browserReadableStreamToIt(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=peekableIterator(e),{value:r,done:n}=await t.peek();if(n)return itToBlob(t);if(t.push(r),Number.isInteger(r))return new Blob([Uint8Array.from(await all(t))]);if(isBytes(r)||typeof r=="string"||r instanceof String)return itToBlob(t)}throw errCode(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}async function itToBlob(e){const t=[];for await(const r of e)t.push(r);return new Blob(t)}async function*map(e,t){for await(const r of e)yield t(r)}var indexMinimal={},minimal$1={},aspromise,hasRequiredAspromise;function requireAspromise(){if(hasRequiredAspromise)return aspromise;hasRequiredAspromise=1,aspromise=e;function e(t,r){for(var n=new Array(arguments.length-1),o=0,s=2,i=!0;s<arguments.length;)n[o++]=arguments[s++];return new Promise(function(d,h){n[o]=function(y){if(i)if(i=!1,y)h(y);else{for(var g=new Array(arguments.length-1),p=0;p<g.length;)g[p++]=arguments[p];d.apply(null,g)}};try{t.apply(r||null,n)}catch(b){i&&(i=!1,h(b))}})}return aspromise}var base64={},hasRequiredBase64;function requireBase64(){return hasRequiredBase64||(hasRequiredBase64=1,(function(e){var t=e;t.length=function(a){var d=a.length;if(!d)return 0;for(var h=0;--d%4>1&&a.charAt(d)==="=";)++h;return Math.ceil(a.length*3)/4-h};for(var r=new Array(64),n=new Array(123),o=0;o<64;)n[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;t.encode=function(a,d,h){for(var b=null,y=[],g=0,p=0,l;d<h;){var w=a[d++];switch(p){case 0:y[g++]=r[w>>2],l=(w&3)<<4,p=1;break;case 1:y[g++]=r[l|w>>4],l=(w&15)<<2,p=2;break;case 2:y[g++]=r[l|w>>6],y[g++]=r[w&63],p=0;break}g>8191&&((b||(b=[])).push(String.fromCharCode.apply(String,y)),g=0)}return p&&(y[g++]=r[l],y[g++]=61,p===1&&(y[g++]=61)),b?(g&&b.push(String.fromCharCode.apply(String,y.slice(0,g))),b.join("")):String.fromCharCode.apply(String,y.slice(0,g))};var s="invalid encoding";t.decode=function(a,d,h){for(var b=h,y=0,g,p=0;p<a.length;){var l=a.charCodeAt(p++);if(l===61&&y>1)break;if((l=n[l])===void 0)throw Error(s);switch(y){case 0:g=l,y=1;break;case 1:d[h++]=g<<2|(l&48)>>4,g=l,y=2;break;case 2:d[h++]=(g&15)<<4|(l&60)>>2,g=l,y=3;break;case 3:d[h++]=(g&3)<<6|l,y=0;break}}if(y===1)throw Error(s);return h-b},t.test=function(a){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(a)}})(base64)),base64}var eventemitter,hasRequiredEventemitter;function requireEventemitter(){if(hasRequiredEventemitter)return eventemitter;hasRequiredEventemitter=1,eventemitter=e;function e(){this._listeners={}}return e.prototype.on=function(r,n,o){return(this._listeners[r]||(this._listeners[r]=[])).push({fn:n,ctx:o||this}),this},e.prototype.off=function(r,n){if(r===void 0)this._listeners={};else if(n===void 0)this._listeners[r]=[];else for(var o=this._listeners[r],s=0;s<o.length;)o[s].fn===n?o.splice(s,1):++s;return this},e.prototype.emit=function(r){var n=this._listeners[r];if(n){for(var o=[],s=1;s<arguments.length;)o.push(arguments[s++]);for(s=0;s<n.length;)n[s].fn.apply(n[s++].ctx,o)}return this},eventemitter}var float,hasRequiredFloat;function requireFloat(){if(hasRequiredFloat)return float;hasRequiredFloat=1,float=e(e);function e(s){return typeof Float32Array<"u"?(function(){var i=new Float32Array([-0]),a=new Uint8Array(i.buffer),d=a[3]===128;function h(p,l,w){i[0]=p,l[w]=a[0],l[w+1]=a[1],l[w+2]=a[2],l[w+3]=a[3]}function b(p,l,w){i[0]=p,l[w]=a[3],l[w+1]=a[2],l[w+2]=a[1],l[w+3]=a[0]}s.writeFloatLE=d?h:b,s.writeFloatBE=d?b:h;function y(p,l){return a[0]=p[l],a[1]=p[l+1],a[2]=p[l+2],a[3]=p[l+3],i[0]}function g(p,l){return a[3]=p[l],a[2]=p[l+1],a[1]=p[l+2],a[0]=p[l+3],i[0]}s.readFloatLE=d?y:g,s.readFloatBE=d?g:y})():(function(){function i(d,h,b,y){var g=h<0?1:0;if(g&&(h=-h),h===0)d(1/h>0?0:2147483648,b,y);else if(isNaN(h))d(2143289344,b,y);else if(h>34028234663852886e22)d((g<<31|2139095040)>>>0,b,y);else if(h<11754943508222875e-54)d((g<<31|Math.round(h/1401298464324817e-60))>>>0,b,y);else{var p=Math.floor(Math.log(h)/Math.LN2),l=Math.round(h*Math.pow(2,-p)*8388608)&8388607;d((g<<31|p+127<<23|l)>>>0,b,y)}}s.writeFloatLE=i.bind(null,t),s.writeFloatBE=i.bind(null,r);function a(d,h,b){var y=d(h,b),g=(y>>31)*2+1,p=y>>>23&255,l=y&8388607;return p===255?l?NaN:g*(1/0):p===0?g*1401298464324817e-60*l:g*Math.pow(2,p-150)*(l+8388608)}s.readFloatLE=a.bind(null,n),s.readFloatBE=a.bind(null,o)})(),typeof Float64Array<"u"?(function(){var i=new Float64Array([-0]),a=new Uint8Array(i.buffer),d=a[7]===128;function h(p,l,w){i[0]=p,l[w]=a[0],l[w+1]=a[1],l[w+2]=a[2],l[w+3]=a[3],l[w+4]=a[4],l[w+5]=a[5],l[w+6]=a[6],l[w+7]=a[7]}function b(p,l,w){i[0]=p,l[w]=a[7],l[w+1]=a[6],l[w+2]=a[5],l[w+3]=a[4],l[w+4]=a[3],l[w+5]=a[2],l[w+6]=a[1],l[w+7]=a[0]}s.writeDoubleLE=d?h:b,s.writeDoubleBE=d?b:h;function y(p,l){return a[0]=p[l],a[1]=p[l+1],a[2]=p[l+2],a[3]=p[l+3],a[4]=p[l+4],a[5]=p[l+5],a[6]=p[l+6],a[7]=p[l+7],i[0]}function g(p,l){return a[7]=p[l],a[6]=p[l+1],a[5]=p[l+2],a[4]=p[l+3],a[3]=p[l+4],a[2]=p[l+5],a[1]=p[l+6],a[0]=p[l+7],i[0]}s.readDoubleLE=d?y:g,s.readDoubleBE=d?g:y})():(function(){function i(d,h,b,y,g,p){var l=y<0?1:0;if(l&&(y=-y),y===0)d(0,g,p+h),d(1/y>0?0:2147483648,g,p+b);else if(isNaN(y))d(0,g,p+h),d(2146959360,g,p+b);else if(y>17976931348623157e292)d(0,g,p+h),d((l<<31|2146435072)>>>0,g,p+b);else{var w;if(y<22250738585072014e-324)w=y/5e-324,d(w>>>0,g,p+h),d((l<<31|w/4294967296)>>>0,g,p+b);else{var S=Math.floor(Math.log(y)/Math.LN2);S===1024&&(S=1023),w=y*Math.pow(2,-S),d(w*4503599627370496>>>0,g,p+h),d((l<<31|S+1023<<20|w*1048576&1048575)>>>0,g,p+b)}}}s.writeDoubleLE=i.bind(null,t,0,4),s.writeDoubleBE=i.bind(null,r,4,0);function a(d,h,b,y,g){var p=d(y,g+h),l=d(y,g+b),w=(l>>31)*2+1,S=l>>>20&2047,$=4294967296*(l&1048575)+p;return S===2047?$?NaN:w*(1/0):S===0?w*5e-324*$:w*Math.pow(2,S-1075)*($+4503599627370496)}s.readDoubleLE=a.bind(null,n,0,4),s.readDoubleBE=a.bind(null,o,4,0)})(),s}function t(s,i,a){i[a]=s&255,i[a+1]=s>>>8&255,i[a+2]=s>>>16&255,i[a+3]=s>>>24}function r(s,i,a){i[a]=s>>>24,i[a+1]=s>>>16&255,i[a+2]=s>>>8&255,i[a+3]=s&255}function n(s,i){return(s[i]|s[i+1]<<8|s[i+2]<<16|s[i+3]<<24)>>>0}function o(s,i){return(s[i]<<24|s[i+1]<<16|s[i+2]<<8|s[i+3])>>>0}return float}var inquire_1,hasRequiredInquire;function requireInquire(){if(hasRequiredInquire)return inquire_1;hasRequiredInquire=1,inquire_1=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}return inquire_1}var utf8={},hasRequiredUtf8;function requireUtf8(){return hasRequiredUtf8||(hasRequiredUtf8=1,(function(e){var t=e;t.length=function(n){for(var o=0,s=0,i=0;i<n.length;++i)s=n.charCodeAt(i),s<128?o+=1:s<2048?o+=2:(s&64512)===55296&&(n.charCodeAt(i+1)&64512)===56320?(++i,o+=4):o+=3;return o},t.read=function(n,o,s){var i=s-o;if(i<1)return"";for(var a=null,d=[],h=0,b;o<s;)b=n[o++],b<128?d[h++]=b:b>191&&b<224?d[h++]=(b&31)<<6|n[o++]&63:b>239&&b<365?(b=((b&7)<<18|(n[o++]&63)<<12|(n[o++]&63)<<6|n[o++]&63)-65536,d[h++]=55296+(b>>10),d[h++]=56320+(b&1023)):d[h++]=(b&15)<<12|(n[o++]&63)<<6|n[o++]&63,h>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,d)),h=0);return a?(h&&a.push(String.fromCharCode.apply(String,d.slice(0,h))),a.join("")):String.fromCharCode.apply(String,d.slice(0,h))},t.write=function(n,o,s){for(var i=s,a,d,h=0;h<n.length;++h)a=n.charCodeAt(h),a<128?o[s++]=a:a<2048?(o[s++]=a>>6|192,o[s++]=a&63|128):(a&64512)===55296&&((d=n.charCodeAt(h+1))&64512)===56320?(a=65536+((a&1023)<<10)+(d&1023),++h,o[s++]=a>>18|240,o[s++]=a>>12&63|128,o[s++]=a>>6&63|128,o[s++]=a&63|128):(o[s++]=a>>12|224,o[s++]=a>>6&63|128,o[s++]=a&63|128);return s-i}})(utf8)),utf8}var pool_1,hasRequiredPool;function requirePool(){if(hasRequiredPool)return pool_1;hasRequiredPool=1,pool_1=e;function e(t,r,n){var o=n||8192,s=o>>>1,i=null,a=o;return function(h){if(h<1||h>s)return t(h);a+h>o&&(i=t(o),a=0);var b=r.call(i,a,a+=h);return a&7&&(a=(a|7)+1),b}}return pool_1}var longbits,hasRequiredLongbits;function requireLongbits(){if(hasRequiredLongbits)return longbits;hasRequiredLongbits=1,longbits=t;var e=requireMinimal$1();function t(s,i){this.lo=s>>>0,this.hi=i>>>0}var r=t.zero=new t(0,0);r.toNumber=function(){return 0},r.zzEncode=r.zzDecode=function(){return this},r.length=function(){return 1};var n=t.zeroHash="\0\0\0\0\0\0\0\0";t.fromNumber=function(i){if(i===0)return r;var a=i<0;a&&(i=-i);var d=i>>>0,h=(i-d)/4294967296>>>0;return a&&(h=~h>>>0,d=~d>>>0,++d>4294967295&&(d=0,++h>4294967295&&(h=0))),new t(d,h)},t.from=function(i){if(typeof i=="number")return t.fromNumber(i);if(e.isString(i))if(e.Long)i=e.Long.fromString(i);else return t.fromNumber(parseInt(i,10));return i.low||i.high?new t(i.low>>>0,i.high>>>0):r},t.prototype.toNumber=function(i){if(!i&&this.hi>>>31){var a=~this.lo+1>>>0,d=~this.hi>>>0;return a||(d=d+1>>>0),-(a+d*4294967296)}return this.lo+this.hi*4294967296},t.prototype.toLong=function(i){return e.Long?new e.Long(this.lo|0,this.hi|0,!!i):{low:this.lo|0,high:this.hi|0,unsigned:!!i}};var o=String.prototype.charCodeAt;return t.fromHash=function(i){return i===n?r:new t((o.call(i,0)|o.call(i,1)<<8|o.call(i,2)<<16|o.call(i,3)<<24)>>>0,(o.call(i,4)|o.call(i,5)<<8|o.call(i,6)<<16|o.call(i,7)<<24)>>>0)},t.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},t.prototype.zzEncode=function(){var i=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^i)>>>0,this.lo=(this.lo<<1^i)>>>0,this},t.prototype.zzDecode=function(){var i=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^i)>>>0,this.hi=(this.hi>>>1^i)>>>0,this},t.prototype.length=function(){var i=this.lo,a=(this.lo>>>28|this.hi<<4)>>>0,d=this.hi>>>24;return d===0?a===0?i<16384?i<128?1:2:i<2097152?3:4:a<16384?a<128?5:6:a<2097152?7:8:d<128?9:10},longbits}var hasRequiredMinimal$1;function requireMinimal$1(){return hasRequiredMinimal$1||(hasRequiredMinimal$1=1,(function(e){var t=e;t.asPromise=requireAspromise(),t.base64=requireBase64(),t.EventEmitter=requireEventemitter(),t.float=requireFloat(),t.inquire=requireInquire(),t.utf8=requireUtf8(),t.pool=requirePool(),t.LongBits=requireLongbits(),t.isNode=!!(typeof commonjsGlobal<"u"&&commonjsGlobal&&commonjsGlobal.process&&commonjsGlobal.process.versions&&commonjsGlobal.process.versions.node),t.global=t.isNode&&commonjsGlobal||typeof window<"u"&&window||typeof self<"u"&&self||minimal$1,t.emptyArray=Object.freeze?Object.freeze([]):[],t.emptyObject=Object.freeze?Object.freeze({}):{},t.isInteger=Number.isInteger||function(s){return typeof s=="number"&&isFinite(s)&&Math.floor(s)===s},t.isString=function(s){return typeof s=="string"||s instanceof String},t.isObject=function(s){return s&&typeof s=="object"},t.isset=t.isSet=function(s,i){var a=s[i];return a!=null&&s.hasOwnProperty(i)?typeof a!="object"||(Array.isArray(a)?a.length:Object.keys(a).length)>0:!1},t.Buffer=(function(){try{var o=t.inquire("buffer").Buffer;return o.prototype.utf8Write?o:null}catch{return null}})(),t._Buffer_from=null,t._Buffer_allocUnsafe=null,t.newBuffer=function(s){return typeof s=="number"?t.Buffer?t._Buffer_allocUnsafe(s):new t.Array(s):t.Buffer?t._Buffer_from(s):typeof Uint8Array>"u"?s:new Uint8Array(s)},t.Array=typeof Uint8Array<"u"?Uint8Array:Array,t.Long=t.global.dcodeIO&&t.global.dcodeIO.Long||t.global.Long||t.inquire("long"),t.key2Re=/^true|false|0|1$/,t.key32Re=/^-?(?:0|[1-9][0-9]*)$/,t.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,t.longToHash=function(s){return s?t.LongBits.from(s).toHash():t.LongBits.zeroHash},t.longFromHash=function(s,i){var a=t.LongBits.fromHash(s);return t.Long?t.Long.fromBits(a.lo,a.hi,i):a.toNumber(!!i)};function r(o,s,i){for(var a=Object.keys(s),d=0;d<a.length;++d)(o[a[d]]===void 0||!i)&&(o[a[d]]=s[a[d]]);return o}t.merge=r,t.lcFirst=function(s){return s.charAt(0).toLowerCase()+s.substring(1)};function n(o){function s(i,a){if(!(this instanceof s))return new s(i,a);Object.defineProperty(this,"message",{get:function(){return i}}),Error.captureStackTrace?Error.captureStackTrace(this,s):Object.defineProperty(this,"stack",{value:new Error().stack||""}),a&&r(this,a)}return s.prototype=Object.create(Error.prototype,{constructor:{value:s,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return o},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),s}t.newError=n,t.ProtocolError=n("ProtocolError"),t.oneOfGetter=function(s){for(var i={},a=0;a<s.length;++a)i[s[a]]=1;return function(){for(var d=Object.keys(this),h=d.length-1;h>-1;--h)if(i[d[h]]===1&&this[d[h]]!==void 0&&this[d[h]]!==null)return d[h]}},t.oneOfSetter=function(s){return function(i){for(var a=0;a<s.length;++a)s[a]!==i&&delete this[s[a]]}},t.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},t._configure=function(){var o=t.Buffer;if(!o){t._Buffer_from=t._Buffer_allocUnsafe=null;return}t._Buffer_from=o.from!==Uint8Array.from&&o.from||function(i,a){return new o(i,a)},t._Buffer_allocUnsafe=o.allocUnsafe||function(i){return new o(i)}}})(minimal$1)),minimal$1}var writer,hasRequiredWriter;function requireWriter(){if(hasRequiredWriter)return writer;hasRequiredWriter=1,writer=d;var e=requireMinimal$1(),t,r=e.LongBits,n=e.base64,o=e.utf8;function s(S,$,v){this.fn=S,this.len=$,this.next=void 0,this.val=v}function i(){}function a(S){this.head=S.head,this.tail=S.tail,this.len=S.len,this.next=S.states}function d(){this.len=0,this.head=new s(i,0,0),this.tail=this.head,this.states=null}var h=function(){return e.Buffer?function(){return(d.create=function(){return new t})()}:function(){return new d}};d.create=h(),d.alloc=function($){return new e.Array($)},e.Array!==Array&&(d.alloc=e.pool(d.alloc,e.Array.prototype.subarray)),d.prototype._push=function($,v,C){return this.tail=this.tail.next=new s($,v,C),this.len+=v,this};function b(S,$,v){$[v]=S&255}function y(S,$,v){for(;S>127;)$[v++]=S&127|128,S>>>=7;$[v]=S}function g(S,$){this.len=S,this.next=void 0,this.val=$}g.prototype=Object.create(s.prototype),g.prototype.fn=y,d.prototype.uint32=function($){return this.len+=(this.tail=this.tail.next=new g(($=$>>>0)<128?1:$<16384?2:$<2097152?3:$<268435456?4:5,$)).len,this},d.prototype.int32=function($){return $<0?this._push(p,10,r.fromNumber($)):this.uint32($)},d.prototype.sint32=function($){return this.uint32(($<<1^$>>31)>>>0)};function p(S,$,v){for(;S.hi;)$[v++]=S.lo&127|128,S.lo=(S.lo>>>7|S.hi<<25)>>>0,S.hi>>>=7;for(;S.lo>127;)$[v++]=S.lo&127|128,S.lo=S.lo>>>7;$[v++]=S.lo}d.prototype.uint64=function($){var v=r.from($);return this._push(p,v.length(),v)},d.prototype.int64=d.prototype.uint64,d.prototype.sint64=function($){var v=r.from($).zzEncode();return this._push(p,v.length(),v)},d.prototype.bool=function($){return this._push(b,1,$?1:0)};function l(S,$,v){$[v]=S&255,$[v+1]=S>>>8&255,$[v+2]=S>>>16&255,$[v+3]=S>>>24}d.prototype.fixed32=function($){return this._push(l,4,$>>>0)},d.prototype.sfixed32=d.prototype.fixed32,d.prototype.fixed64=function($){var v=r.from($);return this._push(l,4,v.lo)._push(l,4,v.hi)},d.prototype.sfixed64=d.prototype.fixed64,d.prototype.float=function($){return this._push(e.float.writeFloatLE,4,$)},d.prototype.double=function($){return this._push(e.float.writeDoubleLE,8,$)};var w=e.Array.prototype.set?function($,v,C){v.set($,C)}:function($,v,C){for(var A=0;A<$.length;++A)v[C+A]=$[A]};return d.prototype.bytes=function($){var v=$.length>>>0;if(!v)return this._push(b,1,0);if(e.isString($)){var C=d.alloc(v=n.length($));n.decode($,C,0),$=C}return this.uint32(v)._push(w,v,$)},d.prototype.string=function($){var v=o.length($);return v?this.uint32(v)._push(o.write,v,$):this._push(b,1,0)},d.prototype.fork=function(){return this.states=new a(this),this.head=this.tail=new s(i,0,0),this.len=0,this},d.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new s(i,0,0),this.len=0),this},d.prototype.ldelim=function(){var $=this.head,v=this.tail,C=this.len;return this.reset().uint32(C),C&&(this.tail.next=$.next,this.tail=v,this.len+=C),this},d.prototype.finish=function(){for(var $=this.head.next,v=this.constructor.alloc(this.len),C=0;$;)$.fn($.val,v,C),C+=$.len,$=$.next;return v},d._configure=function(S){t=S,d.create=h(),t._configure()},writer}var writer_buffer,hasRequiredWriter_buffer;function requireWriter_buffer(){if(hasRequiredWriter_buffer)return writer_buffer;hasRequiredWriter_buffer=1,writer_buffer=r;var e=requireWriter();(r.prototype=Object.create(e.prototype)).constructor=r;var t=requireMinimal$1();function r(){e.call(this)}r._configure=function(){r.alloc=t._Buffer_allocUnsafe,r.writeBytesBuffer=t.Buffer&&t.Buffer.prototype instanceof Uint8Array&&t.Buffer.prototype.set.name==="set"?function(s,i,a){i.set(s,a)}:function(s,i,a){if(s.copy)s.copy(i,a,0,s.length);else for(var d=0;d<s.length;)i[a++]=s[d++]}},r.prototype.bytes=function(s){t.isString(s)&&(s=t._Buffer_from(s,"base64"));var i=s.length>>>0;return this.uint32(i),i&&this._push(r.writeBytesBuffer,i,s),this};function n(o,s,i){o.length<40?t.utf8.write(o,s,i):s.utf8Write?s.utf8Write(o,i):s.write(o,i)}return r.prototype.string=function(s){var i=t.Buffer.byteLength(s);return this.uint32(i),i&&this._push(n,i,s),this},r._configure(),writer_buffer}var reader,hasRequiredReader;function requireReader(){if(hasRequiredReader)return reader;hasRequiredReader=1,reader=s;var e=requireMinimal$1(),t,r=e.LongBits,n=e.utf8;function o(y,g){return RangeError("index out of range: "+y.pos+" + "+(g||1)+" > "+y.len)}function s(y){this.buf=y,this.pos=0,this.len=y.length}var i=typeof Uint8Array<"u"?function(g){if(g instanceof Uint8Array||Array.isArray(g))return new s(g);throw Error("illegal buffer")}:function(g){if(Array.isArray(g))return new s(g);throw Error("illegal buffer")},a=function(){return e.Buffer?function(p){return(s.create=function(w){return e.Buffer.isBuffer(w)?new t(w):i(w)})(p)}:i};s.create=a(),s.prototype._slice=e.Array.prototype.subarray||e.Array.prototype.slice,s.prototype.uint32=(function(){var g=4294967295;return function(){if(g=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(g=(g|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(g=(g|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(g=(g|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(g=(g|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return g;if((this.pos+=5)>this.len)throw this.pos=this.len,o(this,10);return g}})(),s.prototype.int32=function(){return this.uint32()|0},s.prototype.sint32=function(){var g=this.uint32();return g>>>1^-(g&1)|0};function d(){var y=new r(0,0),g=0;if(this.len-this.pos>4){for(;g<4;++g)if(y.lo=(y.lo|(this.buf[this.pos]&127)<<g*7)>>>0,this.buf[this.pos++]<128)return y;if(y.lo=(y.lo|(this.buf[this.pos]&127)<<28)>>>0,y.hi=(y.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return y;g=0}else{for(;g<3;++g){if(this.pos>=this.len)throw o(this);if(y.lo=(y.lo|(this.buf[this.pos]&127)<<g*7)>>>0,this.buf[this.pos++]<128)return y}return y.lo=(y.lo|(this.buf[this.pos++]&127)<<g*7)>>>0,y}if(this.len-this.pos>4){for(;g<5;++g)if(y.hi=(y.hi|(this.buf[this.pos]&127)<<g*7+3)>>>0,this.buf[this.pos++]<128)return y}else for(;g<5;++g){if(this.pos>=this.len)throw o(this);if(y.hi=(y.hi|(this.buf[this.pos]&127)<<g*7+3)>>>0,this.buf[this.pos++]<128)return y}throw Error("invalid varint encoding")}s.prototype.bool=function(){return this.uint32()!==0};function h(y,g){return(y[g-4]|y[g-3]<<8|y[g-2]<<16|y[g-1]<<24)>>>0}s.prototype.fixed32=function(){if(this.pos+4>this.len)throw o(this,4);return h(this.buf,this.pos+=4)},s.prototype.sfixed32=function(){if(this.pos+4>this.len)throw o(this,4);return h(this.buf,this.pos+=4)|0};function b(){if(this.pos+8>this.len)throw o(this,8);return new r(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}return s.prototype.float=function(){if(this.pos+4>this.len)throw o(this,4);var g=e.float.readFloatLE(this.buf,this.pos);return this.pos+=4,g},s.prototype.double=function(){if(this.pos+8>this.len)throw o(this,4);var g=e.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,g},s.prototype.bytes=function(){var g=this.uint32(),p=this.pos,l=this.pos+g;if(l>this.len)throw o(this,g);if(this.pos+=g,Array.isArray(this.buf))return this.buf.slice(p,l);if(p===l){var w=e.Buffer;return w?w.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,p,l)},s.prototype.string=function(){var g=this.bytes();return n.read(g,0,g.length)},s.prototype.skip=function(g){if(typeof g=="number"){if(this.pos+g>this.len)throw o(this,g);this.pos+=g}else do if(this.pos>=this.len)throw o(this);while(this.buf[this.pos++]&128);return this},s.prototype.skipType=function(y){switch(y){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(y=this.uint32()&7)!==4;)this.skipType(y);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+y+" at offset "+this.pos)}return this},s._configure=function(y){t=y,s.create=a(),t._configure();var g=e.Long?"toLong":"toNumber";e.merge(s.prototype,{int64:function(){return d.call(this)[g](!1)},uint64:function(){return d.call(this)[g](!0)},sint64:function(){return d.call(this).zzDecode()[g](!1)},fixed64:function(){return b.call(this)[g](!0)},sfixed64:function(){return b.call(this)[g](!1)}})},reader}var reader_buffer,hasRequiredReader_buffer;function requireReader_buffer(){if(hasRequiredReader_buffer)return reader_buffer;hasRequiredReader_buffer=1,reader_buffer=r;var e=requireReader();(r.prototype=Object.create(e.prototype)).constructor=r;var t=requireMinimal$1();function r(n){e.call(this,n)}return r._configure=function(){t.Buffer&&(r.prototype._slice=t.Buffer.prototype.slice)},r.prototype.string=function(){var o=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+o,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+o,this.len))},r._configure(),reader_buffer}var rpc={},service,hasRequiredService;function requireService(){if(hasRequiredService)return service;hasRequiredService=1,service=t;var e=requireMinimal$1();(t.prototype=Object.create(e.EventEmitter.prototype)).constructor=t;function t(r,n,o){if(typeof r!="function")throw TypeError("rpcImpl must be a function");e.EventEmitter.call(this),this.rpcImpl=r,this.requestDelimited=!!n,this.responseDelimited=!!o}return t.prototype.rpcCall=function r(n,o,s,i,a){if(!i)throw TypeError("request must be specified");var d=this;if(!a)return e.asPromise(r,d,n,o,s,i);if(!d.rpcImpl){setTimeout(function(){a(Error("already ended"))},0);return}try{return d.rpcImpl(n,o[d.requestDelimited?"encodeDelimited":"encode"](i).finish(),function(b,y){if(b)return d.emit("error",b,n),a(b);if(y===null){d.end(!0);return}if(!(y instanceof s))try{y=s[d.responseDelimited?"decodeDelimited":"decode"](y)}catch(g){return d.emit("error",g,n),a(g)}return d.emit("data",y,n),a(null,y)})}catch(h){d.emit("error",h,n),setTimeout(function(){a(h)},0);return}},t.prototype.end=function(n){return this.rpcImpl&&(n||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this},service}var hasRequiredRpc;function requireRpc(){return hasRequiredRpc||(hasRequiredRpc=1,(function(e){var t=e;t.Service=requireService()})(rpc)),rpc}var roots,hasRequiredRoots;function requireRoots(){return hasRequiredRoots||(hasRequiredRoots=1,roots={}),roots}var hasRequiredIndexMinimal;function requireIndexMinimal(){return hasRequiredIndexMinimal||(hasRequiredIndexMinimal=1,(function(e){var t=e;t.build="minimal",t.Writer=requireWriter(),t.BufferWriter=requireWriter_buffer(),t.Reader=requireReader(),t.BufferReader=requireReader_buffer(),t.util=requireMinimal$1(),t.rpc=requireRpc(),t.roots=requireRoots(),t.configure=r;function r(){t.util._configure(),t.Writer._configure(t.BufferWriter),t.Reader._configure(t.BufferReader)}r()})(indexMinimal)),indexMinimal}var minimal,hasRequiredMinimal;function requireMinimal(){return hasRequiredMinimal||(hasRequiredMinimal=1,minimal=requireIndexMinimal()),minimal}var minimalExports=requireMinimal();const $protobuf=getDefaultExportFromCjs(minimalExports),$Reader=$protobuf.Reader,$Writer=$protobuf.Writer,$util=$protobuf.util,$root=$protobuf.roots["ipfs-unixfs"]||($protobuf.roots["ipfs-unixfs"]={});$root.Data=(()=>{function e(t){if(this.blocksizes=[],t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.Type=0,e.prototype.Data=$util.newBuffer([]),e.prototype.filesize=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.blocksizes=$util.emptyArray,e.prototype.hashType=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.fanout=$util.Long?$util.Long.fromBits(0,0,!0):0,e.prototype.mode=0,e.prototype.mtime=null,e.encode=function(r,n){if(n||(n=$Writer.create()),n.uint32(8).int32(r.Type),r.Data!=null&&Object.hasOwnProperty.call(r,"Data")&&n.uint32(18).bytes(r.Data),r.filesize!=null&&Object.hasOwnProperty.call(r,"filesize")&&n.uint32(24).uint64(r.filesize),r.blocksizes!=null&&r.blocksizes.length)for(var o=0;o<r.blocksizes.length;++o)n.uint32(32).uint64(r.blocksizes[o]);return r.hashType!=null&&Object.hasOwnProperty.call(r,"hashType")&&n.uint32(40).uint64(r.hashType),r.fanout!=null&&Object.hasOwnProperty.call(r,"fanout")&&n.uint32(48).uint64(r.fanout),r.mode!=null&&Object.hasOwnProperty.call(r,"mode")&&n.uint32(56).uint32(r.mode),r.mtime!=null&&Object.hasOwnProperty.call(r,"mtime")&&$root.UnixTime.encode(r.mtime,n.uint32(66).fork()).ldelim(),n},e.decode=function(r,n){r instanceof $Reader||(r=$Reader.create(r));for(var o=n===void 0?r.len:r.pos+n,s=new $root.Data;r.pos<o;){var i=r.uint32();switch(i>>>3){case 1:s.Type=r.int32();break;case 2:s.Data=r.bytes();break;case 3:s.filesize=r.uint64();break;case 4:if(s.blocksizes&&s.blocksizes.length||(s.blocksizes=[]),(i&7)===2)for(var a=r.uint32()+r.pos;r.pos<a;)s.blocksizes.push(r.uint64());else s.blocksizes.push(r.uint64());break;case 5:s.hashType=r.uint64();break;case 6:s.fanout=r.uint64();break;case 7:s.mode=r.uint32();break;case 8:s.mtime=$root.UnixTime.decode(r,r.uint32());break;default:r.skipType(i&7);break}}if(!s.hasOwnProperty("Type"))throw $util.ProtocolError("missing required 'Type'",{instance:s});return s},e.fromObject=function(r){if(r instanceof $root.Data)return r;var n=new $root.Data;switch(r.Type){case"Raw":case 0:n.Type=0;break;case"Directory":case 1:n.Type=1;break;case"File":case 2:n.Type=2;break;case"Metadata":case 3:n.Type=3;break;case"Symlink":case 4:n.Type=4;break;case"HAMTShard":case 5:n.Type=5;break}if(r.Data!=null&&(typeof r.Data=="string"?$util.base64.decode(r.Data,n.Data=$util.newBuffer($util.base64.length(r.Data)),0):r.Data.length&&(n.Data=r.Data)),r.filesize!=null&&($util.Long?(n.filesize=$util.Long.fromValue(r.filesize)).unsigned=!0:typeof r.filesize=="string"?n.filesize=parseInt(r.filesize,10):typeof r.filesize=="number"?n.filesize=r.filesize:typeof r.filesize=="object"&&(n.filesize=new $util.LongBits(r.filesize.low>>>0,r.filesize.high>>>0).toNumber(!0))),r.blocksizes){if(!Array.isArray(r.blocksizes))throw TypeError(".Data.blocksizes: array expected");n.blocksizes=[];for(var o=0;o<r.blocksizes.length;++o)$util.Long?(n.blocksizes[o]=$util.Long.fromValue(r.blocksizes[o])).unsigned=!0:typeof r.blocksizes[o]=="string"?n.blocksizes[o]=parseInt(r.blocksizes[o],10):typeof r.blocksizes[o]=="number"?n.blocksizes[o]=r.blocksizes[o]:typeof r.blocksizes[o]=="object"&&(n.blocksizes[o]=new $util.LongBits(r.blocksizes[o].low>>>0,r.blocksizes[o].high>>>0).toNumber(!0))}if(r.hashType!=null&&($util.Long?(n.hashType=$util.Long.fromValue(r.hashType)).unsigned=!0:typeof r.hashType=="string"?n.hashType=parseInt(r.hashType,10):typeof r.hashType=="number"?n.hashType=r.hashType:typeof r.hashType=="object"&&(n.hashType=new $util.LongBits(r.hashType.low>>>0,r.hashType.high>>>0).toNumber(!0))),r.fanout!=null&&($util.Long?(n.fanout=$util.Long.fromValue(r.fanout)).unsigned=!0:typeof r.fanout=="string"?n.fanout=parseInt(r.fanout,10):typeof r.fanout=="number"?n.fanout=r.fanout:typeof r.fanout=="object"&&(n.fanout=new $util.LongBits(r.fanout.low>>>0,r.fanout.high>>>0).toNumber(!0))),r.mode!=null&&(n.mode=r.mode>>>0),r.mtime!=null){if(typeof r.mtime!="object")throw TypeError(".Data.mtime: object expected");n.mtime=$root.UnixTime.fromObject(r.mtime)}return n},e.toObject=function(r,n){n||(n={});var o={};if((n.arrays||n.defaults)&&(o.blocksizes=[]),n.defaults){if(o.Type=n.enums===String?"Raw":0,n.bytes===String?o.Data="":(o.Data=[],n.bytes!==Array&&(o.Data=$util.newBuffer(o.Data))),$util.Long){var s=new $util.Long(0,0,!0);o.filesize=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else o.filesize=n.longs===String?"0":0;if($util.Long){var s=new $util.Long(0,0,!0);o.hashType=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else o.hashType=n.longs===String?"0":0;if($util.Long){var s=new $util.Long(0,0,!0);o.fanout=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else o.fanout=n.longs===String?"0":0;o.mode=0,o.mtime=null}if(r.Type!=null&&r.hasOwnProperty("Type")&&(o.Type=n.enums===String?$root.Data.DataType[r.Type]:r.Type),r.Data!=null&&r.hasOwnProperty("Data")&&(o.Data=n.bytes===String?$util.base64.encode(r.Data,0,r.Data.length):n.bytes===Array?Array.prototype.slice.call(r.Data):r.Data),r.filesize!=null&&r.hasOwnProperty("filesize")&&(typeof r.filesize=="number"?o.filesize=n.longs===String?String(r.filesize):r.filesize:o.filesize=n.longs===String?$util.Long.prototype.toString.call(r.filesize):n.longs===Number?new $util.LongBits(r.filesize.low>>>0,r.filesize.high>>>0).toNumber(!0):r.filesize),r.blocksizes&&r.blocksizes.length){o.blocksizes=[];for(var i=0;i<r.blocksizes.length;++i)typeof r.blocksizes[i]=="number"?o.blocksizes[i]=n.longs===String?String(r.blocksizes[i]):r.blocksizes[i]:o.blocksizes[i]=n.longs===String?$util.Long.prototype.toString.call(r.blocksizes[i]):n.longs===Number?new $util.LongBits(r.blocksizes[i].low>>>0,r.blocksizes[i].high>>>0).toNumber(!0):r.blocksizes[i]}return r.hashType!=null&&r.hasOwnProperty("hashType")&&(typeof r.hashType=="number"?o.hashType=n.longs===String?String(r.hashType):r.hashType:o.hashType=n.longs===String?$util.Long.prototype.toString.call(r.hashType):n.longs===Number?new $util.LongBits(r.hashType.low>>>0,r.hashType.high>>>0).toNumber(!0):r.hashType),r.fanout!=null&&r.hasOwnProperty("fanout")&&(typeof r.fanout=="number"?o.fanout=n.longs===String?String(r.fanout):r.fanout:o.fanout=n.longs===String?$util.Long.prototype.toString.call(r.fanout):n.longs===Number?new $util.LongBits(r.fanout.low>>>0,r.fanout.high>>>0).toNumber(!0):r.fanout),r.mode!=null&&r.hasOwnProperty("mode")&&(o.mode=r.mode),r.mtime!=null&&r.hasOwnProperty("mtime")&&(o.mtime=$root.UnixTime.toObject(r.mtime,n)),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e.DataType=(function(){const t={},r=Object.create(t);return r[t[0]="Raw"]=0,r[t[1]="Directory"]=1,r[t[2]="File"]=2,r[t[3]="Metadata"]=3,r[t[4]="Symlink"]=4,r[t[5]="HAMTShard"]=5,r})(),e})();$root.UnixTime=(()=>{function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.Seconds=$util.Long?$util.Long.fromBits(0,0,!1):0,e.prototype.FractionalNanoseconds=0,e.encode=function(r,n){return n||(n=$Writer.create()),n.uint32(8).int64(r.Seconds),r.FractionalNanoseconds!=null&&Object.hasOwnProperty.call(r,"FractionalNanoseconds")&&n.uint32(21).fixed32(r.FractionalNanoseconds),n},e.decode=function(r,n){r instanceof $Reader||(r=$Reader.create(r));for(var o=n===void 0?r.len:r.pos+n,s=new $root.UnixTime;r.pos<o;){var i=r.uint32();switch(i>>>3){case 1:s.Seconds=r.int64();break;case 2:s.FractionalNanoseconds=r.fixed32();break;default:r.skipType(i&7);break}}if(!s.hasOwnProperty("Seconds"))throw $util.ProtocolError("missing required 'Seconds'",{instance:s});return s},e.fromObject=function(r){if(r instanceof $root.UnixTime)return r;var n=new $root.UnixTime;return r.Seconds!=null&&($util.Long?(n.Seconds=$util.Long.fromValue(r.Seconds)).unsigned=!1:typeof r.Seconds=="string"?n.Seconds=parseInt(r.Seconds,10):typeof r.Seconds=="number"?n.Seconds=r.Seconds:typeof r.Seconds=="object"&&(n.Seconds=new $util.LongBits(r.Seconds.low>>>0,r.Seconds.high>>>0).toNumber())),r.FractionalNanoseconds!=null&&(n.FractionalNanoseconds=r.FractionalNanoseconds>>>0),n},e.toObject=function(r,n){n||(n={});var o={};if(n.defaults){if($util.Long){var s=new $util.Long(0,0,!1);o.Seconds=n.longs===String?s.toString():n.longs===Number?s.toNumber():s}else o.Seconds=n.longs===String?"0":0;o.FractionalNanoseconds=0}return r.Seconds!=null&&r.hasOwnProperty("Seconds")&&(typeof r.Seconds=="number"?o.Seconds=n.longs===String?String(r.Seconds):r.Seconds:o.Seconds=n.longs===String?$util.Long.prototype.toString.call(r.Seconds):n.longs===Number?new $util.LongBits(r.Seconds.low>>>0,r.Seconds.high>>>0).toNumber():r.Seconds),r.FractionalNanoseconds!=null&&r.hasOwnProperty("FractionalNanoseconds")&&(o.FractionalNanoseconds=r.FractionalNanoseconds),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e})();$root.Metadata=(()=>{function e(t){if(t)for(var r=Object.keys(t),n=0;n<r.length;++n)t[r[n]]!=null&&(this[r[n]]=t[r[n]])}return e.prototype.MimeType="",e.encode=function(r,n){return n||(n=$Writer.create()),r.MimeType!=null&&Object.hasOwnProperty.call(r,"MimeType")&&n.uint32(10).string(r.MimeType),n},e.decode=function(r,n){r instanceof $Reader||(r=$Reader.create(r));for(var o=n===void 0?r.len:r.pos+n,s=new $root.Metadata;r.pos<o;){var i=r.uint32();switch(i>>>3){case 1:s.MimeType=r.string();break;default:r.skipType(i&7);break}}return s},e.fromObject=function(r){if(r instanceof $root.Metadata)return r;var n=new $root.Metadata;return r.MimeType!=null&&(n.MimeType=String(r.MimeType)),n},e.toObject=function(r,n){n||(n={});var o={};return n.defaults&&(o.MimeType=""),r.MimeType!=null&&r.hasOwnProperty("MimeType")&&(o.MimeType=r.MimeType),o},e.prototype.toJSON=function(){return this.constructor.toObject(this,$protobuf.util.toJSONOptions)},e})();function parseMode(e){if(e!=null)return typeof e=="number"?e&4095:(e=e.toString(),e.substring(0,1)==="0"?parseInt(e,8)&4095:parseInt(e,10)&4095)}function parseMtime(e){if(e==null)return;let t;if(e.secs!=null&&(t={secs:e.secs,nsecs:e.nsecs}),e.Seconds!=null&&(t={secs:e.Seconds,nsecs:e.FractionalNanoseconds}),Array.isArray(e)&&(t={secs:e[0],nsecs:e[1]}),e instanceof Date){const r=e.getTime(),n=Math.floor(r/1e3);t={secs:n,nsecs:(r-n*1e3)*1e3}}if(Object.prototype.hasOwnProperty.call(t,"secs")){if(t!=null&&t.nsecs!=null&&(t.nsecs<0||t.nsecs>999999999))throw errCode(new Error("mtime-nsecs must be within the range [0,999999999]"),"ERR_INVALID_MTIME_NSECS");return t}}async function*normaliseCandidateMultiple(e,t){if(typeof e=="string"||e instanceof String||isBytes(e)||isBlob(e)||e._readableState)throw errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(isReadableStream(e)&&(e=browserReadableStreamToIt(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=peekableIterator(e),{value:n,done:o}=await r.peek();if(o){yield*[];return}if(r.push(n),Number.isInteger(n))throw errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT");if(n._readableState){yield*map(r,s=>toFileObject$1({content:s},t));return}if(isBytes(n)){yield toFileObject$1({content:r},t);return}if(isFileObject(n)||n[Symbol.iterator]||n[Symbol.asyncIterator]||isReadableStream(n)||isBlob(n)){yield*map(r,s=>toFileObject$1(s,t));return}}throw isFileObject(e)?errCode(new Error("Unexpected input: single item passed - if you are using ipfs.addAll, please use ipfs.add instead"),"ERR_UNEXPECTED_INPUT"):errCode(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}async function toFileObject$1(e,t){const{path:r,mode:n,mtime:o,content:s}=e,i={path:r||"",mode:parseMode(n),mtime:parseMtime(o)};return s?i.content=await t(s):r||(i.content=await t(e)),i}function normaliseInput$2(e){return normaliseCandidateMultiple(e,normaliseContent$1)}function modeToString(e){if(e!=null)return typeof e=="string"?e:e.toString(8).padStart(4,"0")}async function multipartRequest(e,t,r={}){const n=[],o=new FormData;let s=0,i=0;for await(const{content:a,path:d,mode:h,mtime:b}of normaliseInput$2(e)){let y="";const g=a?"file":"dir";s>0&&(y=`-${s}`);let p=g+y;const l=[];if(h!=null&&l.push(`mode=${modeToString(h)}`),b!=null){const{secs:w,nsecs:S}=b;l.push(`mtime=${w}`),S!=null&&l.push(`mtime-nsecs=${S}`)}if(l.length&&(p=`${p}?${l.join("&")}`),a){o.set(p,a,d!=null?encodeURIComponent(d):void 0);const w=i+a.size;n.push({name:d,start:i,end:w}),i=w}else if(d!=null)o.set(p,new File([""],encodeURIComponent(d),{type:"application/x-directory"}));else throw new Error("path or content or both must be set");s++}return{total:i,parts:n,headers:r,body:o}}var anySignalExports=requireAnySignal();function filter(e){return e.filter(Boolean)}function abortSignal(...e){return anySignalExports.anySignal(filter(e))}const createPut$3=configure(e=>{async function t(r,n={}){const o=new AbortController,s=abortSignal(o.signal,n.signal);let i;try{i=await(await e.post("block/put",{signal:s,searchParams:toUrlSearchParams(n),...await multipartRequest([r],o,n.headers)})).json()}catch(a){if(n.format==="dag-pb")return t(r,{...n,format:"protobuf"});if(n.format==="dag-cbor")return t(r,{...n,format:"cbor"});throw a}return CID$1.parse(i.Key)}return t}),createRm$6=configure(e=>{async function*t(r,n={}){Array.isArray(r)||(r=[r]);const o=await e.post("block/rm",{signal:n.signal,searchParams:toUrlSearchParams({arg:r.map(s=>s.toString()),"stream-channels":!0,...n}),headers:n.headers});for await(const s of o.ndjson())yield toCoreInterface$3(s)}return t});function toCoreInterface$3(e){const t={cid:CID$1.parse(e.Hash)};return e.Error&&(t.error=new Error(e.Error)),t}const createStat$3=configure(e=>{async function t(r,n={}){const s=await(await e.post("block/stat",{signal:n.signal,searchParams:toUrlSearchParams({arg:r.toString(),...n}),headers:n.headers})).json();return{cid:CID$1.parse(s.Key),size:s.Size}}return t});function createBlock(e){return{get:createGet$5(e),put:createPut$3(e),rm:createRm$6(e),stat:createStat$3(e)}}const createAdd$4=configure(e=>{async function t(r,n={}){const o=await e.post("bootstrap/add",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers}),{Peers:s}=await o.json();return{Peers:s.map(i=>multiaddr$2(i))}}return t}),createClear=configure(e=>{async function t(r={}){const n=await e.post("bootstrap/rm",{signal:r.signal,searchParams:toUrlSearchParams({...r,all:!0}),headers:r.headers}),{Peers:o}=await n.json();return{Peers:o.map(s=>multiaddr$2(s))}}return t}),createList$2=configure(e=>{async function t(r={}){const n=await e.post("bootstrap/list",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers}),{Peers:o}=await n.json();return{Peers:o.map(s=>multiaddr$2(s))}}return t}),createReset=configure(e=>{async function t(r={}){const n=await e.post("bootstrap/add",{signal:r.signal,searchParams:toUrlSearchParams({...r,default:!0}),headers:r.headers}),{Peers:o}=await n.json();return{Peers:o.map(s=>multiaddr$2(s))}}return t}),createRm$5=configure(e=>{async function t(r,n={}){const o=await e.post("bootstrap/rm",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers}),{Peers:s}=await o.json();return{Peers:s.map(i=>multiaddr$2(i))}}return t});function createBootstrap(e){return{add:createAdd$4(e),clear:createClear(e),list:createList$2(e),reset:createReset(e),rm:createRm$5(e)}}const createApply=configure(e=>{async function t(r,n={}){const s=await(await e.post("config/profile/apply",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers})).json();return{original:s.OldCfg,updated:s.NewCfg}}return t});function objectToCamel(e){if(e==null)return e;const t=/^[A-Z]+$/,r={};return Object.keys(e).reduce((n,o)=>(t.test(o)?n[o.toLowerCase()]=e[o]:t.test(o[0])?n[o[0].toLowerCase()+o.slice(1)]=e[o]:n[o]=e[o],n),r)}const createList$1=configure(e=>{async function t(r={}){return(await(await e.post("config/profile/list",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()).map(s=>objectToCamel(s))}return t});function createProfiles(e){return{apply:createApply(e),list:createList$1(e)}}const createGet$4=configure(e=>async(r,n={})=>{if(!r)throw new Error("key argument is required");return(await(await e.post("config",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers})).json()).Value}),createGetAll=configure(e=>async(r={})=>await(await e.post("config/show",{signal:r.signal,searchParams:toUrlSearchParams({...r}),headers:r.headers})).json()),createReplace=configure(e=>async(r,n={})=>{const o=new AbortController,s=abortSignal(o.signal,n.signal);await(await e.post("config/replace",{signal:s,searchParams:toUrlSearchParams(n),...await multipartRequest([fromString$4(JSON.stringify(r))],o,n.headers)})).text()}),createSet=configure(e=>async(r,n,o={})=>{if(typeof r!="string")throw new Error("Invalid key type");const s={...o,...encodeParam(r,n)};await(await e.post("config",{signal:o.signal,searchParams:toUrlSearchParams(s),headers:o.headers})).text()}),encodeParam=(e,t)=>{switch(typeof t){case"boolean":return{arg:[e,t.toString()],bool:!0};case"string":return{arg:[e,t]};default:return{arg:[e,JSON.stringify(t)],json:!0}}};function createConfig(e){return{getAll:createGetAll(e),get:createGet$4(e),set:createSet(e),replace:createReplace(e),profiles:createProfiles(e)}}const createExport$1=configure(e=>{async function*t(r,n={}){yield*(await e.post("dag/export",{signal:n.signal,searchParams:toUrlSearchParams({arg:r.toString()}),headers:n.headers})).iterator()}return t});async function*resolve(e,t,r,n,o){const s=async h=>{const b=await r.getCodec(h.code),y=await n(h,o);return b.decode(y)},i=t.split("/").filter(Boolean);let a=await s(e),d=e;for(;i.length;){const h=i.shift();if(!h)throw errCode(new Error(`Could not resolve path "${t}"`),"ERR_INVALID_PATH");if(Object.prototype.hasOwnProperty.call(a,h))a=a[h],yield{value:a,remainderPath:i.join("/")};else throw errCode(new Error(`no link named "${h}" under ${d}`),"ERR_NO_LINK");const b=CID$1.asCID(a);b&&(d=b,a=await s(a))}yield{value:a,remainderPath:""}}async function first(e){for await(const t of e)return t}async function last(e){let t;for await(const r of e)t=r;return t}const createGet$3=(e,t)=>configure((n,o)=>{const s=createGet$5(o);return async(a,d={})=>{if(d.path){const p=d.localResolve?await first(resolve(a,d.path,e,s,d)):await last(resolve(a,d.path,e,s,d));if(!p)throw errCode(new Error("Not found"),"ERR_NOT_FOUND");return p}const h=await e.getCodec(a.code),b=await s(a,d);return{value:h.decode(b),remainderPath:""}}})(t),createImport$1=configure(e=>{async function*t(r,n={}){const o=new AbortController,s=abortSignal(o.signal,n.signal),{headers:i,body:a}=await multipartRequest(r,o,n.headers),d=await e.post("dag/import",{signal:s,headers:i,body:a,searchParams:toUrlSearchParams({"pin-roots":n.pinRoots})});for await(const{Root:h}of d.ndjson())if(h!==void 0){const{Cid:{"/":b},PinErrorMsg:y}=h;yield{root:{cid:CID$1.parse(b),pinErrorMsg:y}}}}return t}),createPut$2=(e,t)=>configure(n=>async(s,i={})=>{const a={storeCodec:"dag-cbor",hashAlg:"sha2-256",...i};let d;if(a.inputCodec){if(!(s instanceof Uint8Array))throw new Error("Can only inputCodec on raw bytes that can be decoded");d=s}else d=(await e.getCodec(a.storeCodec)).encode(s),a.inputCodec=a.storeCodec;const h=new AbortController,b=abortSignal(h.signal,a.signal),g=await(await n.post("dag/put",{timeout:a.timeout,signal:b,searchParams:toUrlSearchParams(a),...await multipartRequest([d],h,a.headers)})).json();return CID$1.parse(g.Cid["/"])})(t),createResolve$2=configure(e=>async(r,n={})=>{const s=await(await e.post("dag/resolve",{signal:n.signal,searchParams:toUrlSearchParams({arg:`${r}${n.path?`/${n.path}`.replace(/\/[/]+/g,"/"):""}`,...n}),headers:n.headers})).json();return{cid:CID$1.parse(s.Cid["/"]),remainderPath:s.RemPath}});function createDag(e,t){return{export:createExport$1(t),get:createGet$3(e,t),import:createImport$1(t),put:createPut$2(e,t),resolve:createResolve$2(t)}}const SendingQuery=0,PeerResponse=1,FinalPeer=2,QueryError=3,Provider=4,Value=5,AddingPeer=6,DialingPeer=7,mapEvent=e=>{if(e.Type===SendingQuery)return{name:"SENDING_QUERY",type:e.Type};if(e.Type===PeerResponse)return{from:peerIdFromString(e.ID),name:"PEER_RESPONSE",type:e.Type,messageType:0,messageName:"PUT_VALUE",closer:(e.Responses||[]).map(({ID:t,Addrs:r})=>({id:peerIdFromString(t),multiaddrs:r.map(n=>multiaddr$2(n)),protocols:[]})),providers:(e.Responses||[]).map(({ID:t,Addrs:r})=>({id:peerIdFromString(t),multiaddrs:r.map(n=>multiaddr$2(n)),protocols:[]}))};if(e.Type===FinalPeer){let t={id:e.ID??peerIdFromString(e.ID),multiaddrs:[],protocols:[]};return e.Responses&&e.Responses.length&&(t={id:peerIdFromString(e.Responses[0].ID),multiaddrs:e.Responses[0].Addrs.map(r=>multiaddr$2(r)),protocols:[]}),{name:"FINAL_PEER",type:e.Type,peer:t}}if(e.Type===QueryError)return{name:"QUERY_ERROR",type:e.Type,error:new Error(e.Extra)};if(e.Type===Provider)return{name:"PROVIDER",type:e.Type,providers:e.Responses.map(({ID:t,Addrs:r})=>({id:peerIdFromString(t),multiaddrs:r.map(n=>multiaddr$2(n)),protocols:[]}))};if(e.Type===Value)return{name:"VALUE",type:e.Type,value:fromString$4(e.Extra,"base64pad")};if(e.Type===AddingPeer){const t=e.Responses.map(({ID:r})=>peerIdFromString(r));if(!t.length)throw new Error("No peer found");return{name:"ADDING_PEER",type:e.Type,peer:t[0]}}if(e.Type===DialingPeer)return{name:"DIALING_PEER",type:e.Type,peer:peerIdFromString(e.ID)};throw new Error("Unknown DHT event type")},createFindPeer=configure(e=>{async function*t(r,n={}){const o=await e.post("dht/findpeer",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers});for await(const s of o.ndjson())yield mapEvent(s)}return t}),createFindProvs=configure(e=>{async function*t(r,n={}){const o=await e.post("dht/findprovs",{signal:n.signal,searchParams:toUrlSearchParams({arg:r.toString(),...n}),headers:n.headers});for await(const s of o.ndjson())yield mapEvent(s)}return t}),createGet$2=configure(e=>{async function*t(r,n={}){const o=await e.post("dht/get",{signal:n.signal,searchParams:toUrlSearchParams({arg:r instanceof Uint8Array?toString$4(r):r.toString(),...n}),headers:n.headers});for await(const s of o.ndjson())yield mapEvent(s)}return t}),createProvide=configure(e=>{async function*t(r,n={recursive:!1}){const o=Array.isArray(r)?r:[r],s=await e.post("dht/provide",{signal:n.signal,searchParams:toUrlSearchParams({arg:o.map(i=>i.toString()),...n}),headers:n.headers});for await(const i of s.ndjson())yield mapEvent(i)}return t}),createPut$1=configure(e=>{async function*t(r,n,o={}){const s=new AbortController,i=abortSignal(s.signal,o.signal),a=await e.post("dht/put",{signal:i,searchParams:toUrlSearchParams({arg:r instanceof Uint8Array?toString$4(r):r.toString(),...o}),...await multipartRequest([n],s,o.headers)});for await(const d of a.ndjson())yield mapEvent(d)}return t}),createQuery=configure(e=>{async function*t(r,n={}){const o=await e.post("dht/query",{signal:n.signal,searchParams:toUrlSearchParams({arg:r.toString(),...n}),headers:n.headers});for await(const s of o.ndjson())yield mapEvent(s)}return t});function createDht(e){return{findPeer:createFindPeer(e),findProvs:createFindProvs(e),get:createGet$2(e),provide:createProvide(e),put:createPut$1(e),query:createQuery(e)}}const createCmds=configure(e=>{async function t(r={}){return(await e.post("diag/cmds",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()}return t}),createNet=configure(e=>{async function t(r={}){return(await e.post("diag/net",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()}return t}),createSys=configure(e=>{async function t(r={}){return(await e.post("diag/sys",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()}return t});function createDiag(e){return{cmds:createCmds(e),net:createNet(e),sys:createSys(e)}}const createChmod=configure(e=>{async function t(r,n,o={}){await(await e.post("files/chmod",{signal:o.signal,searchParams:toUrlSearchParams({arg:r,mode:n,...o}),headers:o.headers})).text()}return t}),createCp=configure(e=>{async function t(r,n,o={}){const s=Array.isArray(r)?r:[r];await(await e.post("files/cp",{signal:o.signal,searchParams:toUrlSearchParams({arg:s.concat(n).map(a=>CID$1.asCID(a)?`/ipfs/${a}`:a),...o}),headers:o.headers})).text()}return t}),createFlush=configure(e=>{async function t(r,n={}){if(!r||typeof r!="string")throw new Error("ipfs.files.flush requires a path");const s=await(await e.post("files/flush",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers})).json();return CID$1.parse(s.Cid)}return t});function objectToCamelWithMetadata(e){const t=objectToCamel(e);return Object.prototype.hasOwnProperty.call(t,"mode")&&(t.mode=parseInt(t.mode,8)),Object.prototype.hasOwnProperty.call(t,"mtime")&&(t.mtime={secs:t.mtime,nsecs:t.mtimeNsecs||0},delete t.mtimeNsecs),t}const createLs$6=configure(e=>{async function*t(r,n={}){if(!r)throw new Error("ipfs.files.ls requires a path");const o=await e.post("files/ls",{signal:n.signal,searchParams:toUrlSearchParams({arg:CID$1.asCID(r)?`/ipfs/${r}`:r,long:!0,...n,stream:!0}),headers:n.headers});for await(const s of o.ndjson())if("Entries"in s)for(const i of s.Entries||[])yield toCoreInterface$2(objectToCamelWithMetadata(i));else yield toCoreInterface$2(objectToCamelWithMetadata(s))}return t});function toCoreInterface$2(e){return e.hash&&(e.cid=CID$1.parse(e.hash)),delete e.hash,e.type=e.type===1?"directory":"file",e}const createMkdir=configure(e=>{async function t(r,n={}){await(await e.post("files/mkdir",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers})).text()}return t}),createMv=configure(e=>{async function t(r,n,o={}){Array.isArray(r)||(r=[r]),await(await e.post("files/mv",{signal:o.signal,searchParams:toUrlSearchParams({arg:r.concat(n),...o}),headers:o.headers})).text()}return t});var source,hasRequiredSource;function requireSource(){return hasRequiredSource||(hasRequiredSource=1,source=e=>{if(e[Symbol.asyncIterator])return e;if(e.getReader)return(async function*(){const t=e.getReader();try{for(;;){const{done:r,value:n}=await t.read();if(r)return;yield n}}finally{t.releaseLock()}})();throw new Error("unknown stream")}),source}var sourceExports=requireSource();const toIterable=getDefaultExportFromCjs(sourceExports),createRead=configure(e=>{async function*t(r,n={}){const o=await e.post("files/read",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,count:n.length,...n}),headers:n.headers});yield*toIterable(o.body)}return t}),createRm$4=configure(e=>{async function t(r,n={}){const o=await e.post("files/rm",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers}),s=await o.text();if(s!==""){const i=new HTTP.HTTPError(o);throw i.message=s,i}}return t}),createStat$2=configure(e=>{async function t(r,n={}){const s=await(await e.post("files/stat",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers})).json();return s.WithLocality=s.WithLocality||!1,toCoreInterface$1(objectToCamelWithMetadata(s))}return t});function toCoreInterface$1(e){return e.cid=CID$1.parse(e.hash),delete e.hash,e}const createTouch=configure(e=>{async function t(r,n={}){await(await e.post("files/touch",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers})).text()}return t}),createWrite=configure(e=>{async function t(r,n,o={}){const s=new AbortController,i=abortSignal(s.signal,o.signal);await(await e.post("files/write",{signal:i,searchParams:toUrlSearchParams({arg:r,streamChannels:!0,count:o.length,...o}),...await multipartRequest([{content:n,path:"arg",mode:modeToString$1(o.mode),mtime:parseMtime$1(o.mtime)}],s,o.headers)})).text()}return t});function createFiles(e){return{chmod:createChmod(e),cp:createCp(e),flush:createFlush(e),ls:createLs$6(e),mkdir:createMkdir(e),mv:createMv(e),read:createRead(e),rm:createRm$4(e),stat:createStat$2(e),touch:createTouch(e),write:createWrite(e)}}const createExport=configure(e=>async(r,n,o={})=>{throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),createGen=configure(e=>{async function t(r,n){const o=n??{type:"Ed25519"},i=await(await e.post("key/gen",{signal:o.signal,searchParams:toUrlSearchParams({arg:r,...o}),headers:o.headers})).json();return objectToCamel(i)}return t}),createImport=configure(e=>{async function t(r,n,o,s={}){const a=await(await e.post("key/import",{signal:s.signal,searchParams:toUrlSearchParams({arg:r,pem:n,password:o,...s}),headers:s.headers})).json();return objectToCamel(a)}return t}),createInfo=configure(e=>async(r,n={})=>{throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),createList=configure(e=>{async function t(r={}){return((await(await e.post("key/list",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()).Keys||[]).map(s=>objectToCamel(s))}return t}),createRename=configure(e=>{async function t(r,n,o={}){const s=await e.post("key/rename",{signal:o.signal,searchParams:toUrlSearchParams({arg:[r,n],...o}),headers:o.headers});return objectToCamel(await s.json())}return t}),createRm$3=configure(e=>{async function t(r,n={}){const s=await(await e.post("key/rm",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers})).json();return objectToCamel(s.Keys[0])}return t});function createKey(e){return{export:createExport(e),gen:createGen(e),import:createImport(e),info:createInfo(e),list:createList(e),rename:createRename(e),rm:createRm$3(e)}}const createLevel=configure(e=>{async function t(r,n,o={}){const s=await e.post("log/level",{signal:o.signal,searchParams:toUrlSearchParams({arg:[r,n],...o}),headers:o.headers});return objectToCamel(await s.json())}return t}),createLs$5=configure(e=>{async function t(r={}){return(await(await e.post("log/ls",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()).Strings}return t}),createTail=configure(e=>{async function*t(r={}){yield*(await e.post("log/tail",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).ndjson()}return t});function createLog(e){return{level:createLevel(e),ls:createLs$5(e),tail:createTail(e)}}const createPublish$1=configure(e=>{async function t(r,n={}){const o=await e.post("name/publish",{signal:n.signal,searchParams:toUrlSearchParams({arg:`${r}`,...n}),headers:n.headers});return objectToCamel(await o.json())}return t}),createResolve$1=configure(e=>{async function*t(r,n={}){const o=await e.post("name/resolve",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,stream:!0,...n}),headers:n.headers});for await(const s of o.ndjson())yield s.Path}return t}),createCancel=configure(e=>{async function t(r,n={}){const o=await e.post("name/pubsub/cancel",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers});return objectToCamel(await o.json())}return t}),createState=configure(e=>{async function t(r={}){const n=await e.post("name/pubsub/state",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers});return objectToCamel(await n.json())}return t}),createSubs=configure(e=>{async function t(r={}){return(await(await e.post("name/pubsub/subs",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()).Strings||[]}return t});function createPubsub$1(e){return{cancel:createCancel(e),state:createState(e),subs:createSubs(e)}}function createName(e){return{publish:createPublish$1(e),resolve:createResolve$1(e),pubsub:createPubsub$1(e)}}const createData=configure(e=>{async function t(r,n={}){const s=await(await e.post("object/data",{signal:n.signal,searchParams:toUrlSearchParams({arg:`${r instanceof Uint8Array?CID$1.decode(r):r}`,...n}),headers:n.headers})).arrayBuffer();return new Uint8Array(s,0,s.byteLength)}return t}),createGet$1=configure(e=>{async function t(r,n={}){const s=await(await e.post("object/get",{signal:n.signal,searchParams:toUrlSearchParams({arg:`${r instanceof Uint8Array?CID$1.decode(r):r}`,dataEncoding:"base64",...n}),headers:n.headers})).json();return{Data:fromString$4(s.Data,"base64pad"),Links:(s.Links||[]).map(i=>({Name:i.Name,Hash:CID$1.parse(i.Hash),Tsize:i.Size}))}}return t}),createLinks=configure(e=>{async function t(r,n={}){return((await(await e.post("object/links",{signal:n.signal,searchParams:toUrlSearchParams({arg:`${r instanceof Uint8Array?CID$1.decode(r):r}`,...n}),headers:n.headers})).json()).Links||[]).map(i=>({Name:i.Name,Tsize:i.Size,Hash:CID$1.parse(i.Hash)}))}return t}),createNew=configure(e=>{async function t(r={}){const n=await e.post("object/new",{signal:r.signal,searchParams:toUrlSearchParams({arg:r.template,...r}),headers:r.headers}),{Hash:o}=await n.json();return CID$1.parse(o)}return t}),createPut=(e,t)=>configure(n=>{const o=createPut$2(e,t);async function s(i,a={}){return o(i,{...a,storeCodec:"dag-pb",hashAlg:"sha2-256",version:1})}return s})(t),createStat$1=configure(e=>{async function t(r,n={}){const s=await(await e.post("object/stat",{signal:n.signal,searchParams:toUrlSearchParams({arg:`${r}`,...n}),headers:n.headers})).json();return{...s,Hash:CID$1.parse(s.Hash)}}return t}),createAddLink=configure(e=>{async function t(r,n,o={}){const s=await e.post("object/patch/add-link",{signal:o.signal,searchParams:toUrlSearchParams({arg:[`${r}`,n.Name||n.name||"",(n.Hash||n.cid||"").toString()||null],...o}),headers:o.headers}),{Hash:i}=await s.json();return CID$1.parse(i)}return t}),createAppendData=configure(e=>{async function t(r,n,o={}){const s=new AbortController,i=abortSignal(s.signal,o.signal),a=await e.post("object/patch/append-data",{signal:i,searchParams:toUrlSearchParams({arg:`${r}`,...o}),...await multipartRequest([n],s,o.headers)}),{Hash:d}=await a.json();return CID$1.parse(d)}return t}),createRmLink=configure(e=>{async function t(r,n,o={}){const s=await e.post("object/patch/rm-link",{signal:o.signal,searchParams:toUrlSearchParams({arg:[`${r}`,n.Name||n.name||null],...o}),headers:o.headers}),{Hash:i}=await s.json();return CID$1.parse(i)}return t}),createSetData=configure(e=>{async function t(r,n,o={}){const s=new AbortController,i=abortSignal(s.signal,o.signal),a=await e.post("object/patch/set-data",{signal:i,searchParams:toUrlSearchParams({arg:[`${r}`],...o}),...await multipartRequest([n],s,o.headers)}),{Hash:d}=await a.json();return CID$1.parse(d)}return t});function createPatch(e){return{addLink:createAddLink(e),appendData:createAppendData(e),rmLink:createRmLink(e),setData:createSetData(e)}}function createObject(e,t){return{data:createData(t),get:createGet$1(t),links:createLinks(t),new:createNew(t),put:createPut(e,t),stat:createStat$1(t),patch:createPatch(t)}}function isIterable(e){return Symbol.iterator in e}function isAsyncIterable(e){return Symbol.asyncIterator in e}function isCID(e){return CID$1.asCID(e)!=null}async function*normaliseInput$1(e){if(e==null)throw errCode(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");const t=CID$1.asCID(e);if(t){yield toPin$1({cid:t});return}if(e instanceof String||typeof e=="string"){yield toPin$1({path:e});return}if(e.cid!=null||e.path!=null)return yield toPin$1(e);if(isIterable(e)){const r=e[Symbol.iterator](),n=r.next();if(n.done)return r;if(isCID(n.value)){yield toPin$1({cid:n.value});for(const o of r)yield toPin$1({cid:o});return}if(n.value instanceof String||typeof n.value=="string"){yield toPin$1({path:n.value});for(const o of r)yield toPin$1({path:o});return}if(n.value.cid!=null||n.value.path!=null){yield toPin$1(n.value);for(const o of r)yield toPin$1(o);return}throw errCode(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}if(isAsyncIterable(e)){const r=e[Symbol.asyncIterator](),n=await r.next();if(n.done)return r;if(isCID(n.value)){yield toPin$1({cid:n.value});for await(const o of r)yield toPin$1({cid:o});return}if(n.value instanceof String||typeof n.value=="string"){yield toPin$1({path:n.value});for await(const o of r)yield toPin$1({path:o});return}if(n.value.cid!=null||n.value.path!=null){yield toPin$1(n.value);for await(const o of r)yield toPin$1(o);return}throw errCode(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}throw errCode(new Error("Unexpected input: "+typeof e),"ERR_UNEXPECTED_INPUT")}function toPin$1(e){const t=e.cid||`${e.path}`;if(!t)throw errCode(new Error("Unexpected input: Please path either a CID or an IPFS path"),"ERR_UNEXPECTED_INPUT");const r={path:t,recursive:e.recursive!==!1};return e.metadata!=null&&(r.metadata=e.metadata),r}const createAddAll$1=configure(e=>{async function*t(r,n={}){for await(const{path:o,recursive:s,metadata:i}of normaliseInput$1(r)){const a=await e.post("pin/add",{signal:n.signal,searchParams:toUrlSearchParams({...n,arg:o,recursive:s,metadata:i?JSON.stringify(i):void 0,stream:!0}),headers:n.headers});for await(const d of a.ndjson()){if(d.Pins){for(const h of d.Pins)yield CID$1.parse(h);continue}yield CID$1.parse(d)}}}return t});function createAdd$3(e){const t=createAddAll$1(e);return configure(()=>{async function r(n,o={}){return last(t([{path:n,...o}],o))}return r})(e)}function toPin(e,t,r){const n={type:e,cid:CID$1.parse(t)};return r&&(n.metadata=r),n}const createLs$4=configure(e=>{async function*t(r={}){let n=[];r.paths&&(n=Array.isArray(r.paths)?r.paths:[r.paths]);const o=await e.post("pin/ls",{signal:r.signal,searchParams:toUrlSearchParams({...r,arg:n.map(s=>`${s}`),stream:!0}),headers:r.headers});for await(const s of o.ndjson()){if(s.Keys){for(const i of Object.keys(s.Keys))yield toPin(s.Keys[i].Type,i,s.Keys[i].Metadata);return}yield toPin(s.Type,s.Cid,s.Metadata)}}return t}),createRmAll$1=configure(e=>{async function*t(r,n={}){for await(const{path:o,recursive:s}of normaliseInput$1(r)){const i=new URLSearchParams(n.searchParams);i.append("arg",`${o}`),s!=null&&i.set("recursive",String(s));const a=await e.post("pin/rm",{signal:n.signal,headers:n.headers,searchParams:toUrlSearchParams({...n,arg:`${o}`,recursive:s})});for await(const d of a.ndjson()){if(d.Pins){yield*d.Pins.map(h=>CID$1.parse(h));continue}yield CID$1.parse(d)}}}return t}),createRm$2=e=>{const t=createRmAll$1(e);return configure(()=>{async function r(n,o={}){return last(t([{path:n,...o}],o))}return r})(e)},decodePin=({Name:e,Status:t,Cid:r})=>({cid:CID$1.parse(r),name:e,status:t}),encodeService=e=>{if(typeof e=="string"&&e!=="")return e;throw new TypeError("service name must be passed")},encodeCID=e=>{if(CID$1.asCID(e))return e.toString();throw new TypeError(`CID instance expected instead of ${typeof e}`)},encodeQuery=({service:e,cid:t,name:r,status:n,all:o})=>{const s=toUrlSearchParams({service:encodeService(e),name:r,force:o?!0:void 0});if(t)for(const i of t)s.append("cid",encodeCID(i));if(n)for(const i of n)s.append("status",i);return s},encodeAddParams=({cid:e,service:t,background:r,name:n,origins:o})=>{const s=toUrlSearchParams({arg:encodeCID(e),service:encodeService(t),name:n,background:r?!0:void 0});if(o)for(const i of o)s.append("origin",i.toString());return s};function createAdd$2(e){async function t(r,{timeout:n,signal:o,headers:s,...i}){const a=await e.post("pin/remote/add",{timeout:n,signal:o,headers:s,searchParams:encodeAddParams({cid:r,...i})});return decodePin(await a.json())}return t}function createLs$3(e){async function*t({timeout:r,signal:n,headers:o,...s}){const i=await e.post("pin/remote/ls",{timeout:r,signal:n,headers:o,searchParams:encodeQuery(s)});for await(const a of i.ndjson())yield decodePin(a)}return t}function createRm$1(e){async function t({timeout:r,signal:n,headers:o,...s}){await e.post("pin/remote/rm",{timeout:r,signal:n,headers:o,searchParams:encodeQuery({...s,all:!1})})}return t}function createRmAll(e){async function t({timeout:r,signal:n,headers:o,...s}){await e.post("pin/remote/rm",{timeout:r,signal:n,headers:o,searchParams:encodeQuery({...s,all:!0})})}return t}function encodeEndpoint(e){const t=String(e);if(t==="undefined")throw Error("endpoint is required");return t[t.length-1]==="/"?t.slice(0,-1):t}function decodeRemoteService(e){return{service:e.Service,endpoint:new URL(e.ApiEndpoint),...e.Stat&&{stat:decodeStat(e.Stat)}}}function decodeStat(e){switch(e.Status){case"valid":{const{Pinning:t,Pinned:r,Queued:n,Failed:o}=e.PinCount;return{status:"valid",pinCount:{queued:n,pinning:t,pinned:r,failed:o}}}case"invalid":return{status:"invalid"};default:return{status:e.Status}}}function createAdd$1(e){async function t(r,n){const{endpoint:o,key:s,headers:i,timeout:a,signal:d}=n;await e.post("pin/remote/service/add",{timeout:a,signal:d,searchParams:toUrlSearchParams({arg:[r,encodeEndpoint(o),s]}),headers:i})}return t}function createLs$2(e){async function t(r={}){const{stat:n,headers:o,timeout:s,signal:i}=r,a=await e.post("pin/remote/service/ls",{timeout:s,signal:i,headers:o,searchParams:n===!0?toUrlSearchParams({stat:n}):void 0}),{RemoteServices:d}=await a.json();return d.map(decodeRemoteService)}return t}function createRm(e){async function t(r,n={}){await e.post("pin/remote/service/rm",{signal:n.signal,headers:n.headers,searchParams:toUrlSearchParams({arg:r})})}return t}function createService(e){const t=new Client(e);return{add:createAdd$1(t),ls:createLs$2(t),rm:createRm(t)}}function createRemote(e){const t=new Client(e);return{add:createAdd$2(t),ls:createLs$3(t),rm:createRm$1(t),rmAll:createRmAll(t),service:createService(e)}}function createPin(e){return{addAll:createAddAll$1(e),add:createAdd$3(e),ls:createLs$4(e),rmAll:createRmAll$1(e),rm:createRm$2(e),remote:createRemote(e)}}const rpcArrayToTextArray=e=>Array.isArray(e)?e.map(rpcToText):e,rpcToText=e=>toString$4(rpcToBytes(e)),rpcToBytes=e=>base64url$2.decode(e),rpcToBigInt=e=>BigInt(`0x${toString$4(base64url$2.decode(e),"base16")}`),textToUrlSafeRpc=e=>base64url$2.encode(fromString$4(e)),createLs$1=configure(e=>{async function t(r={}){const{Strings:n}=await(await e.post("pubsub/ls",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json();return rpcArrayToTextArray(n)||[]}return t}),createPeers$1=configure(e=>{async function t(r,n={}){const o=await e.post("pubsub/peers",{signal:n.signal,searchParams:toUrlSearchParams({arg:textToUrlSafeRpc(r),...n}),headers:n.headers}),{Strings:s}=await o.json();return s||[]}return t}),createPublish=configure(e=>{async function t(r,n,o={}){const s=toUrlSearchParams({arg:textToUrlSafeRpc(r),...o}),i=new AbortController,a=abortSignal(i.signal,o.signal);await(await e.post("pubsub/pub",{signal:a,searchParams:s,...await multipartRequest([n],i,o.headers)})).text()}return t}),log=logger("ipfs-http-client:pubsub:subscribe"),createSubscribe=(e,t)=>configure(r=>{async function n(o,s,i={}){i.signal=t.subscribe(o,s,i.signal);let a,d;const h=new Promise((y,g)=>{a=y,d=g}),b=setTimeout(()=>a(),1e3);return r.post("pubsub/sub",{signal:i.signal,searchParams:toUrlSearchParams({arg:textToUrlSafeRpc(o),...i}),headers:i.headers}).catch(y=>{t.unsubscribe(o,s),d(y)}).then(y=>{clearTimeout(b),y&&(readMessages(y,{onMessage:g=>{if(s){if(typeof s=="function"){s(g);return}typeof s.handleEvent=="function"&&s.handleEvent(g)}},onEnd:()=>t.unsubscribe(o,s),onError:i.onError}),a())}),h}return n})(e);async function readMessages(e,{onMessage:t,onEnd:r,onError:n}){n=n||log;try{for await(const o of e.ndjson())try{if(!o.from)continue;o.from!=null&&o.seqno!=null?t({type:"signed",from:peerIdFromString(o.from),data:rpcToBytes(o.data),sequenceNumber:rpcToBigInt(o.seqno),topic:rpcToText(o.topicIDs[0]),key:rpcToBytes(o.key??"u"),signature:rpcToBytes(o.signature??"u")}):t({type:"unsigned",data:rpcToBytes(o.data),topic:rpcToText(o.topicIDs[0])})}catch(s){s.message=`Failed to parse pubsub message: ${s.message}`,n(s,!1,o)}}catch(o){isAbortError(o)||n(o,!0)}finally{r()}}const isAbortError=e=>{switch(e.type){case"aborted":return!0;case"abort":return!0;default:return e.name==="AbortError"}},createUnsubscribe=(e,t)=>{async function r(n,o){t.unsubscribe(n,o)}return r};class SubscriptionTracker{constructor(){this._subs=new Map}subscribe(t,r,n){const o=this._subs.get(t)||[];if(o.find(i=>i.handler===r))throw new Error(`Already subscribed to ${t} with this handler`);const s=new AbortController;return this._subs.set(t,[{handler:r,controller:s}].concat(o)),n&&n.addEventListener("abort",()=>this.unsubscribe(t,r)),s.signal}unsubscribe(t,r){const n=this._subs.get(t)||[];let o;r?(this._subs.set(t,n.filter(s=>s.handler!==r)),o=n.filter(s=>s.handler===r)):(this._subs.set(t,[]),o=n),(this._subs.get(t)||[]).length||this._subs.delete(t),o.forEach(s=>s.controller.abort())}}function createPubsub(e){const t=new SubscriptionTracker;return{ls:createLs$1(e),peers:createPeers$1(e),publish:createPublish(e),subscribe:createSubscribe(e,t),unsubscribe:createUnsubscribe(e,t)}}const createLocal=configure(e=>{async function*t(r={}){yield*(await e.post("refs/local",{signal:r.signal,transform:objectToCamel,searchParams:toUrlSearchParams(r),headers:r.headers})).ndjson()}return t}),createRefs=configure((e,t)=>Object.assign(async function*(n,o={}){const s=Array.isArray(n)?n:[n];yield*(await e.post("refs",{signal:o.signal,searchParams:toUrlSearchParams({arg:s.map(a=>`${a instanceof Uint8Array?CID$1.decode(a):a}`),...o}),headers:o.headers,transform:objectToCamel})).ndjson()},{local:createLocal(t)})),createGc=configure(e=>{async function*t(r={}){yield*(await e.post("repo/gc",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers,transform:o=>({err:o.Error?new Error(o.Error):null,cid:(o.Key||{})["/"]?CID$1.parse(o.Key["/"]):null})})).ndjson()}return t}),createStat=configure(e=>{async function t(r={}){const o=await(await e.post("repo/stat",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json();return{numObjects:BigInt(o.NumObjects),repoSize:BigInt(o.RepoSize),repoPath:o.RepoPath,version:o.Version,storageMax:BigInt(o.StorageMax)}}return t}),createVersion$1=configure(e=>{async function t(r={}){return(await(await e.post("repo/version",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()).Version}return t});function createRepo(e){return{gc:createGc(e),stat:createStat(e),version:createVersion$1(e)}}const createBw=configure(e=>{async function*t(r={}){yield*(await e.post("stats/bw",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers,transform:o=>({totalIn:BigInt(o.TotalIn),totalOut:BigInt(o.TotalOut),rateIn:parseFloat(o.RateIn),rateOut:parseFloat(o.RateOut)})})).ndjson()}return t});function createStats(e){return{bitswap:createStat$4(e),repo:createStat(e),bw:createBw(e)}}const createAddrs=configure(e=>{async function t(r={}){const n=await e.post("swarm/addrs",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers}),{Addrs:o}=await n.json();return Object.keys(o).map(s=>({id:peerIdFromString(s),addrs:(o[s]||[]).map(i=>multiaddr$2(i))}))}return t}),createConnect=configure(e=>{async function t(r,n={}){const o=await e.post("swarm/connect",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers}),{Strings:s}=await o.json();return s||[]}return t}),createDisconnect=configure(e=>{async function t(r,n={}){const o=await e.post("swarm/disconnect",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers}),{Strings:s}=await o.json();return s||[]}return t}),createLocalAddrs=configure(e=>{async function t(r={}){const n=await e.post("swarm/addrs/local",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers}),{Strings:o}=await n.json();return(o||[]).map(s=>multiaddr$2(s))}return t}),createPeers=configure(e=>{async function t(r={}){const n=await e.post("swarm/peers",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers}),{Peers:o}=await n.json();return(o||[]).map(s=>({addr:multiaddr$2(s.Addr),peer:peerIdFromString(s.Peer),muxer:s.Muxer,latency:s.Latency,streams:s.Streams,direction:s.Direction==null?void 0:s.Direction===0?"inbound":"outbound"}))}return t});function createSwarm(e){return{addrs:createAddrs(e),connect:createConnect(e),disconnect:createDisconnect(e),localAddrs:createLocalAddrs(e),peers:createPeers(e)}}const createAddAll=configure(e=>{async function*t(r,n={}){const o=new AbortController,s=abortSignal(o.signal,n.signal),{headers:i,body:a,total:d,parts:h}=await multipartRequest(r,o,n.headers),[b,y]=typeof n.progress=="function"?createProgressHandler(d,h,n.progress):[void 0,void 0],g=await e.post("add",{searchParams:toUrlSearchParams({"stream-channels":!0,...n,progress:!!b}),onUploadProgress:y,signal:s,headers:i,body:a});for await(let p of g.ndjson())p=objectToCamel(p),p.hash!==void 0?yield toCoreInterface(p):b&&b(p.bytes||0,p.name)}return t}),createProgressHandler=(e,t,r)=>t?[void 0,createOnUploadProgress(e,t,r)]:[r,void 0],createOnUploadProgress=(e,t,r)=>{let n=0;const o=t.length;return({loaded:s,total:i})=>{const a=Math.floor(s/i*e);for(;n<o;){const{start:d,end:h,name:b}=t[n];if(a<h){r(a-d,b);break}else r(h-d,b),n+=1}}};function toCoreInterface({name:e,hash:t,size:r,mode:n,mtime:o,mtimeNsecs:s}){const i={path:e,cid:CID$1.parse(t),size:parseInt(r)};return n!=null&&(i.mode=parseInt(n,8)),o!=null&&(i.mtime={secs:o,nsecs:s||0}),i}function blobToIt(e){return typeof e.stream=="function"?browserReadableStreamToIt(e.stream()):browserReadableStreamToIt(new Response(e).body)}async function*toAsyncIterable(e){yield e}async function normaliseContent(e){if(isBytes(e))return toAsyncIterable(toBytes(e));if(typeof e=="string"||e instanceof String)return toAsyncIterable(toBytes(e.toString()));if(isBlob(e))return blobToIt(e);if(isReadableStream(e)&&(e=browserReadableStreamToIt(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const t=peekableIterator(e),{value:r,done:n}=await t.peek();if(n)return toAsyncIterable(new Uint8Array(0));if(t.push(r),Number.isInteger(r))return toAsyncIterable(Uint8Array.from(await all(t)));if(isBytes(r)||typeof r=="string"||r instanceof String)return map(t,toBytes)}throw errCode(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT")}function toBytes(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer?new Uint8Array(e):Array.isArray(e)?Uint8Array.from(e):fromString$4(e.toString())}async function*normaliseCandidateSingle(e,t){if(e==null)throw errCode(new Error(`Unexpected input: ${e}`),"ERR_UNEXPECTED_INPUT");if(typeof e=="string"||e instanceof String){yield toFileObject(e.toString(),t);return}if(isBytes(e)||isBlob(e)){yield toFileObject(e,t);return}if(isReadableStream(e)&&(e=browserReadableStreamToIt(e)),Symbol.iterator in e||Symbol.asyncIterator in e){const r=peekableIterator(e),{value:n,done:o}=await r.peek();if(o){yield{content:[]};return}if(r.push(n),Number.isInteger(n)||isBytes(n)||typeof n=="string"||n instanceof String){yield toFileObject(r,t);return}throw errCode(new Error("Unexpected input: multiple items passed - if you are using ipfs.add, please use ipfs.addAll instead"),"ERR_UNEXPECTED_INPUT")}if(isFileObject(e)){yield toFileObject(e,t);return}throw errCode(new Error('Unexpected input: cannot convert "'+typeof e+'" into ImportCandidate'),"ERR_UNEXPECTED_INPUT")}async function toFileObject(e,t){const{path:r,mode:n,mtime:o,content:s}=e,i={path:r||"",mode:parseMode(n),mtime:parseMtime(o)};return s?i.content=await t(s):r||(i.content=await t(e)),i}function normaliseInput(e){return normaliseCandidateSingle(e,normaliseContent)}function createAdd(e){const t=createAddAll(e);return configure(()=>{async function r(n,o={}){return await last(t(normaliseInput(n),o))}return r})(e)}const createCat=configure(e=>{async function*t(r,n={}){yield*(await e.post("cat",{signal:n.signal,searchParams:toUrlSearchParams({arg:r.toString(),...n}),headers:n.headers})).iterator()}return t}),createCommands=configure(e=>async(r={})=>(await e.post("commands",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).json()),createDns=configure(e=>async(r,n={})=>(await(await e.post("dns",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers})).json()).Path),createGetEndpointConfig=configure(e=>()=>{const t=new URL(e.opts.base||"");return{host:t.hostname,port:t.port,protocol:t.protocol,pathname:t.pathname,"api-path":t.pathname}}),createGet=configure(e=>{async function*t(r,n={}){const o={arg:`${r instanceof Uint8Array?CID$1.decode(r):r}`,...n};o.compressionLevel&&(o["compression-level"]=o.compressionLevel,delete o.compressionLevel),yield*(await e.post("get",{signal:n.signal,searchParams:toUrlSearchParams(o),headers:n.headers})).iterator()}return t}),createId=configure(e=>{async function t(r={}){const o=await(await e.post("id",{signal:r.signal,searchParams:toUrlSearchParams({arg:r.peerId?r.peerId.toString():void 0,...r}),headers:r.headers})).json(),s={...objectToCamel(o)};return s.id=peerIdFromString(s.id),s.addresses&&(s.addresses=s.addresses.map(i=>multiaddr$2(i))),s}return t}),createIsOnline=e=>{const t=createId(e);async function r(n={}){const o=await t(n);return!!(o&&o.addresses&&o.addresses.length)}return r},createLs=configure((e,t)=>{async function*r(n,o={}){const s=`${n instanceof Uint8Array?CID$1.decode(n):n}`;async function i(d){let h=d.Hash;if(h.includes("/")){const y=h.startsWith("/ipfs/")?h:`/ipfs/${h}`;h=(await createStat$2(t)(y)).cid}else h=CID$1.parse(h);const b={name:d.Name,path:s+(d.Name?`/${d.Name}`:""),size:d.Size,cid:h,type:typeOf(d)};return d.Mode&&(b.mode=parseInt(d.Mode,8)),d.Mtime!==void 0&&d.Mtime!==null&&(b.mtime={secs:d.Mtime},d.MtimeNsecs!==void 0&&d.MtimeNsecs!==null&&(b.mtime.nsecs=d.MtimeNsecs)),b}const a=await e.post("ls",{signal:o.signal,searchParams:toUrlSearchParams({arg:s,...o}),headers:o.headers});for await(let d of a.ndjson()){if(d=d.Objects,!d)throw new Error("expected .Objects in results");if(d=d[0],!d)throw new Error("expected one array in results.Objects");const h=d.Links;if(!Array.isArray(h))throw new Error("expected one array in results.Objects[0].Links");if(!h.length){yield i(d);return}yield*h.map(i)}}return r});function typeOf(e){switch(e.Type){case 1:case 5:return"dir";case 2:return"file";default:return"file"}}const createMount=configure(e=>{async function t(r={}){const n=await e.post("dns",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers});return objectToCamel(await n.json())}return t}),createPing=configure(e=>{async function*t(r,n={}){yield*(await e.post("ping",{signal:n.signal,searchParams:toUrlSearchParams({arg:`${r}`,...n}),headers:n.headers,transform:objectToCamel})).ndjson()}return t}),createResolve=configure(e=>{async function t(r,n={}){const o=await e.post("resolve",{signal:n.signal,searchParams:toUrlSearchParams({arg:r,...n}),headers:n.headers}),{Path:s}=await o.json();return s}return t}),createStart=configure(e=>async(r={})=>{throw errCode(new Error("Not implemented"),"ERR_NOT_IMPLEMENTED")}),createStop=configure(e=>{async function t(r={}){await(await e.post("shutdown",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers})).text()}return t}),createVersion=configure(e=>{async function t(r={}){const n=await e.post("version",{signal:r.signal,searchParams:toUrlSearchParams(r),headers:r.headers});return{...objectToCamel(await n.json()),"ipfs-http-client":"1.0.0"}}return t});var urlSource_1,hasRequiredUrlSource;function requireUrlSource(){if(hasRequiredUrlSource)return urlSource_1;hasRequiredUrlSource=1;const e=requireHttp(),t=(n,o)=>({path:decodeURIComponent(new URL(n).pathname.split("/").pop()||""),content:r(n,o)});async function*r(n,o){yield*(await new e().get(n,o)).iterator()}return urlSource_1=t,urlSource_1}requireUrlSource();function create(e={}){const t={name:identity$3.name,code:identity$3.code,encode:h=>h,decode:h=>h},r=Object.values(bases$2);(e.ipld&&e.ipld.bases?e.ipld.bases:[]).forEach(h=>r.push(h));const n=new Multibases({bases:r,loadBase:e.ipld&&e.ipld.loadBase}),o=Object.values(codecs$1);[dagPB,dagCBOR,dagJSON,dagJOSE,t].concat(e.ipld&&e.ipld.codecs||[]).forEach(h=>o.push(h));const s=new Multicodecs({codecs:o,loadCodec:e.ipld&&e.ipld.loadCodec}),i=Object.values(hashes);(e.ipld&&e.ipld.hashers?e.ipld.hashers:[]).forEach(h=>i.push(h));const a=new Multihashes({hashers:i,loadHasher:e.ipld&&e.ipld.loadHasher});return{add:createAdd(e),addAll:createAddAll(e),bitswap:createBitswap(e),block:createBlock(e),bootstrap:createBootstrap(e),cat:createCat(e),commands:createCommands(e),config:createConfig(e),dag:createDag(s,e),dht:createDht(e),diag:createDiag(e),dns:createDns(e),files:createFiles(e),get:createGet(e),getEndpointConfig:createGetEndpointConfig(e),id:createId(e),isOnline:createIsOnline(e),key:createKey(e),log:createLog(e),ls:createLs(e),mount:createMount(e),name:createName(e),object:createObject(s,e),pin:createPin(e),ping:createPing(e),pubsub:createPubsub(e),refs:createRefs(e),repo:createRepo(e),resolve:createResolve(e),start:createStart(e),stats:createStats(e),stop:createStop(e),swarm:createSwarm(e),version:createVersion(e),bases:n,codecs:s,hashers:a}}var buffer={},base64Js={},hasRequiredBase64Js;function requireBase64Js(){if(hasRequiredBase64Js)return base64Js;hasRequiredBase64Js=1,base64Js.byteLength=a,base64Js.toByteArray=h,base64Js.fromByteArray=g;for(var e=[],t=[],r=typeof Uint8Array<"u"?Uint8Array:Array,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,s=n.length;o<s;++o)e[o]=n[o],t[n.charCodeAt(o)]=o;t[45]=62,t[95]=63;function i(p){var l=p.length;if(l%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var w=p.indexOf("=");w===-1&&(w=l);var S=w===l?0:4-w%4;return[w,S]}function a(p){var l=i(p),w=l[0],S=l[1];return(w+S)*3/4-S}function d(p,l,w){return(l+w)*3/4-w}function h(p){var l,w=i(p),S=w[0],$=w[1],v=new r(d(p,S,$)),C=0,A=$>0?S-4:S,x;for(x=0;x<A;x+=4)l=t[p.charCodeAt(x)]<<18|t[p.charCodeAt(x+1)]<<12|t[p.charCodeAt(x+2)]<<6|t[p.charCodeAt(x+3)],v[C++]=l>>16&255,v[C++]=l>>8&255,v[C++]=l&255;return $===2&&(l=t[p.charCodeAt(x)]<<2|t[p.charCodeAt(x+1)]>>4,v[C++]=l&255),$===1&&(l=t[p.charCodeAt(x)]<<10|t[p.charCodeAt(x+1)]<<4|t[p.charCodeAt(x+2)]>>2,v[C++]=l>>8&255,v[C++]=l&255),v}function b(p){return e[p>>18&63]+e[p>>12&63]+e[p>>6&63]+e[p&63]}function y(p,l,w){for(var S,$=[],v=l;v<w;v+=3)S=(p[v]<<16&16711680)+(p[v+1]<<8&65280)+(p[v+2]&255),$.push(b(S));return $.join("")}function g(p){for(var l,w=p.length,S=w%3,$=[],v=16383,C=0,A=w-S;C<A;C+=v)$.push(y(p,C,C+v>A?A:C+v));return S===1?(l=p[w-1],$.push(e[l>>2]+e[l<<4&63]+"==")):S===2&&(l=(p[w-2]<<8)+p[w-1],$.push(e[l>>10]+e[l>>4&63]+e[l<<2&63]+"=")),$.join("")}return base64Js}var ieee754={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var hasRequiredIeee754;function requireIeee754(){return hasRequiredIeee754||(hasRequiredIeee754=1,ieee754.read=function(e,t,r,n,o){var s,i,a=o*8-n-1,d=(1<<a)-1,h=d>>1,b=-7,y=r?o-1:0,g=r?-1:1,p=e[t+y];for(y+=g,s=p&(1<<-b)-1,p>>=-b,b+=a;b>0;s=s*256+e[t+y],y+=g,b-=8);for(i=s&(1<<-b)-1,s>>=-b,b+=n;b>0;i=i*256+e[t+y],y+=g,b-=8);if(s===0)s=1-h;else{if(s===d)return i?NaN:(p?-1:1)*(1/0);i=i+Math.pow(2,n),s=s-h}return(p?-1:1)*i*Math.pow(2,s-n)},ieee754.write=function(e,t,r,n,o,s){var i,a,d,h=s*8-o-1,b=(1<<h)-1,y=b>>1,g=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:s-1,l=n?1:-1,w=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,i=b):(i=Math.floor(Math.log(t)/Math.LN2),t*(d=Math.pow(2,-i))<1&&(i--,d*=2),i+y>=1?t+=g/d:t+=g*Math.pow(2,1-y),t*d>=2&&(i++,d/=2),i+y>=b?(a=0,i=b):i+y>=1?(a=(t*d-1)*Math.pow(2,o),i=i+y):(a=t*Math.pow(2,y-1)*Math.pow(2,o),i=0));o>=8;e[r+p]=a&255,p+=l,a/=256,o-=8);for(i=i<<o|a,h+=o;h>0;e[r+p]=i&255,p+=l,i/=256,h-=8);e[r+p-l]|=w*128}),ieee754}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var hasRequiredBuffer;function requireBuffer(){return hasRequiredBuffer||(hasRequiredBuffer=1,(function(e){const t=requireBase64Js(),r=requireIeee754(),n=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=v,e.INSPECT_MAX_BYTES=50;const o=2147483647;e.kMaxLength=o,a.TYPED_ARRAY_SUPPORT=s(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const f=new Uint8Array(1),c={foo:function(){return 42}};return Object.setPrototypeOf(c,Uint8Array.prototype),Object.setPrototypeOf(f,c),f.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function i(f){if(f>o)throw new RangeError('The value "'+f+'" is invalid for option "size"');const c=new Uint8Array(f);return Object.setPrototypeOf(c,a.prototype),c}function a(f,c,u){if(typeof f=="number"){if(typeof c=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(f)}return d(f,c,u)}a.poolSize=8192;function d(f,c,u){if(typeof f=="string")return g(f,c);if(ArrayBuffer.isView(f))return l(f);if(f==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f);if(J(f,ArrayBuffer)||f&&J(f.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(J(f,SharedArrayBuffer)||f&&J(f.buffer,SharedArrayBuffer)))return w(f,c,u);if(typeof f=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const m=f.valueOf&&f.valueOf();if(m!=null&&m!==f)return a.from(m,c,u);const E=S(f);if(E)return E;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof f[Symbol.toPrimitive]=="function")return a.from(f[Symbol.toPrimitive]("string"),c,u);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof f)}a.from=function(f,c,u){return d(f,c,u)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function h(f){if(typeof f!="number")throw new TypeError('"size" argument must be of type number');if(f<0)throw new RangeError('The value "'+f+'" is invalid for option "size"')}function b(f,c,u){return h(f),f<=0?i(f):c!==void 0?typeof u=="string"?i(f).fill(c,u):i(f).fill(c):i(f)}a.alloc=function(f,c,u){return b(f,c,u)};function y(f){return h(f),i(f<0?0:$(f)|0)}a.allocUnsafe=function(f){return y(f)},a.allocUnsafeSlow=function(f){return y(f)};function g(f,c){if((typeof c!="string"||c==="")&&(c="utf8"),!a.isEncoding(c))throw new TypeError("Unknown encoding: "+c);const u=C(f,c)|0;let m=i(u);const E=m.write(f,c);return E!==u&&(m=m.slice(0,E)),m}function p(f){const c=f.length<0?0:$(f.length)|0,u=i(c);for(let m=0;m<c;m+=1)u[m]=f[m]&255;return u}function l(f){if(J(f,Uint8Array)){const c=new Uint8Array(f);return w(c.buffer,c.byteOffset,c.byteLength)}return p(f)}function w(f,c,u){if(c<0||f.byteLength<c)throw new RangeError('"offset" is outside of buffer bounds');if(f.byteLength<c+(u||0))throw new RangeError('"length" is outside of buffer bounds');let m;return c===void 0&&u===void 0?m=new Uint8Array(f):u===void 0?m=new Uint8Array(f,c):m=new Uint8Array(f,c,u),Object.setPrototypeOf(m,a.prototype),m}function S(f){if(a.isBuffer(f)){const c=$(f.length)|0,u=i(c);return u.length===0||f.copy(u,0,0,c),u}if(f.length!==void 0)return typeof f.length!="number"||ce(f.length)?i(0):p(f);if(f.type==="Buffer"&&Array.isArray(f.data))return p(f.data)}function $(f){if(f>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return f|0}function v(f){return+f!=f&&(f=0),a.alloc(+f)}a.isBuffer=function(c){return c!=null&&c._isBuffer===!0&&c!==a.prototype},a.compare=function(c,u){if(J(c,Uint8Array)&&(c=a.from(c,c.offset,c.byteLength)),J(u,Uint8Array)&&(u=a.from(u,u.offset,u.byteLength)),!a.isBuffer(c)||!a.isBuffer(u))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(c===u)return 0;let m=c.length,E=u.length;for(let T=0,P=Math.min(m,E);T<P;++T)if(c[T]!==u[T]){m=c[T],E=u[T];break}return m<E?-1:E<m?1:0},a.isEncoding=function(c){switch(String(c).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(c,u){if(!Array.isArray(c))throw new TypeError('"list" argument must be an Array of Buffers');if(c.length===0)return a.alloc(0);let m;if(u===void 0)for(u=0,m=0;m<c.length;++m)u+=c[m].length;const E=a.allocUnsafe(u);let T=0;for(m=0;m<c.length;++m){let P=c[m];if(J(P,Uint8Array))T+P.length>E.length?(a.isBuffer(P)||(P=a.from(P)),P.copy(E,T)):Uint8Array.prototype.set.call(E,P,T);else if(a.isBuffer(P))P.copy(E,T);else throw new TypeError('"list" argument must be an Array of Buffers');T+=P.length}return E};function C(f,c){if(a.isBuffer(f))return f.length;if(ArrayBuffer.isView(f)||J(f,ArrayBuffer))return f.byteLength;if(typeof f!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof f);const u=f.length,m=arguments.length>2&&arguments[2]===!0;if(!m&&u===0)return 0;let E=!1;for(;;)switch(c){case"ascii":case"latin1":case"binary":return u;case"utf8":case"utf-8":return ae(f).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u*2;case"hex":return u>>>1;case"base64":return me(f).length;default:if(E)return m?-1:ae(f).length;c=(""+c).toLowerCase(),E=!0}}a.byteLength=C;function A(f,c,u){let m=!1;if((c===void 0||c<0)&&(c=0),c>this.length||((u===void 0||u>this.length)&&(u=this.length),u<=0)||(u>>>=0,c>>>=0,u<=c))return"";for(f||(f="utf8");;)switch(f){case"hex":return be(this,c,u);case"utf8":case"utf-8":return K(this,c,u);case"ascii":return oe(this,c,u);case"latin1":case"binary":return ge(this,c,u);case"base64":return Z(this,c,u);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return we(this,c,u);default:if(m)throw new TypeError("Unknown encoding: "+f);f=(f+"").toLowerCase(),m=!0}}a.prototype._isBuffer=!0;function x(f,c,u){const m=f[c];f[c]=f[u],f[u]=m}a.prototype.swap16=function(){const c=this.length;if(c%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let u=0;u<c;u+=2)x(this,u,u+1);return this},a.prototype.swap32=function(){const c=this.length;if(c%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let u=0;u<c;u+=4)x(this,u,u+3),x(this,u+1,u+2);return this},a.prototype.swap64=function(){const c=this.length;if(c%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let u=0;u<c;u+=8)x(this,u,u+7),x(this,u+1,u+6),x(this,u+2,u+5),x(this,u+3,u+4);return this},a.prototype.toString=function(){const c=this.length;return c===0?"":arguments.length===0?K(this,0,c):A.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(c){if(!a.isBuffer(c))throw new TypeError("Argument must be a Buffer");return this===c?!0:a.compare(this,c)===0},a.prototype.inspect=function(){let c="";const u=e.INSPECT_MAX_BYTES;return c=this.toString("hex",0,u).replace(/(.{2})/g,"$1 ").trim(),this.length>u&&(c+=" ... "),"<Buffer "+c+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(c,u,m,E,T){if(J(c,Uint8Array)&&(c=a.from(c,c.offset,c.byteLength)),!a.isBuffer(c))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof c);if(u===void 0&&(u=0),m===void 0&&(m=c?c.length:0),E===void 0&&(E=0),T===void 0&&(T=this.length),u<0||m>c.length||E<0||T>this.length)throw new RangeError("out of range index");if(E>=T&&u>=m)return 0;if(E>=T)return-1;if(u>=m)return 1;if(u>>>=0,m>>>=0,E>>>=0,T>>>=0,this===c)return 0;let P=T-E,U=m-u;const O=Math.min(P,U),N=this.slice(E,T),R=c.slice(u,m);for(let k=0;k<O;++k)if(N[k]!==R[k]){P=N[k],U=R[k];break}return P<U?-1:U<P?1:0};function _(f,c,u,m,E){if(f.length===0)return-1;if(typeof u=="string"?(m=u,u=0):u>2147483647?u=2147483647:u<-2147483648&&(u=-2147483648),u=+u,ce(u)&&(u=E?0:f.length-1),u<0&&(u=f.length+u),u>=f.length){if(E)return-1;u=f.length-1}else if(u<0)if(E)u=0;else return-1;if(typeof c=="string"&&(c=a.from(c,m)),a.isBuffer(c))return c.length===0?-1:B(f,c,u,m,E);if(typeof c=="number")return c=c&255,typeof Uint8Array.prototype.indexOf=="function"?E?Uint8Array.prototype.indexOf.call(f,c,u):Uint8Array.prototype.lastIndexOf.call(f,c,u):B(f,[c],u,m,E);throw new TypeError("val must be string, number or Buffer")}function B(f,c,u,m,E){let T=1,P=f.length,U=c.length;if(m!==void 0&&(m=String(m).toLowerCase(),m==="ucs2"||m==="ucs-2"||m==="utf16le"||m==="utf-16le")){if(f.length<2||c.length<2)return-1;T=2,P/=2,U/=2,u/=2}function O(R,k){return T===1?R[k]:R.readUInt16BE(k*T)}let N;if(E){let R=-1;for(N=u;N<P;N++)if(O(f,N)===O(c,R===-1?0:N-R)){if(R===-1&&(R=N),N-R+1===U)return R*T}else R!==-1&&(N-=N-R),R=-1}else for(u+U>P&&(u=P-U),N=u;N>=0;N--){let R=!0;for(let k=0;k<U;k++)if(O(f,N+k)!==O(c,k)){R=!1;break}if(R)return N}return-1}a.prototype.includes=function(c,u,m){return this.indexOf(c,u,m)!==-1},a.prototype.indexOf=function(c,u,m){return _(this,c,u,m,!0)},a.prototype.lastIndexOf=function(c,u,m){return _(this,c,u,m,!1)};function I(f,c,u,m){u=Number(u)||0;const E=f.length-u;m?(m=Number(m),m>E&&(m=E)):m=E;const T=c.length;m>T/2&&(m=T/2);let P;for(P=0;P<m;++P){const U=parseInt(c.substr(P*2,2),16);if(ce(U))return P;f[u+P]=U}return P}function D(f,c,u,m){return se(ae(c,f.length-u),f,u,m)}function F(f,c,u,m){return se(ve(c),f,u,m)}function M(f,c,u,m){return se(me(c),f,u,m)}function X(f,c,u,m){return se(Te(c,f.length-u),f,u,m)}a.prototype.write=function(c,u,m,E){if(u===void 0)E="utf8",m=this.length,u=0;else if(m===void 0&&typeof u=="string")E=u,m=this.length,u=0;else if(isFinite(u))u=u>>>0,isFinite(m)?(m=m>>>0,E===void 0&&(E="utf8")):(E=m,m=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const T=this.length-u;if((m===void 0||m>T)&&(m=T),c.length>0&&(m<0||u<0)||u>this.length)throw new RangeError("Attempt to write outside buffer bounds");E||(E="utf8");let P=!1;for(;;)switch(E){case"hex":return I(this,c,u,m);case"utf8":case"utf-8":return D(this,c,u,m);case"ascii":case"latin1":case"binary":return F(this,c,u,m);case"base64":return M(this,c,u,m);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,c,u,m);default:if(P)throw new TypeError("Unknown encoding: "+E);E=(""+E).toLowerCase(),P=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Z(f,c,u){return c===0&&u===f.length?t.fromByteArray(f):t.fromByteArray(f.slice(c,u))}function K(f,c,u){u=Math.min(f.length,u);const m=[];let E=c;for(;E<u;){const T=f[E];let P=null,U=T>239?4:T>223?3:T>191?2:1;if(E+U<=u){let O,N,R,k;switch(U){case 1:T<128&&(P=T);break;case 2:O=f[E+1],(O&192)===128&&(k=(T&31)<<6|O&63,k>127&&(P=k));break;case 3:O=f[E+1],N=f[E+2],(O&192)===128&&(N&192)===128&&(k=(T&15)<<12|(O&63)<<6|N&63,k>2047&&(k<55296||k>57343)&&(P=k));break;case 4:O=f[E+1],N=f[E+2],R=f[E+3],(O&192)===128&&(N&192)===128&&(R&192)===128&&(k=(T&15)<<18|(O&63)<<12|(N&63)<<6|R&63,k>65535&&k<1114112&&(P=k))}}P===null?(P=65533,U=1):P>65535&&(P-=65536,m.push(P>>>10&1023|55296),P=56320|P&1023),m.push(P),E+=U}return G(m)}const Q=4096;function G(f){const c=f.length;if(c<=Q)return String.fromCharCode.apply(String,f);let u="",m=0;for(;m<c;)u+=String.fromCharCode.apply(String,f.slice(m,m+=Q));return u}function oe(f,c,u){let m="";u=Math.min(f.length,u);for(let E=c;E<u;++E)m+=String.fromCharCode(f[E]&127);return m}function ge(f,c,u){let m="";u=Math.min(f.length,u);for(let E=c;E<u;++E)m+=String.fromCharCode(f[E]);return m}function be(f,c,u){const m=f.length;(!c||c<0)&&(c=0),(!u||u<0||u>m)&&(u=m);let E="";for(let T=c;T<u;++T)E+=xe[f[T]];return E}function we(f,c,u){const m=f.slice(c,u);let E="";for(let T=0;T<m.length-1;T+=2)E+=String.fromCharCode(m[T]+m[T+1]*256);return E}a.prototype.slice=function(c,u){const m=this.length;c=~~c,u=u===void 0?m:~~u,c<0?(c+=m,c<0&&(c=0)):c>m&&(c=m),u<0?(u+=m,u<0&&(u=0)):u>m&&(u=m),u<c&&(u=c);const E=this.subarray(c,u);return Object.setPrototypeOf(E,a.prototype),E};function j(f,c,u){if(f%1!==0||f<0)throw new RangeError("offset is not uint");if(f+c>u)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(c,u,m){c=c>>>0,u=u>>>0,m||j(c,u,this.length);let E=this[c],T=1,P=0;for(;++P<u&&(T*=256);)E+=this[c+P]*T;return E},a.prototype.readUintBE=a.prototype.readUIntBE=function(c,u,m){c=c>>>0,u=u>>>0,m||j(c,u,this.length);let E=this[c+--u],T=1;for(;u>0&&(T*=256);)E+=this[c+--u]*T;return E},a.prototype.readUint8=a.prototype.readUInt8=function(c,u){return c=c>>>0,u||j(c,1,this.length),this[c]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(c,u){return c=c>>>0,u||j(c,2,this.length),this[c]|this[c+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(c,u){return c=c>>>0,u||j(c,2,this.length),this[c]<<8|this[c+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(c,u){return c=c>>>0,u||j(c,4,this.length),(this[c]|this[c+1]<<8|this[c+2]<<16)+this[c+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(c,u){return c=c>>>0,u||j(c,4,this.length),this[c]*16777216+(this[c+1]<<16|this[c+2]<<8|this[c+3])},a.prototype.readBigUInt64LE=Y(function(c){c=c>>>0,te(c,"offset");const u=this[c],m=this[c+7];(u===void 0||m===void 0)&&ne(c,this.length-8);const E=u+this[++c]*2**8+this[++c]*2**16+this[++c]*2**24,T=this[++c]+this[++c]*2**8+this[++c]*2**16+m*2**24;return BigInt(E)+(BigInt(T)<<BigInt(32))}),a.prototype.readBigUInt64BE=Y(function(c){c=c>>>0,te(c,"offset");const u=this[c],m=this[c+7];(u===void 0||m===void 0)&&ne(c,this.length-8);const E=u*2**24+this[++c]*2**16+this[++c]*2**8+this[++c],T=this[++c]*2**24+this[++c]*2**16+this[++c]*2**8+m;return(BigInt(E)<<BigInt(32))+BigInt(T)}),a.prototype.readIntLE=function(c,u,m){c=c>>>0,u=u>>>0,m||j(c,u,this.length);let E=this[c],T=1,P=0;for(;++P<u&&(T*=256);)E+=this[c+P]*T;return T*=128,E>=T&&(E-=Math.pow(2,8*u)),E},a.prototype.readIntBE=function(c,u,m){c=c>>>0,u=u>>>0,m||j(c,u,this.length);let E=u,T=1,P=this[c+--E];for(;E>0&&(T*=256);)P+=this[c+--E]*T;return T*=128,P>=T&&(P-=Math.pow(2,8*u)),P},a.prototype.readInt8=function(c,u){return c=c>>>0,u||j(c,1,this.length),this[c]&128?(255-this[c]+1)*-1:this[c]},a.prototype.readInt16LE=function(c,u){c=c>>>0,u||j(c,2,this.length);const m=this[c]|this[c+1]<<8;return m&32768?m|4294901760:m},a.prototype.readInt16BE=function(c,u){c=c>>>0,u||j(c,2,this.length);const m=this[c+1]|this[c]<<8;return m&32768?m|4294901760:m},a.prototype.readInt32LE=function(c,u){return c=c>>>0,u||j(c,4,this.length),this[c]|this[c+1]<<8|this[c+2]<<16|this[c+3]<<24},a.prototype.readInt32BE=function(c,u){return c=c>>>0,u||j(c,4,this.length),this[c]<<24|this[c+1]<<16|this[c+2]<<8|this[c+3]},a.prototype.readBigInt64LE=Y(function(c){c=c>>>0,te(c,"offset");const u=this[c],m=this[c+7];(u===void 0||m===void 0)&&ne(c,this.length-8);const E=this[c+4]+this[c+5]*2**8+this[c+6]*2**16+(m<<24);return(BigInt(E)<<BigInt(32))+BigInt(u+this[++c]*2**8+this[++c]*2**16+this[++c]*2**24)}),a.prototype.readBigInt64BE=Y(function(c){c=c>>>0,te(c,"offset");const u=this[c],m=this[c+7];(u===void 0||m===void 0)&&ne(c,this.length-8);const E=(u<<24)+this[++c]*2**16+this[++c]*2**8+this[++c];return(BigInt(E)<<BigInt(32))+BigInt(this[++c]*2**24+this[++c]*2**16+this[++c]*2**8+m)}),a.prototype.readFloatLE=function(c,u){return c=c>>>0,u||j(c,4,this.length),r.read(this,c,!0,23,4)},a.prototype.readFloatBE=function(c,u){return c=c>>>0,u||j(c,4,this.length),r.read(this,c,!1,23,4)},a.prototype.readDoubleLE=function(c,u){return c=c>>>0,u||j(c,8,this.length),r.read(this,c,!0,52,8)},a.prototype.readDoubleBE=function(c,u){return c=c>>>0,u||j(c,8,this.length),r.read(this,c,!1,52,8)};function W(f,c,u,m,E,T){if(!a.isBuffer(f))throw new TypeError('"buffer" argument must be a Buffer instance');if(c>E||c<T)throw new RangeError('"value" argument is out of bounds');if(u+m>f.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(c,u,m,E){if(c=+c,u=u>>>0,m=m>>>0,!E){const U=Math.pow(2,8*m)-1;W(this,c,u,m,U,0)}let T=1,P=0;for(this[u]=c&255;++P<m&&(T*=256);)this[u+P]=c/T&255;return u+m},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(c,u,m,E){if(c=+c,u=u>>>0,m=m>>>0,!E){const U=Math.pow(2,8*m)-1;W(this,c,u,m,U,0)}let T=m-1,P=1;for(this[u+T]=c&255;--T>=0&&(P*=256);)this[u+T]=c/P&255;return u+m},a.prototype.writeUint8=a.prototype.writeUInt8=function(c,u,m){return c=+c,u=u>>>0,m||W(this,c,u,1,255,0),this[u]=c&255,u+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(c,u,m){return c=+c,u=u>>>0,m||W(this,c,u,2,65535,0),this[u]=c&255,this[u+1]=c>>>8,u+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(c,u,m){return c=+c,u=u>>>0,m||W(this,c,u,2,65535,0),this[u]=c>>>8,this[u+1]=c&255,u+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(c,u,m){return c=+c,u=u>>>0,m||W(this,c,u,4,4294967295,0),this[u+3]=c>>>24,this[u+2]=c>>>16,this[u+1]=c>>>8,this[u]=c&255,u+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(c,u,m){return c=+c,u=u>>>0,m||W(this,c,u,4,4294967295,0),this[u]=c>>>24,this[u+1]=c>>>16,this[u+2]=c>>>8,this[u+3]=c&255,u+4};function ue(f,c,u,m,E){ye(c,m,E,f,u,7);let T=Number(c&BigInt(4294967295));f[u++]=T,T=T>>8,f[u++]=T,T=T>>8,f[u++]=T,T=T>>8,f[u++]=T;let P=Number(c>>BigInt(32)&BigInt(4294967295));return f[u++]=P,P=P>>8,f[u++]=P,P=P>>8,f[u++]=P,P=P>>8,f[u++]=P,u}function le(f,c,u,m,E){ye(c,m,E,f,u,7);let T=Number(c&BigInt(4294967295));f[u+7]=T,T=T>>8,f[u+6]=T,T=T>>8,f[u+5]=T,T=T>>8,f[u+4]=T;let P=Number(c>>BigInt(32)&BigInt(4294967295));return f[u+3]=P,P=P>>8,f[u+2]=P,P=P>>8,f[u+1]=P,P=P>>8,f[u]=P,u+8}a.prototype.writeBigUInt64LE=Y(function(c,u=0){return ue(this,c,u,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=Y(function(c,u=0){return le(this,c,u,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(c,u,m,E){if(c=+c,u=u>>>0,!E){const O=Math.pow(2,8*m-1);W(this,c,u,m,O-1,-O)}let T=0,P=1,U=0;for(this[u]=c&255;++T<m&&(P*=256);)c<0&&U===0&&this[u+T-1]!==0&&(U=1),this[u+T]=(c/P>>0)-U&255;return u+m},a.prototype.writeIntBE=function(c,u,m,E){if(c=+c,u=u>>>0,!E){const O=Math.pow(2,8*m-1);W(this,c,u,m,O-1,-O)}let T=m-1,P=1,U=0;for(this[u+T]=c&255;--T>=0&&(P*=256);)c<0&&U===0&&this[u+T+1]!==0&&(U=1),this[u+T]=(c/P>>0)-U&255;return u+m},a.prototype.writeInt8=function(c,u,m){return c=+c,u=u>>>0,m||W(this,c,u,1,127,-128),c<0&&(c=255+c+1),this[u]=c&255,u+1},a.prototype.writeInt16LE=function(c,u,m){return c=+c,u=u>>>0,m||W(this,c,u,2,32767,-32768),this[u]=c&255,this[u+1]=c>>>8,u+2},a.prototype.writeInt16BE=function(c,u,m){return c=+c,u=u>>>0,m||W(this,c,u,2,32767,-32768),this[u]=c>>>8,this[u+1]=c&255,u+2},a.prototype.writeInt32LE=function(c,u,m){return c=+c,u=u>>>0,m||W(this,c,u,4,2147483647,-2147483648),this[u]=c&255,this[u+1]=c>>>8,this[u+2]=c>>>16,this[u+3]=c>>>24,u+4},a.prototype.writeInt32BE=function(c,u,m){return c=+c,u=u>>>0,m||W(this,c,u,4,2147483647,-2147483648),c<0&&(c=4294967295+c+1),this[u]=c>>>24,this[u+1]=c>>>16,this[u+2]=c>>>8,this[u+3]=c&255,u+4},a.prototype.writeBigInt64LE=Y(function(c,u=0){return ue(this,c,u,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=Y(function(c,u=0){return le(this,c,u,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function de(f,c,u,m,E,T){if(u+m>f.length)throw new RangeError("Index out of range");if(u<0)throw new RangeError("Index out of range")}function fe(f,c,u,m,E){return c=+c,u=u>>>0,E||de(f,c,u,4),r.write(f,c,u,m,23,4),u+4}a.prototype.writeFloatLE=function(c,u,m){return fe(this,c,u,!0,m)},a.prototype.writeFloatBE=function(c,u,m){return fe(this,c,u,!1,m)};function he(f,c,u,m,E){return c=+c,u=u>>>0,E||de(f,c,u,8),r.write(f,c,u,m,52,8),u+8}a.prototype.writeDoubleLE=function(c,u,m){return he(this,c,u,!0,m)},a.prototype.writeDoubleBE=function(c,u,m){return he(this,c,u,!1,m)},a.prototype.copy=function(c,u,m,E){if(!a.isBuffer(c))throw new TypeError("argument should be a Buffer");if(m||(m=0),!E&&E!==0&&(E=this.length),u>=c.length&&(u=c.length),u||(u=0),E>0&&E<m&&(E=m),E===m||c.length===0||this.length===0)return 0;if(u<0)throw new RangeError("targetStart out of bounds");if(m<0||m>=this.length)throw new RangeError("Index out of range");if(E<0)throw new RangeError("sourceEnd out of bounds");E>this.length&&(E=this.length),c.length-u<E-m&&(E=c.length-u+m);const T=E-m;return this===c&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(u,m,E):Uint8Array.prototype.set.call(c,this.subarray(m,E),u),T},a.prototype.fill=function(c,u,m,E){if(typeof c=="string"){if(typeof u=="string"?(E=u,u=0,m=this.length):typeof m=="string"&&(E=m,m=this.length),E!==void 0&&typeof E!="string")throw new TypeError("encoding must be a string");if(typeof E=="string"&&!a.isEncoding(E))throw new TypeError("Unknown encoding: "+E);if(c.length===1){const P=c.charCodeAt(0);(E==="utf8"&&P<128||E==="latin1")&&(c=P)}}else typeof c=="number"?c=c&255:typeof c=="boolean"&&(c=Number(c));if(u<0||this.length<u||this.length<m)throw new RangeError("Out of range index");if(m<=u)return this;u=u>>>0,m=m===void 0?this.length:m>>>0,c||(c=0);let T;if(typeof c=="number")for(T=u;T<m;++T)this[T]=c;else{const P=a.isBuffer(c)?c:a.from(c,E),U=P.length;if(U===0)throw new TypeError('The value "'+c+'" is invalid for argument "value"');for(T=0;T<m-u;++T)this[T+u]=P[T%U]}return this};const ee={};function ie(f,c,u){ee[f]=class extends u{constructor(){super(),Object.defineProperty(this,"message",{value:c.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${f}]`,this.stack,delete this.name}get code(){return f}set code(E){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:E,writable:!0})}toString(){return`${this.name} [${f}]: ${this.message}`}}}ie("ERR_BUFFER_OUT_OF_BOUNDS",function(f){return f?`${f} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),ie("ERR_INVALID_ARG_TYPE",function(f,c){return`The "${f}" argument must be of type number. Received type ${typeof c}`},TypeError),ie("ERR_OUT_OF_RANGE",function(f,c,u){let m=`The value of "${f}" is out of range.`,E=u;return Number.isInteger(u)&&Math.abs(u)>2**32?E=pe(String(u)):typeof u=="bigint"&&(E=String(u),(u>BigInt(2)**BigInt(32)||u<-(BigInt(2)**BigInt(32)))&&(E=pe(E)),E+="n"),m+=` It must be ${c}. Received ${E}`,m},RangeError);function pe(f){let c="",u=f.length;const m=f[0]==="-"?1:0;for(;u>=m+4;u-=3)c=`_${f.slice(u-3,u)}${c}`;return`${f.slice(0,u)}${c}`}function $e(f,c,u){te(c,"offset"),(f[c]===void 0||f[c+u]===void 0)&&ne(c,f.length-(u+1))}function ye(f,c,u,m,E,T){if(f>u||f<c){const P=typeof c=="bigint"?"n":"";let U;throw c===0||c===BigInt(0)?U=`>= 0${P} and < 2${P} ** ${(T+1)*8}${P}`:U=`>= -(2${P} ** ${(T+1)*8-1}${P}) and < 2 ** ${(T+1)*8-1}${P}`,new ee.ERR_OUT_OF_RANGE("value",U,f)}$e(m,E,T)}function te(f,c){if(typeof f!="number")throw new ee.ERR_INVALID_ARG_TYPE(c,"number",f)}function ne(f,c,u){throw Math.floor(f)!==f?(te(f,u),new ee.ERR_OUT_OF_RANGE("offset","an integer",f)):c<0?new ee.ERR_BUFFER_OUT_OF_BOUNDS:new ee.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${c}`,f)}const Ee=/[^+/0-9A-Za-z-_]/g;function Se(f){if(f=f.split("=")[0],f=f.trim().replace(Ee,""),f.length<2)return"";for(;f.length%4!==0;)f=f+"=";return f}function ae(f,c){c=c||1/0;let u;const m=f.length;let E=null;const T=[];for(let P=0;P<m;++P){if(u=f.charCodeAt(P),u>55295&&u<57344){if(!E){if(u>56319){(c-=3)>-1&&T.push(239,191,189);continue}else if(P+1===m){(c-=3)>-1&&T.push(239,191,189);continue}E=u;continue}if(u<56320){(c-=3)>-1&&T.push(239,191,189),E=u;continue}u=(E-55296<<10|u-56320)+65536}else E&&(c-=3)>-1&&T.push(239,191,189);if(E=null,u<128){if((c-=1)<0)break;T.push(u)}else if(u<2048){if((c-=2)<0)break;T.push(u>>6|192,u&63|128)}else if(u<65536){if((c-=3)<0)break;T.push(u>>12|224,u>>6&63|128,u&63|128)}else if(u<1114112){if((c-=4)<0)break;T.push(u>>18|240,u>>12&63|128,u>>6&63|128,u&63|128)}else throw new Error("Invalid code point")}return T}function ve(f){const c=[];for(let u=0;u<f.length;++u)c.push(f.charCodeAt(u)&255);return c}function Te(f,c){let u,m,E;const T=[];for(let P=0;P<f.length&&!((c-=2)<0);++P)u=f.charCodeAt(P),m=u>>8,E=u%256,T.push(E),T.push(m);return T}function me(f){return t.toByteArray(Se(f))}function se(f,c,u,m){let E;for(E=0;E<m&&!(E+u>=c.length||E>=f.length);++E)c[E+u]=f[E];return E}function J(f,c){return f instanceof c||f!=null&&f.constructor!=null&&f.constructor.name!=null&&f.constructor.name===c.name}function ce(f){return f!==f}const xe=(function(){const f="0123456789abcdef",c=new Array(256);for(let u=0;u<16;++u){const m=u*16;for(let E=0;E<16;++E)c[m+E]=f[u]+f[E]}return c})();function Y(f){return typeof BigInt>"u"?_e:f}function _e(){throw new Error("BigInt not supported")}})(buffer)),buffer}var bufferExports=requireBuffer();const readFile=e=>new Promise(t=>{let r=new FileReader;r.readAsArrayBuffer(e),r.onload=n=>{t(bufferExports.Buffer.from(n.target.result))}}),upImage=async(e,t)=>{{const r=create({host:"ipfs.ilark.io",port:"9001",protocol:"https"}),n="https://ipfs.ilark.io/ipfs/";let o=await readFile(t),s=await r.add(o);return n+s.path}},_hoisted_1$2={class:"item"},_hoisted_2$2={class:"child"},_hoisted_3$2={class:"author"},_hoisted_4$1={key:0},_hoisted_5$1={key:0},_hoisted_6$1={key:0},_hoisted_7$1={id:"main"},_hoisted_8$1={key:1},_hoisted_9$1={key:1},_hoisted_10$1={id:"main2"},_hoisted_11$1={key:2,class:"child"},_sfc_main$2={__name:"Allreplylist",props:{parentmsg:{type:Object}},setup(e){let{message:t}=createDiscreteApi(["message"]);const r=useCookie("user"),n=ref(!1),o=ref(!1),s=ref(),i=ref(),a=async(p,l)=>{let w=await upImage(p,l);i.value.$img2Url(p,w)},d=p=>{o.value=!0,p.children==0&&(p.child=[])},h=async(p,l,w)=>{o.value=!1;let S=r.value.wif,$=r.value.username,v=getPermlink(),C="",A=s.value,_={tags:["cn","cn-reader","miao"],dapp:"miao",format:"markdown"};if(A==""){t.error("",{duration:5e3});return}let B={parent_author:p,parent_permlink:l,title:C,author:$,permlink:v,body:A,created:new Date().toISOString().split(".")[0],json_metadata:JSON.stringify(_)};w.child.push(B);let I={wif:S,parentAuthor:p,parentPermlink:l,author:$,permlink:v,title:C,body:A,jsonMetadata:_};const{data:D,pending:F,error:M}=await postHttp("/hiveapi/posttohive",I);M.value?t.error(`
`+M.value,{duration:5e3}):t.success("",{duration:5e3}),s.value=""},b=p=>{n.value=!0,s.value=p.body},y=async p=>{n.value=!1,p.body=s.value;let l=r.value.wif,w=r.value.username,S=p.parent_author,$=p.parent_permlink,v=p.permlink,C=p.title,A=s.value,x=p.json_metadata,_={wif:l,parentAuthor:S,parentPermlink:$,author:w,permlink:v,title:C,body:A,jsonMetadata:x};const{data:B,pending:I,error:D}=await postHttp("/hiveapi/posttohive",_);D.value?t.error(`
`+D.value,{duration:5e3}):t.success("",{duration:5e3}),s.value=""},g=()=>{o.value=!1,n.value=!1,s.value=""};return(p,l)=>{const w=resolveComponent("mavon-editor"),S=__nuxt_component_1,$=_sfc_main$2;return openBlock(),createElementBlock("div",_hoisted_1$2,[createBaseVNode("span",_hoisted_2$2,[createBaseVNode("span",_hoisted_3$2,"@"+toDisplayString(e.parentmsg.author),1),l[7]||(l[7]=createTextVNode("  ",-1)),createVNode(w,{class:"replymd",modelValue:e.parentmsg.body,"onUpdate:modelValue":l[0]||(l[0]=v=>e.parentmsg.body=v),subfield:!1,defaultOpen:"preview",toolbarsFlag:!1,editable:!1,scrollStyle:!0,ishljs:!0},null,8,["modelValue"])]),unref(r)?(openBlock(),createElementBlock("div",_hoisted_4$1,[e.parentmsg.author==unref(r).username?(openBlock(),createElementBlock("div",_hoisted_5$1,[createVNode(unref(Button),{quaternary:"",onClick:l[1]||(l[1]=v=>b(e.parentmsg))},{default:withCtx(()=>l[8]||(l[8]=[createTextVNode("",-1)])),_:1,__:[8]}),unref(n)?(openBlock(),createElementBlock("div",_hoisted_6$1,[createVNode(S,null,{default:withCtx(()=>[createBaseVNode("div",_hoisted_7$1,[createVNode(w,{modelValue:unref(s),"onUpdate:modelValue":l[2]||(l[2]=v=>isRef(s)?s.value=v:null),ref_key:"md",ref:i,"m-y-3":"",onImgAdd:a},null,8,["modelValue"])])]),_:1}),createVNode(unref(Button),{quaternary:"","m-r-2":"",onClick:l[3]||(l[3]=v=>y(e.parentmsg))},{default:withCtx(()=>l[9]||(l[9]=[createTextVNode("",-1)])),_:1,__:[9]}),createVNode(unref(Button),{quaternary:"",onClick:g},{default:withCtx(()=>l[10]||(l[10]=[createTextVNode("",-1)])),_:1,__:[10]})])):createCommentVNode("",!0)])):(openBlock(),createElementBlock("div",_hoisted_8$1,[createVNode(unref(Button),{quaternary:"",onClick:l[4]||(l[4]=v=>d(e.parentmsg))},{default:withCtx(()=>l[11]||(l[11]=[createTextVNode("",-1)])),_:1,__:[11]})]))])):createCommentVNode("",!0),unref(o)?(openBlock(),createElementBlock("div",_hoisted_9$1,[createVNode(S,null,{default:withCtx(()=>[createBaseVNode("div",_hoisted_10$1,[createVNode(w,{modelValue:unref(s),"onUpdate:modelValue":l[5]||(l[5]=v=>isRef(s)?s.value=v:null),ref_key:"md",ref:i,"m-y-3":"",onImgAdd:a},null,8,["modelValue"])])]),_:1}),createVNode(unref(Button),{quaternary:"","m-r-2":"",onClick:l[6]||(l[6]=v=>h(e.parentmsg.author,e.parentmsg.permlink,e.parentmsg))},{default:withCtx(()=>l[12]||(l[12]=[createTextVNode("",-1)])),_:1,__:[12]}),createVNode(unref(Button),{quaternary:"",onClick:g},{default:withCtx(()=>l[13]||(l[13]=[createTextVNode("",-1)])),_:1,__:[13]})])):createCommentVNode("",!0),e.parentmsg.child?(openBlock(),createElementBlock("ul",_hoisted_11$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(e.parentmsg.child,(v,C)=>(openBlock(),createBlock$1($,{parentmsg:v,key:C},null,8,["parentmsg"]))),128))])):createCommentVNode("",!0)])}}},_hoisted_1$1={key:0},_hoisted_2$1=["src"],_hoisted_3$1={key:1,class:"reply"},_sfc_main$1={__name:"Allreplies",props:{otherreply:{type:Object,default:{}}},async setup(e){let t,r;const n=e,o=useRoute(),s=o.params.author,i=o.params.permlink;let a={author:s,permlink:i};const{data:d,pending:h}=([t,r]=withAsyncContext(()=>postHttp("/hiveapi/getallreplies",a)),t=await t,r(),t);return watch(n,()=>{d.value.result.push(n.otherreply)}),(b,y)=>{const g=_sfc_main$2;return openBlock(),createElementBlock(Fragment,null,[y[0]||(y[0]=createBaseVNode("h3",null,"",-1)),unref(h)?(openBlock(),createElementBlock("div",_hoisted_1$1,[createBaseVNode("img",{src:unref(loading),alt:"miao loading"},null,8,_hoisted_2$1)])):(openBlock(),createElementBlock("div",_hoisted_3$1,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(d).result,p=>(openBlock(),createElementBlock("div",null,[createVNode(g,{parentmsg:p},null,8,["parentmsg"])]))),256))]))],64)}}},_hoisted_1={subContainer:""},_hoisted_2={key:0},_hoisted_3={key:1},_hoisted_4={key:2},_hoisted_5={"text-size-2xl":"","text-center":"","m-t-10":""},_hoisted_6={"text-center":""},_hoisted_7={key:0,"text-center":""},_hoisted_8=["src"],_hoisted_9={key:1,flex:""},_hoisted_10={key:0,"m-t-4":"","m-b-3":"","m-r-4":""},_hoisted_11={"m-t-4":"","m-b-3":""},_hoisted_12={key:2},_hoisted_13={key:3},_sfc_main={__name:"[permlink]",async setup(e){let t,r,{message:n}=createDiscreteApi(["message"]);const o=useCookie("user"),s=useRoute(),i=s.params.author,a=s.params.permlink;let d=ref(!0);const h=ref(!1),b=ref(),y=ref(),g=ref(),{data:p,pending:l,error:w}=([t,r]=withAsyncContext(()=>getHttp("/hiveapi/miaos/@"+i+"/"+a)),t=await t,r(),t);p.value&&(d.value=!1),useHead({title:p?.value?.result.title});const S=()=>{navigateTo({path:"/edit/"+a})},$=()=>{h.value=!0},v=async(x,_)=>{let B=await upImage(x,_);b.value.$img2Url(x,B)},C=async()=>{h.value=!1;let x=o.value.username,_=o.value.wif,B="",I=y.value,D=getPermlink(),M={tags:["cn","miao"],dapp:"miao",format:"markdown"},X={wif:_,parentAuthor:i,parentPermlink:a,author:x,permlink:D,title:B,body:I,jsonMetadata:M};const{data:Z,pending:K,error:Q}=await postHttp("/hiveapi/posttohive",X);Q.value?n.error(`
`+Q.value,{duration:5e3}):n.success("",{duration:5e3});let G={parent_author:i,parent_permlink:a,title:B,author:x,permlink:D,body:I,created:new Date().toISOString().split(".")[0],json_metadata:JSON.stringify(M)};g.value=G,y.value=""},A=()=>{h.value=!1,y.value=""};return(x,_)=>{const B=_sfc_main$3,I=resolveComponent("mavon-editor"),D=__nuxt_component_1,F=_sfc_main$1;return openBlock(),createElementBlock("div",_hoisted_1,[unref(l)||unref(d)?(openBlock(),createElementBlock("div",_hoisted_2,[createVNode(B)])):unref(w)?(openBlock(),createElementBlock("div",_hoisted_3,"  "+toDisplayString(unref(w)),1)):(openBlock(),createElementBlock("div",_hoisted_4,[createVNode(D,null,{default:withCtx(()=>[createBaseVNode("div",_hoisted_5,toDisplayString(unref(p).result.title),1),createBaseVNode("p",_hoisted_6,"@"+toDisplayString(unref(p).result.author)+" "+toDisplayString(("formatTime"in x?x.formatTime:unref(formatTime))(unref(p).result.created)),1),createVNode(I,{"p-t-3":"",modelValue:unref(p).result.body,"onUpdate:modelValue":_[0]||(_[0]=M=>unref(p).result.body=M),subfield:!1,defaultOpen:"preview",toolbarsFlag:!1,editable:!1,scrollStyle:!0,ishljs:!0},null,8,["modelValue"]),_[2]||(_[2]=createBaseVNode("br",null,null,-1)),createTextVNode(" tags: "+toDisplayString(unref(p).result.tags.join("")),1)]),_:1,__:[2]}),_[7]||(_[7]=createBaseVNode("br",null,null,-1)),unref(d)?(openBlock(),createElementBlock("div",_hoisted_7,[createBaseVNode("img",{src:unref(loading),alt:"miao loading"},null,8,_hoisted_8)])):createCommentVNode("",!0),unref(o)?(openBlock(),createElementBlock("div",_hoisted_9,[unref(o).username==unref(i)?(openBlock(),createElementBlock("div",_hoisted_10,[createVNode(unref(Button),{"w-15":"",onClick:S},{default:withCtx(()=>_[3]||(_[3]=[createTextVNode("",-1)])),_:1,__:[3]})])):createCommentVNode("",!0),createBaseVNode("div",_hoisted_11,[createVNode(unref(Button),{"w-15":"",onClick:$},{default:withCtx(()=>_[4]||(_[4]=[createTextVNode("",-1)])),_:1,__:[4]})])])):createCommentVNode("",!0),unref(h)?(openBlock(),createElementBlock("div",_hoisted_12,[createVNode(D,null,{default:withCtx(()=>[createBaseVNode("div",null,[createVNode(I,{modelValue:unref(y),"onUpdate:modelValue":_[1]||(_[1]=M=>isRef(y)?y.value=M:null),ref_key:"md",ref:b,"h-40px":"","m-y-3":"",onImgAdd:v},null,8,["modelValue"])])]),_:1}),createVNode(unref(Button),{quaternary:"","m-r-2":"",onClick:C},{default:withCtx(()=>_[5]||(_[5]=[createTextVNode("",-1)])),_:1,__:[5]}),createVNode(unref(Button),{quaternary:"",onClick:A},{default:withCtx(()=>_[6]||(_[6]=[createTextVNode("",-1)])),_:1,__:[6]})])):createCommentVNode("",!0),unref(d)?createCommentVNode("",!0):(openBlock(),createElementBlock("div",_hoisted_13,[createVNode(F,{otherreply:unref(g)},null,8,["otherreply"])]))]))])}}};export{_sfc_main as default};
