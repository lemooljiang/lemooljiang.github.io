import{_ as D}from"./BzUkPcel.js";import{_ as L}from"./DeEuqD7P.js";import{_ as q}from"./B8oIVCfA.js";import{u as H,f as S,g as x}from"./Bgr6ojWv.js";import{l as X}from"./BRTuN0Vx.js";import{g as $,h as j,r as i,k as z,c as r,o as s,b as c,i as F,t as y,u as a,a as g,F as A,e as E,d as N,j as B,B as R}from"./D81w4fj2.js";import"./BJ2ClxiI.js";const G={subContainer:""},I={"m-l-6":"","text-5":"","text-amber-800":""},J={key:0},K={key:1},M={key:2},O={key:0,"m-l-6":""},P={class:"article"},Q={"text-size-3":"","m-r-3":""},U={key:3,"text-center":""},W=["src"],Y={key:4,"text-center":"","m-b-10":""},ie={__name:"articles",setup(Z){let{message:h}=$(["message"]);H({title:"文章搜索页"});const w=j(),_=i(w.query.keywords);let n=[],C=20,b=i(0),u=i(),f=i(!1),d=i(!1),v=i(!1),k=i(!0);const T=async()=>{u.value=[],k.value=!0,d.value=!1;const{data:e,pending:o,error:l}=await x("/hiveapi/search/0/?keywords="+_.value);if(l.value&&h.error(`失败！
`+l.value,{duration:5e3}),e.value){let t=e.value.result;k.value=!1,t.length>19&&(d.value=!0,f.value=!1),n=[];for(let m in t)n.push(t[m]);u.value=n}},V=async()=>{v.value=!0,d.value=!1,f.value=!0,b.value+=C;const{data:e,pending:o,error:l}=await x("/hiveapi/search/"+b.value+"/?keywords="+_.value);if(l.value){h.error(`失败！
`+l.value,{duration:5e3});return}let t=e?.value?.result;if(t.length==0){h.info("没有更多数据了",{duration:5e3}),v.value=!1;return}for(let m in t)n.push(t[m]);u.value=n,v.value=!1,t.length>19&&(d.value=!0),f.value=!1};return z(()=>w.query.keywords,e=>{_.value=e,T()},{flush:"pre",immediate:!0,deep:!0}),(e,o)=>{const l=D,t=L,m=q;return s(),r("div",G,[c("p",I,"关键词: "+y(a(_)),1),a(k)?(s(),r("div",J,[g(l)])):e.error?(s(),r("div",K,[g(t,{error:e.error},null,8,["error"])])):(s(),r("div",M,[a(u).length==0?(s(),r("div",O,"没有相关文章！")):(s(!0),r(A,{key:1},E(a(u),p=>(s(),r("div",P,[g(m,{to:"/miaos/@"+p.author+"/"+p.permlink},{default:N(()=>[c("span",Q,y(("formatTime"in e?e.formatTime:a(S))(p.created)),1),B(y(p.title),1)]),_:2},1032,["to"])]))),256))])),a(v)?(s(),r("div",U,[c("img",{src:a(X),alt:"miao loading"},null,8,W)])):F("",!0),a(d)?(s(),r("div",Y,[g(a(R),{variant:"outline-primary",onClick:V,disabled:a(f)},{default:N(()=>o[0]||(o[0]=[B("搜索更多",-1)])),_:1,__:[0]},8,["disabled"])])):F("",!0),o[1]||(o[1]=c("br",null,null,-1)),o[2]||(o[2]=c("br",null,null,-1))])}}};export{ie as default};
